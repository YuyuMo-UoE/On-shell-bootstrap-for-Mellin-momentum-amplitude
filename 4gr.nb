(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    745790,      20881]
NotebookOptionsPosition[    709267,      20339]
NotebookOutlinePosition[    709703,      20356]
CellTagsIndexPosition[    709660,      20353]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "this notebook records how we bootstrap 4 graviton melllin momentum \
amplitude \nWe first give the list of the result \nI.e. s-channel \
contribution ",
 Cell[BoxData[
  RowBox[{
   FractionBox[
    RowBox[{"a1GR4", "[", 
     RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}], 
    SubscriptBox["D", 
     RowBox[{"ks", "[", 
      RowBox[{"1", ",", "2"}], "]"}]]], "+", 
   RowBox[{"bGR4", "[", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}], "+", 
   RowBox[{"cGR4", "[", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}]}]],
  CellChangeTimes->{{3.9129245650842557`*^9, 3.912924565486328*^9}, {
   3.912924600500176*^9, 3.9129246073918095`*^9}},ExpressionUUID->
  "6926ba92-80c0-4863-8569-100d9416a2d6"],
 "\n"
}], "Text",
 CellChangeTimes->{{3.937046159113779*^9, 3.9370461932813473`*^9}, {
   3.937046272685906*^9, 3.937046287430862*^9}, 
   3.937046404485509*^9},ExpressionUUID->"b5050e8a-fd6c-44ea-a96b-\
e2f17ca3d257"],

Cell[CellGroupData[{

Cell["SetUp", "Chapter",
 CellChangeTimes->{{3.9090377425018826`*^9, 
  3.909037745703765*^9}},ExpressionUUID->"97445c6b-72cc-48c5-a445-\
c2cf0d32b3eb"],

Cell[CellGroupData[{

Cell["Definitions", "Section",
 CellChangeTimes->{{3.8064425428182154`*^9, 
  3.8064425447462206`*^9}},ExpressionUUID->"a906ccef-1552-4cfe-9a9d-\
3efa42894461"],

Cell[CellGroupData[{

Cell["derivatives and contractions", "Subsection",
 CellChangeTimes->{{3.76751846412012*^9, 3.7675184702456675`*^9}, {
  3.767519123524742*^9, 
  3.767519126221491*^9}},ExpressionUUID->"97de1d61-e180-441d-b24b-\
f9645d460392"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"the", " ", "notation", " ", 
     RowBox[{"is", ":", " ", 
      RowBox[{"sc", "[", 
       RowBox[{"a", ",", "b"}], "]"}]}]}], "=", 
    RowBox[{"a", "\[CenterDot]", "b"}]}], ",", " ", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{"a", ",", 
      RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}], "=", 
    SubscriptBox["a", "\[Mu]i"]}], ",", " ", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"\[Mu]", "[", "i", "]"}], ",", 
      RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}], "=", 
    SubscriptBox["\[Delta]", "\[Mu]i\[Mu]j"]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.7675184748714037`*^9, 3.767518550062851*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"d56b027e-61fa-4054-855e-3a14f69f41ee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "@", "sc"}], "=", 
   RowBox[{"{", "Orderless", "}"}]}], ";", 
  RowBox[{
   RowBox[{"Attributes", "@", "Ht"}], "=", 
   RowBox[{"{", "Orderless", "}"}]}], ";", 
  RowBox[{
   RowBox[{"Attributes", "@", "ks"}], "=", 
   RowBox[{"{", "Orderless", "}"}]}], ";", 
  RowBox[{
   RowBox[{"Attributes", "@", "S"}], "=", 
   RowBox[{"{", "Orderless", "}"}]}], ";", 
  RowBox[{
   RowBox[{"Attributes", "@", "scb"}], "=", 
   RowBox[{"{", "Orderless", "}"}]}], ";", 
  RowBox[{
   RowBox[{"Attributes", "@", "ksq"}], "=", 
   RowBox[{"{", "Orderless", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sortEp", "=", 
    RowBox[{"{", 
     RowBox[{"i_Ep", "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"Signature", "[", "i", "]"}], 
       RowBox[{"Sort", "[", "i", "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"derivative", " ", 
    RowBox[{"d", "/", 
     SubscriptBox["dvar", "\[Mu]i"]}], " ", "or", " ", 
    RowBox[{"a", "\[CenterDot]", 
     RowBox[{"d", "/", "dvar"}]}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"diff", "[", 
    RowBox[{"indexordota_", ",", "var_"}], "]"}], "[", "expr_", "]"}], ":=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"expr", ",", "var"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["sc", 
         TagBox[
          RowBox[{"(", "i___", ")"}],
          Derivative],
         MultilineFunction->None], "[", "j___", "]"}], ")"}], 
      "\[RuleDelayed]", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{
        RowBox[{"sc", "[", "j", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", "i", "}"}], ",", "1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Rule]", 
         "indexordota"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Ep", 
         TagBox[
          RowBox[{"(", "i___", ")"}],
          Derivative],
         MultilineFunction->None], "[", "j___", "]"}], ")"}], 
      "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ReplacePart", "[", 
         RowBox[{
          RowBox[{"Ep", "[", "j", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"{", "i", "}"}], ",", "1"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Rule]", 
           "indexordota"}]}], "]"}], "/.", "sortEp"}], ")"}]}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"diffcr", "[", 
    RowBox[{"indexordota_", ",", "var_", ",", "mvar_"}], "]"}], "[", "expr_", 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"expr", ",", "var"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["sc", 
           TagBox[
            RowBox[{"(", "i___", ")"}],
            Derivative],
           MultilineFunction->None], "[", "j___", "]"}], ")"}], 
        "\[RuleDelayed]", 
        RowBox[{"ReplacePart", "[", 
         RowBox[{
          RowBox[{"sc", "[", "j", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"{", "i", "}"}], ",", "1"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Rule]", 
           "indexordota"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Ep", 
           TagBox[
            RowBox[{"(", "i___", ")"}],
            Derivative],
           MultilineFunction->None], "[", "j___", "]"}], ")"}], 
        "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ReplacePart", "[", 
           RowBox[{
            RowBox[{"Ep", "[", "j", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"{", "i", "}"}], ",", "1"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Rule]", 
             "indexordota"}]}], "]"}], "/.", "sortEp"}], ")"}]}]}], "}"}]}], 
    ")"}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{"sc", "[", 
      RowBox[{"var", ",", "indexordota"}], "]"}], "mvar"], 
    RowBox[{"D", "[", 
     RowBox[{"expr", ",", "mvar"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gram", "[", 
    RowBox[{"lis1_", ",", "lis2_"}], "]"}], ":=", 
   RowBox[{"Det", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{"i1", ",", "j1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i1", ",", "lis1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j1", ",", "lis2"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"contract", " ", "index"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"contractrule", "[", "dim_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"x_", ",", 
         RowBox[{"\[Mu]", "[", "i_", "]"}]}], " ", "]"}], 
       RowBox[{"sc", "[", 
        RowBox[{"y_", ",", 
         RowBox[{"\[Mu]", "[", "i_", "]"}]}], "]"}]}], "\[RuleDelayed]", 
      RowBox[{"sc", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"x_", ",", 
         RowBox[{"\[Mu]", "[", "i_", "]"}]}], "]"}], "^", "2"}], 
      "\[RuleDelayed]", 
      RowBox[{"sc", "[", 
       RowBox[{"x", ",", "x"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "i_", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", "dim"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"x_", ",", 
         RowBox[{"\[Mu]", "[", "i_", "]"}], ",", 
         RowBox[{"\[Mu]", "[", "j_", "]"}]}], " ", "]"}], 
       RowBox[{"sc", "[", 
        RowBox[{"y_", ",", 
         RowBox[{"\[Mu]", "[", "i_", "]"}], ",", 
         RowBox[{"\[Mu]", "[", "j_", "]"}]}], "]"}]}], "\[RuleDelayed]", 
      RowBox[{"sc", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"x_", ",", 
         RowBox[{"\[Mu]", "[", "i_", "]"}], ",", 
         RowBox[{"\[Mu]", "[", "j_", "]"}]}], " ", "]"}], 
       RowBox[{"sc", "[", 
        RowBox[{"y_", ",", 
         RowBox[{"\[Mu]", "[", "i_", "]"}]}], "]"}]}], "\[RuleDelayed]", 
      RowBox[{"sc", "[", 
       RowBox[{"x", ",", "y", ",", 
        RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"x_", ",", "y_", ",", 
         RowBox[{"\[Mu]", "[", "i_", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{"z_", ",", 
         RowBox[{"\[Mu]", "[", "i_", "]"}]}], "]"}]}], ":>", " ", 
      RowBox[{"sc", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"x_", ",", 
         RowBox[{"\[Nu]", "[", "i_", "]"}]}], "]"}], 
       RowBox[{"sc", "[", 
        RowBox[{"y_", ",", 
         RowBox[{"\[Nu]", "[", "i_", "]"}]}], "]"}]}], "\[RuleDelayed]", 
      RowBox[{"sc", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"x_", ",", 
         RowBox[{"\[Nu]", "[", "i_", "]"}]}], "]"}], "^", "2"}], 
      "\[RuleDelayed]", 
      RowBox[{"sc", "[", 
       RowBox[{"x", ",", "x"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Nu]", "[", "i_", "]"}], ",", 
        RowBox[{"\[Nu]", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", "dim"}],
      ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Ep", "[", 
        RowBox[{"x___", ",", 
         RowBox[{"\[Mu]", "[", "i_", "]"}], ",", "y___"}], "]"}], 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"\[Mu]", "[", "i_", "]"}], ",", "z_"}], "]"}]}], 
      "\[RuleDelayed]", 
      RowBox[{"Ep", "[", 
       RowBox[{"x", ",", "z", ",", "y"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Ep", "[", 
        RowBox[{"x___", ",", 
         RowBox[{"\[Nu]", "[", "i_", "]"}], ",", "y___"}], "]"}], 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"\[Nu]", "[", "i_", "]"}], ",", "z_"}], "]"}]}], 
      "\[RuleDelayed]", 
      RowBox[{"Ep", "[", 
       RowBox[{"x", ",", "z", ",", "y"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Ep", "[", 
        RowBox[{"x___", ",", 
         RowBox[{"\[Mu]", "[", "i_", "]"}], ",", "y___"}], "]"}], 
       RowBox[{"Ep", "[", 
        RowBox[{"z___", ",", 
         RowBox[{"\[Mu]", "[", "i_", "]"}], ",", "k___"}], "]"}]}], 
      "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"Length", "@", 
           RowBox[{"{", "x", "}"}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"Length", "@", 
          RowBox[{"{", "z", "}"}]}], ")"}]}], 
       RowBox[{"gram", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", "k"}], "}"}]}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Ep", "[", 
        RowBox[{"x___", ",", 
         RowBox[{"\[Nu]", "[", "i_", "]"}], ",", "y___"}], "]"}], 
       RowBox[{"Ep", "[", 
        RowBox[{"z___", ",", 
         RowBox[{"\[Nu]", "[", "i_", "]"}], ",", "k___"}], "]"}]}], 
      "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"Length", "@", 
           RowBox[{"{", "x", "}"}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"Length", "@", 
          RowBox[{"{", "z", "}"}]}], ")"}]}], 
       RowBox[{"gram", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", "k"}], "}"}]}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"Ep", "[", 
       RowBox[{"i_", ",", "_", ",", "i_"}], "]"}], "\[RuleDelayed]", "0"}], 
     ",", 
     RowBox[{
      RowBox[{"Ep", "[", 
       RowBox[{"i_", ",", "i_", ",", "_"}], "]"}], "\[RuleDelayed]", "0"}], 
     ",", 
     RowBox[{
      RowBox[{"Ep", "[", 
       RowBox[{"_", ",", "i_", ",", "i_"}], "]"}], "\[RuleDelayed]", "0"}]}], 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "Ep", " ", "part", " ", "only", " ", "works", " ", "for", " ", "dim"}], 
      "=", "4"}], "*)"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"contract", "[", 
    RowBox[{"expr_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"FixedPoint", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Expand", "[", "#", "]"}], "//.", 
        RowBox[{"contractrule", "[", "dim", "]"}]}], ")"}], "&"}], ",", 
     "expr", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"simpEp", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Ep", "[", 
         RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], 
        RowBox[{"Ep", "[", 
         RowBox[{"k_", ",", "l_", ",", "m_"}], "]"}]}], "\[RuleDelayed]", 
       RowBox[{"gram", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "l", ",", "m"}], "}"}]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Ep", "[", 
         RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], "^", "2"}], 
       "\[RuleDelayed]", 
       RowBox[{"gram", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]}], "}"}]}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"this", " ", "only", " ", "works", " ", "for", " ", "dim"}], "=",
      "3"}], "*)"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"why", " ", 
    RowBox[{"3", "?"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "fanscinating", " ", "optimaized", " ", "code", " ", "from", " ", "Simon", 
    " ", "to", " ", "deal", " ", "with", " ", "contracting", " ", "two", " ", 
    "derivatives", " ", 
    RowBox[{
     RowBox[{"d", "/", "var1"}], "\[CenterDot]", 
     RowBox[{"d", "/", "var2"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"diff2", "[", 
      RowBox[{"var1_", ",", "var2_", ",", "dim_", ",", 
       RowBox[{"index_", ":", 
        RowBox[{"\[Mu]", "[", "whatever", "]"}]}]}], "]"}], "[", "expr_", 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"exprim", "=", 
        RowBox[{
         RowBox[{"diff", "[", 
          RowBox[{"index", ",", "var2"}], "]"}], "[", "expr", "]"}]}], "}"}], 
      ",", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"contract", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"diff", "[", 
              RowBox[{"index", ",", "var1"}], "]"}], "[", "withindex", "]"}], 
            ",", "dim"}], "]"}], 
          RowBox[{"Coefficient", "[", 
           RowBox[{"exprim", ",", "withindex"}], "]"}]}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"diff", "[", 
             RowBox[{"index", ",", "var1"}], "]"}], "[", 
            RowBox[{"Coefficient", "[", 
             RowBox[{"exprim", ",", "withindex"}], "]"}], "]"}], "/.", 
           RowBox[{
            RowBox[{"i_sc", "/;", 
             RowBox[{"!", 
              RowBox[{"FreeQ", "[", 
               RowBox[{"i", ",", "index"}], "]"}]}]}], "\[RuleDelayed]", 
            RowBox[{"contract", "[", 
             RowBox[{
              RowBox[{"i", " ", "withindex"}], ",", "dim"}], "]"}]}]}], 
          ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"withindex", ",", 
          RowBox[{"listwhat", "[", 
           RowBox[{"exprim", ",", 
            RowBox[{"i_sc", "/;", 
             RowBox[{"!", 
              RowBox[{"FreeQ", "[", 
               RowBox[{"i", ",", "index"}], "]"}]}]}]}], "]"}]}], "}"}]}], 
       "]"}]}], "]"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"diff2", "[", 
    RowBox[{"var1_", ",", "var2_", ",", "dim_", ",", 
     RowBox[{"index_", ":", 
      RowBox[{"\[Mu]", "[", "whatever", "]"}]}]}], "]"}], "[", "expr_", "]"}],
   ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"exprim", "=", 
      RowBox[{
       RowBox[{"diff", "[", 
        RowBox[{"index", ",", "var2"}], "]"}], "[", "expr", "]"}]}], "}"}], 
    ",", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"contract", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"diff", "[", 
            RowBox[{"index", ",", "var1"}], "]"}], "[", "withindex", "]"}], 
          ",", "dim"}], "]"}], 
        RowBox[{"Coefficient", "[", 
         RowBox[{"exprim", ",", "withindex"}], "]"}]}], "+", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"diff", "[", 
           RowBox[{"index", ",", "var1"}], "]"}], "[", 
          RowBox[{"Coefficient", "[", 
           RowBox[{"exprim", ",", "withindex"}], "]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"i_sc", "/;", 
             RowBox[{"!", 
              RowBox[{"FreeQ", "[", 
               RowBox[{"i", ",", "index"}], "]"}]}]}], "\[RuleDelayed]", 
            RowBox[{"contract", "[", 
             RowBox[{
              RowBox[{"i", " ", "withindex"}], ",", "dim"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"i_Ep", "/;", 
             RowBox[{"!", 
              RowBox[{"FreeQ", "[", 
               RowBox[{"i", ",", "index"}], "]"}]}]}], "\[RuleDelayed]", 
            RowBox[{"contract", "[", 
             RowBox[{
              RowBox[{"i", " ", "withindex"}], ",", "dim"}], "]"}]}]}], 
          "}"}]}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"withindex", ",", 
        RowBox[{
         RowBox[{"listwhat", "[", 
          RowBox[{"exprim", ",", 
           RowBox[{"i_sc", "/;", 
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"i", ",", "index"}], "]"}]}]}]}], "]"}], "~", "Join", 
         "~", 
         RowBox[{"listwhat", "[", 
          RowBox[{"exprim", ",", 
           RowBox[{"i_Ep", "/;", 
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"i", ",", "index"}], "]"}]}]}]}], "]"}]}]}], "}"}]}], 
     "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.767518556924008*^9, 3.7675185683453827`*^9}, {
   3.7675205991129756`*^9, 3.7675206070618887`*^9}, 3.767520761545313*^9, {
   3.767521367249151*^9, 3.7675213695356655`*^9}, {3.7675214978893433`*^9, 
   3.7675215466972017`*^9}, {3.76752158970475*^9, 3.767521770139882*^9}, {
   3.7675218026015005`*^9, 3.7675218046668377`*^9}, {3.7675219145232763`*^9, 
   3.7675219160311155`*^9}, {3.7675219690032825`*^9, 3.767521973560029*^9}, {
   3.7675282689747286`*^9, 3.7675282772752733`*^9}, {3.7675285676248055`*^9, 
   3.7675285688142204`*^9}, {3.7675290371808186`*^9, 
   3.7675290425544453`*^9}, {3.7675634022904778`*^9, 3.767563416852054*^9}, {
   3.769043849546838*^9, 3.7690438579282327`*^9}, {3.770244203600931*^9, 
   3.7702442175406404`*^9}, {3.7702445437970233`*^9, 3.770244582453597*^9}, 
   3.770244748033746*^9, {3.7702449270838614`*^9, 3.7702449317363806`*^9}, {
   3.770244980938799*^9, 3.770244991380848*^9}, {3.7702450326205697`*^9, 
   3.7702450495682583`*^9}, {3.7702451615616627`*^9, 3.770245165259818*^9}, {
   3.7724903090408*^9, 3.7724903095720224`*^9}, {3.7724914768505416`*^9, 
   3.77249153409016*^9}, {3.7724917533931684`*^9, 3.772491757345337*^9}, {
   3.773883455033391*^9, 3.7738834754388647`*^9}, {3.783206213228001*^9, 
   3.783206219215963*^9}, 3.7862321608818283`*^9, {3.7862331302703967`*^9, 
   3.786233130770372*^9}, {3.7880785049123526`*^9, 3.788078505131052*^9}, {
   3.790325454211709*^9, 3.790325455039502*^9}, {3.790752420062786*^9, 
   3.790752421984342*^9}, {3.790753670992031*^9, 3.7907536743660755`*^9}, {
   3.7931446234551554`*^9, 3.793144624033158*^9}, {3.8147797048889112`*^9, 
   3.814779712330363*^9}, {3.814779825048314*^9, 3.8147798319265213`*^9}, 
   3.814779976199803*^9, {3.8259072967049665`*^9, 3.8259073087269106`*^9}, 
   3.8287497911747055`*^9, {3.8290288127911224`*^9, 3.8290288143584957`*^9}, {
   3.829787232487622*^9, 3.8297872514563704`*^9}, {3.8482308937879877`*^9, 
   3.8482309005393867`*^9}, {3.8482309362147818`*^9, 3.848230949460332*^9}, {
   3.862306127113882*^9, 3.862306177321944*^9}, {3.8628526838007765`*^9, 
   3.8628526851545024`*^9}, {3.8628544756880584`*^9, 3.862854519448631*^9}, {
   3.862854615905598*^9, 3.8628546214333267`*^9}, {3.8629126355240393`*^9, 
   3.862912744654106*^9}, {3.863074347693452*^9, 3.863074347894659*^9}, {
   3.86437068062414*^9, 3.864370688399922*^9}, {3.864370862075238*^9, 
   3.864370866512465*^9}, {3.864370896685823*^9, 3.864370915573331*^9}, 
   3.864371055224194*^9, {3.8643712078524837`*^9, 3.8643712144002666`*^9}, {
   3.864371283333741*^9, 3.8643713482145042`*^9}, {3.8643747103727493`*^9, 
   3.864374730812961*^9}, {3.864374836930976*^9, 3.864374837080694*^9}, {
   3.9128489433568883`*^9, 3.912848955131884*^9}, {3.913132610689291*^9, 
   3.913132617991919*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"a9fad708-6167-401c-81b9-229508b16d6f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Polarization sum", "Subsection",
 CellChangeTimes->{{3.9088671413971186`*^9, 
  3.9088671439140143`*^9}},ExpressionUUID->"21176869-6454-4a85-bea7-\
6f0e3f105682"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"projection", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Pi]", "[", 
       RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"\[Mu]", "[", "i", "]"}], ",", 
         RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}], "-", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["k", "2"]], 
        RowBox[{"(", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"k", "[", "L", "]"}], ",", 
           RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"k", "[", "R", "]"}], ",", 
           RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}], ")"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"\[Pi]2", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "e_", ",", "k_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"\[Pi]", "[", 
         RowBox[{"a", ",", "c", ",", "k"}], "]"}], 
        RowBox[{"\[Pi]", "[", 
         RowBox[{"b", ",", "e", ",", "k"}], "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"\[Pi]", "[", 
         RowBox[{"a", ",", "e", ",", "k"}], "]"}], 
        RowBox[{"\[Pi]", "[", 
         RowBox[{"b", ",", "c", ",", "k"}], "]"}]}], "-", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"d", "-", "1"}]], 
        RowBox[{"\[Pi]", "[", 
         RowBox[{"a", ",", "b", ",", "k"}], "]"}], 
        RowBox[{"\[Pi]", "[", 
         RowBox[{"c", ",", "e", ",", "k"}], "]"}]}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EoMOP", "[", 
     RowBox[{"k_", ",", "del_"}], "]"}], "[", "expr_", "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", "2"], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"expr", ",", "z"}], "]"}], ",", "z"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "d"}], ")"}], "z", " ", 
        RowBox[{"D", "[", 
         RowBox[{"expr", ",", "z"}], "]"}]}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"z", "^", "2"}], " ", 
        RowBox[{"k", "^", "2"}]}], "+", 
       RowBox[{
        RowBox[{"(", "del", ")"}], 
        RowBox[{"(", 
         RowBox[{"del", "-", "d"}], ")"}]}]}], ")"}], "expr"}]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fOP", "[", 
     RowBox[{"k_", ",", "del_"}], "]"}], "[", "expr_", "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", "2"], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"expr", ",", "z"}], "]"}], ",", "z"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "d"}], ")"}], "z", " ", 
        RowBox[{"D", "[", 
         RowBox[{"expr", ",", "z"}], "]"}]}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", "del", ")"}], 
       RowBox[{"(", 
        RowBox[{"del", "-", "d"}], ")"}]}], ")"}], "expr"}]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"OPELimits", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{
       RowBox[{"d", "-", "1"}], ",", "s12_"}], "]"}], ":>", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "d"}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "d"}], ")"}], " ", "s12"}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["s12", "2"]}]}]}], ",", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"d", ",", "s12_"}], "]"}], ":>", 
     RowBox[{
      RowBox[{
       RowBox[{"+", "2"}], " ", "d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "s12"}], ")"}]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "s12"}], ")"}], "2"]}]}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Onshellc", "[", 
   RowBox[{"del_", ",", 
    RowBox[{"k", "[", "a_", "]"}], ",", "z_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"k", "[", "a", "]"}], "2"], ":>", 
    FractionBox[
     RowBox[{
      RowBox[{"4", 
       SuperscriptBox[
        RowBox[{"s", "[", "a", "]"}], "2"]}], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox["d", "2"], "-", "del"}], ")"}], "2"]}], 
     SuperscriptBox["z", "2"]]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mellindelta", "[", 
   RowBox[{"n_", ",", "b_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"2", 
        RowBox[{"s", "[", "i", "]"}]}], "-", 
       RowBox[{"d", "/", "2"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "+", "d", "-", 
    "b"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mellindelta", "[", 
   RowBox[{"n_", ",", "b_", ",", "a_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"2", 
           RowBox[{"s", "[", "i", "]"}]}], "-", 
          RowBox[{"d", "/", "2"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "+", "d", "-", 
       "b"}], "\[Equal]", "0"}], ",", "a"}], "]"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"k", "[", "i", "]"}], ",", 
           RowBox[{"k", "[", "j", "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"k", "[", "i_", "]"}], ",", 
         RowBox[{"k", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
       SuperscriptBox[
        RowBox[{"k", "[", "i", "]"}], "2"]}], ",", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"k", "[", "i_", "]"}], ",", 
         RowBox[{"k", "[", "j_", "]"}]}], "]"}], ":>", 
       RowBox[{
        RowBox[{"1", "/", "2"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ksq", "[", 
           RowBox[{"i", ",", "j"}], "]"}], "-", 
          SuperscriptBox[
           RowBox[{"k", "[", "i", "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"k", "[", "j", "]"}], "2"]}], ")"}]}]}]}], "}"}]}], "//", 
   "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AdS5pt", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"%", "\[Equal]", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ksq", "[", 
         RowBox[{"1", ",", "5"}], "]"}], ",", 
        RowBox[{"ksq", "[", 
         RowBox[{"2", ",", "5"}], "]"}], ",", 
        RowBox[{"ksq", "[", 
         RowBox[{"3", ",", "4"}], "]"}], ",", 
        RowBox[{"ksq", "[", 
         RowBox[{"3", ",", "5"}], "]"}], ",", 
        RowBox[{"ksq", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}], "}"}]}], "]"}], "/.", 
    RowBox[{
     RowBox[{"ksq", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], "\[RuleDelayed]", 
     SuperscriptBox[
      RowBox[{"ks", "[", 
       RowBox[{"i", ",", "j"}], "]"}], "2"]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9088671908637342`*^9, 3.9088671942797785`*^9}, {
   3.9088673554431367`*^9, 3.9088673557104635`*^9}, 3.908867498240724*^9, 
   3.9088675344063826`*^9, {3.908973021708854*^9, 3.9089730464084225`*^9}, {
   3.910438229287901*^9, 3.9104382389841413`*^9}, {3.9104390655729113`*^9, 
   3.9104390698479176`*^9}, {3.9104395935901933`*^9, 3.9104396120094*^9}, {
   3.9105079721809187`*^9, 3.9105080002554884`*^9}, {3.9105080904023576`*^9, 
   3.9105081059226136`*^9}, 3.910508225995676*^9, {3.91050835730404*^9, 
   3.9105084137829103`*^9}, {3.910508503214944*^9, 3.910508571926526*^9}, {
   3.910508606712528*^9, 3.9105086876382837`*^9}, 3.910508726814303*^9, {
   3.910508807732024*^9, 3.9105088233229136`*^9}, {3.910509412371628*^9, 
   3.9105094191985817`*^9}, {3.9105095128965073`*^9, 
   3.9105095486134224`*^9}, {3.9105112339140034`*^9, 
   3.9105112562946634`*^9}, {3.9105113279354324`*^9, 
   3.9105113317181745`*^9}, {3.9105118748310595`*^9, 
   3.9105118773596416`*^9}, {3.9110282458851805`*^9, 
   3.9110282523347073`*^9}, {3.9110282838676376`*^9, 3.911028344234401*^9}, {
   3.9110283769742136`*^9, 3.9110284151796875`*^9}, {3.911463011996993*^9, 
   3.911463012533325*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"06885706-73db-4920-926d-8dcea8a35a2b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"k", "[", "1", "]"}], ",", 
         RowBox[{"k", "[", "i", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "1", "]"}], ",", 
          RowBox[{"k", "[", "2", "]"}]}], "]"}], "->", 
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ks", "^", "2"}], "-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "1", "]"}], ",", 
             RowBox[{"k", "[", "1", "]"}]}], "]"}], "-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "2", "]"}], ",", 
             RowBox[{"k", "[", "2", "]"}]}], "]"}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "3", "]"}], ",", 
          RowBox[{"k", "[", "4", "]"}]}], "]"}], "->", 
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ks", "^", "2"}], "-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "3", "]"}], ",", 
             RowBox[{"k", "[", "3", "]"}]}], "]"}], "-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "4", "]"}], ",", 
             RowBox[{"k", "[", "4", "]"}]}], "]"}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "1", "]"}], ",", 
          RowBox[{"k", "[", "4", "]"}]}], "]"}], "->", 
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kt", "^", "2"}], "-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "1", "]"}], ",", 
             RowBox[{"k", "[", "1", "]"}]}], "]"}], "-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "4", "]"}], ",", 
             RowBox[{"k", "[", "4", "]"}]}], "]"}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "2", "]"}], ",", 
          RowBox[{"k", "[", "3", "]"}]}], "]"}], "->", 
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kt", "^", "2"}], "-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "3", "]"}], ",", 
             RowBox[{"k", "[", "3", "]"}]}], "]"}], "-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "2", "]"}], ",", 
             RowBox[{"k", "[", "2", "]"}]}], "]"}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "1", "]"}], ",", 
          RowBox[{"k", "[", "3", "]"}]}], "]"}], "->", 
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ku", "^", "2"}], "-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "1", "]"}], ",", 
             RowBox[{"k", "[", "1", "]"}]}], "]"}], "-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "3", "]"}], ",", 
             RowBox[{"k", "[", "3", "]"}]}], "]"}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "2", "]"}], ",", 
          RowBox[{"k", "[", "4", "]"}]}], "]"}], "->", 
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ku", "^", "2"}], "-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "2", "]"}], ",", 
             RowBox[{"k", "[", "2", "]"}]}], "]"}], "-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "4", "]"}], ",", 
             RowBox[{"k", "[", "4", "]"}]}], "]"}]}], ")"}]}]}]}], "}"}]}], "/.", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"k", "[", "i_", "]"}], ",", 
       RowBox[{"k", "[", "i_", "]"}]}], "]"}], ":>", 
     SuperscriptBox[
      RowBox[{"k", "[", "i", "]"}], "2"]}]}], "//", "Simplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"momconser4pt", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"%", "/.", 
         RowBox[{
          SuperscriptBox["ku", "2"], "->", "a"}]}], ")"}], "==", "0"}], ",", 
      "a"}], "]"}], "/.", 
    RowBox[{"a", "->", 
     SuperscriptBox["ku", "2"]}]}], "//", "Flatten"}]}]}], "Input",
 CellChangeTimes->{{3.9110326086311436`*^9, 3.9110326397171564`*^9}, {
  3.911032671792165*^9, 3.9110327524350595`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"59d9080f-10c5-4936-98b5-19a70e83a964"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SuperscriptBox["ku", "2"], "\[Rule]", 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["ks", "2"]}], "-", 
    SuperscriptBox["kt", "2"], "+", 
    SuperscriptBox[
     RowBox[{"k", "[", "1", "]"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"k", "[", "2", "]"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"k", "[", "3", "]"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"k", "[", "4", "]"}], "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.911032626679288*^9, 3.9110326400020323`*^9}, {
   3.9110327196906357`*^9, 3.911032752713896*^9}, 3.9111158753598022`*^9, 
   3.912774884208253*^9, 3.912837078031054*^9, 3.913016838605894*^9, {
   3.91309479231768*^9, 3.9130948041199665`*^9}, 3.9131059706796803`*^9, 
   3.9131072503962207`*^9, 3.9131242065816345`*^9, 3.913137108674103*^9, 
   3.913137643992696*^9, 3.913138075321766*^9, 3.913152899548752*^9, 
   3.9143978913545647`*^9, 3.915170239219448*^9, 3.915293842717678*^9, 
   3.9157471586171494`*^9, 3.915900914468957*^9, 3.915903693880369*^9, 
   3.916119570271309*^9, 3.916138260333541*^9, 3.916138671707554*^9, 
   3.916825469319893*^9, 3.9169000219040117`*^9, 3.9171752275918837`*^9, 
   3.91840036234066*^9, 3.9184534976886826`*^9, 3.9370456868935814`*^9, 
   3.937045719178506*^9, 3.937046257810028*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"3eee92df-5976-496f-bf61-356f8bfb064e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "i", "]"}], ",", 
          RowBox[{"k", "[", "j", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}], ")"}], "/.", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{"a_", ",", "a_"}], "]"}], "\[RuleDelayed]", "0"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"momconservationflat", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{"%", "==", "0"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.9104578261337175`*^9, {3.910457965183443*^9, 3.9104579675581064`*^9}, {
   3.910460828984873*^9, 3.9104608456309605`*^9}, {3.9106814724727507`*^9, 
   3.910681535203182*^9}, {3.9106815725604873`*^9, 3.9106815806853952`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"22094ec7-2daa-48d7-ada7-dbadb9b6e6a9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["display", "Subsection",
 CellChangeTimes->{{3.911384976691202*^9, 
  3.91138497797867*^9}},ExpressionUUID->"cd228d68-5fba-4ae5-90c5-\
3fffe13138be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M3", "[", 
   RowBox[{
   "k1_", ",", "k2_", ",", "k3_", ",", "z_", ",", "e1_", ",", "e2_", ",", 
    "e3_"}], "]"}], ":=", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"z", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"e1", ",", "e2"}], "]"}], 
        RowBox[{"sc", "[", 
         RowBox[{"e3", ",", "k1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"e2", ",", "e3"}], "]"}], 
        RowBox[{"sc", "[", 
         RowBox[{"e1", ",", "k2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"e3", ",", "e1"}], "]"}], 
        RowBox[{"sc", "[", 
         RowBox[{"e2", ",", "k3"}], "]"}]}]}], ")"}]}], ")"}], 
   "2"]}]], "Input",
 CellLabel->"In[24]:=",ExpressionUUID->"eefeba35-cbdb-448f-93a3-d3b9a7beab92"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "@", "ks"}], "=", 
   RowBox[{"{", "Orderless", "}"}]}], ";", 
  RowBox[{
   RowBox[{"Attributes", "@", "scb"}], "=", 
   RowBox[{"{", "Orderless", "}"}]}], ";", 
  RowBox[{
   RowBox[{"Attributes", "@", "ksq"}], "=", 
   RowBox[{"{", "Orderless", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.913008260663357*^9, 3.913008262147423*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"1bb4e359-503a-4074-a843-5ff6d88d5b8e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sub4ptAmpMomentumConser", "[", 
   RowBox[{"lawi_", ",", "P_", ",", "x1_", ",", "x2_", ",", "x3_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"lawi", "/.", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"k", "[", "x3", "]"}], "2"], "-", 
         SuperscriptBox[
          RowBox[{"k", "[", "P", "]"}], "2"]}], ")"}], "->", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"k", "[", "x3", "]"}], "+", 
          RowBox[{"k", "[", "P", "]"}]}], ",", 
         RowBox[{
          RowBox[{"k", "[", "x3", "]"}], "-", 
          RowBox[{"k", "[", "P", "]"}]}]}], "]"}]}]}], "/.", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"k", "[", "P", "]"}], "2"], "->", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "[", "x1", "]"}], "+", 
         RowBox[{"k", "[", "x2", "]"}], "+", 
         RowBox[{"k", "[", "x3", "]"}]}], ",", 
        RowBox[{
         RowBox[{"k", "[", "x1", "]"}], "+", 
         RowBox[{"k", "[", "x2", "]"}], "+", 
         RowBox[{"k", "[", "x3", "]"}]}]}], "]"}]}]}], "/.", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"k", "[", "P", "]"}], "4"], "->", 
     SuperscriptBox[
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "[", "x1", "]"}], "+", 
         RowBox[{"k", "[", "x2", "]"}], "+", 
         RowBox[{"k", "[", "x3", "]"}]}], ",", 
        RowBox[{
         RowBox[{"k", "[", "x1", "]"}], "+", 
         RowBox[{"k", "[", "x2", "]"}], "+", 
         RowBox[{"k", "[", "x3", "]"}]}]}], "]"}], "2"]}]}], "/.", 
   RowBox[{
    RowBox[{"k", "[", "P", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"k", "[", "x1", "]"}]}], "-", 
     RowBox[{"k", "[", "x2", "]"}], "-", 
     RowBox[{"k", "[", "x3", "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.913125446038018*^9, 3.913125533791459*^9}, {
  3.913125575795573*^9, 3.913125592398079*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"2e3b7150-e506-48c5-9334-38fd679e8fc8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoubleIndex", "[", 
   RowBox[{"pxa_", ",", "i_", ",", "i1_", ",", "i2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"pxa", "/.", 
     RowBox[{
      RowBox[{"e", "[", "P", "]"}], "->", 
      RowBox[{"\[Mu]", "[", "i", "]"}]}]}], "//", "Expand"}], "//", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"a_", ",", 
          RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}], 
        RowBox[{"sc", "[", 
         RowBox[{"b_", ",", 
          RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}]}], ":>", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"a", ",", 
          RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}], 
        RowBox[{"sc", "[", 
         RowBox[{"b", ",", 
          RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}]}]}], ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"sc", "[", 
         RowBox[{"a_", ",", 
          RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}], "2"], ":>", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"a", ",", 
          RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}], 
        RowBox[{"sc", "[", 
         RowBox[{"a", ",", 
          RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}]}]}]}], "}"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9131253218228455`*^9, 3.9131253381779413`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"5268b4f8-238b-4d16-80f5-f268b51ee359"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getridofallplusminussc", "[", "pl_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"pl", "//.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ":>", 
       RowBox[{"Distribute", "[", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", "Plus"}], "]"}]}]}], "//.", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"a_.", "x_"}], ",", 
        RowBox[{"b_.", "y_"}]}], "]"}], ":>", 
      RowBox[{"a", " ", "b", " ", 
       RowBox[{"sc", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}]}]}], "/.", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "i_", "]"}], ",", 
       RowBox[{"k", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", "0"}]}], "/.", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"k", "[", "i_", "]"}], ",", 
      RowBox[{"k", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
    SuperscriptBox[
     RowBox[{"k", "[", "i", "]"}], "2"]}]}]}]], "Input",
 CellChangeTimes->{{3.91309902143433*^9, 3.913099067867524*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"a0984a8a-5c1f-4d39-a0f9-b878067fc32f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetRidOfAllPlusMinusSC", "[", "pl_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"pl", "//.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ":>", 
       RowBox[{"Distribute", "[", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", "Plus"}], "]"}]}]}], "//.", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"a_.", "x_"}], ",", 
        RowBox[{"b_.", "y_"}]}], "]"}], ":>", 
      RowBox[{"a", " ", "b", " ", 
       RowBox[{"sc", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}]}]}], "/.", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "i_", "]"}], ",", 
       RowBox[{"k", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", "0"}]}], "/.", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"k", "[", "i_", "]"}], ",", 
      RowBox[{"k", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
    SuperscriptBox[
     RowBox[{"k", "[", "i", "]"}], "2"]}]}]}]], "Input",
 CellChangeTimes->{{3.913125674476204*^9, 3.9131256836573277`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"94abc4db-5814-4c84-835b-c33e73c99fca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Onshellcykk", "[", 
   RowBox[{"del_", ",", 
    RowBox[{"kk", "[", "a_", "]"}], ",", "z_"}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"kk", "[", "a", "]"}], "2"], "\[RuleDelayed]", 
   FractionBox[
    RowBox[{
     RowBox[{"4", " ", 
      SuperscriptBox[
       RowBox[{"s", "[", "a", "]"}], "2"]}], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        FractionBox["d", "2"], "-", "del"}], ")"}], "2"]}], 
    SuperscriptBox["z", "2"]]}]}]], "Input",
 CellLabel->"In[30]:=",ExpressionUUID->"0a33c5f3-2904-47a1-9884-1379b60feea8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"k", "[", "i", "]"}], ",", 
           RowBox[{"k", "[", "j", "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"k", "[", "i_", "]"}], ",", 
         RowBox[{"k", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
       SuperscriptBox[
        RowBox[{"k", "[", "i", "]"}], "2"]}], ",", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"k", "[", "i_", "]"}], ",", 
         RowBox[{"k", "[", "j_", "]"}]}], "]"}], ":>", 
       RowBox[{
        RowBox[{"1", "/", "2"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ksq", "[", 
           RowBox[{"i", ",", "j"}], "]"}], "-", 
          SuperscriptBox[
           RowBox[{"k", "[", "i", "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"k", "[", "j", "]"}], "2"]}], ")"}]}]}]}], "}"}]}], "//", 
   "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AdS5ptmy", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"%", "\[Equal]", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ksq", "[", 
          RowBox[{"1", ",", "3"}], "]"}], ",", 
         RowBox[{"ksq", "[", 
          RowBox[{"1", ",", "4"}], "]"}], ",", 
         RowBox[{"ksq", "[", 
          RowBox[{"2", ",", "4"}], "]"}], ",", 
         RowBox[{"ksq", "[", 
          RowBox[{"3", ",", "5"}], "]"}], ",", 
         RowBox[{"ksq", "[", 
          RowBox[{"2", ",", "5"}], "]"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"ksq", "[", 
       RowBox[{"i_", ",", "j_"}], "]"}], "\[RuleDelayed]", 
      SuperscriptBox[
       RowBox[{"ks", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "2"]}]}], "//", "Flatten"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AdS5ptmyad", "=", 
   RowBox[{"%", "//", 
    RowBox[{
     RowBox[{"ReplaceAll", "[", 
      RowBox[{"#", ",", 
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{"x_", ",", "y_"}], "]"}], "->", 
        RowBox[{"Rule", "[", 
         RowBox[{
          RowBox[{"x", "^", "2"}], ",", 
          RowBox[{"y", "^", "2"}]}], "]"}]}]}], "]"}], "&"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9120714960782585`*^9, 3.9120714964194603`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"4683bdbb-e5cf-4794-9f7b-600467589e74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getsc", "[", "x_", "]"}], ":=", 
  RowBox[{"Cases", "[", 
   RowBox[{"x", ",", 
    RowBox[{"sc", "[", 
     RowBox[{"_", ",", "_"}], "]"}], ",", "Infinity"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9118032211160965`*^9, 3.9118032313082705`*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"c1dd6960-69cc-4b01-aa8d-a1579db3e885"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getsckk", "[", "x_", "]"}], ":=", 
  RowBox[{"Cases", "[", 
   RowBox[{"x", ",", 
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"k", "[", "_", "]"}], ",", 
      RowBox[{"k", "[", "_", "]"}]}], "]"}], ",", "Infinity"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9118033402041063`*^9, 3.9118033466921883`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"cc86c73a-9715-4888-94fc-58d1ae521637"],

Cell[BoxData[
 RowBox[{"SetAttributes", "[", 
  RowBox[{
   RowBox[{"{", "scs", "}"}], ",", 
   RowBox[{"{", "Orderless", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.8838695095750723`*^9, {3.9098396326352215`*^9, 3.90983963419488*^9}, {
   3.909839726735963*^9, 3.909839734292127*^9}, {3.9098476667977057`*^9, 
   3.9098476728824415`*^9}, 3.909847715203187*^9, {3.9108860639361525`*^9, 
   3.9108860641235833`*^9}, {3.9112518208376203`*^9, 
   3.9112518210598793`*^9}, {3.9115803754415083`*^9, 3.9115803771479573`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"1b65fbd0-08fb-4ea0-9264-e4ee3c9a94df"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllOnshellinv", "[", 
   RowBox[{"we_", ",", "x3_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"we", "/.", "\[VeryThinSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["c_.", 
       SuperscriptBox[
        RowBox[{"k", "[", "i_", "]"}], "2"]], "/;", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", "x3", "}"}], ",", "i"}], "]"}]}], ":>", 
     FractionBox[
      RowBox[{
       SuperscriptBox["z", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"c", "/.", 
         RowBox[{
          RowBox[{
           RowBox[{"s", "[", "ii_", "]"}], "/;", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", "x3", "}"}], ",", "ii"}], "]"}]}], "->", 
          RowBox[{
           RowBox[{"s", "[", "ii", "]"}], "-", "1"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"s", "[", "i", "]"}], "-", "1"}], ")"}], "2"]}], "-", 
       FractionBox[
        SuperscriptBox["d", "2"], "4"]}]]}], "}"}]}]}]], "Input",
 CellChangeTimes->{
  3.905958416950892*^9, {3.911544942531663*^9, 3.9115449659073744`*^9}, 
   3.9115573233420897`*^9, {3.9115573647751412`*^9, 3.911557365747381*^9}, {
   3.9115574259907346`*^9, 3.911557450664091*^9}, 3.9115574874782095`*^9, {
   3.9115575686624165`*^9, 3.911557614827813*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"3a7f943d-8ccb-4a5f-a970-ec59170423fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllOnshellinvlist", "[", 
   RowBox[{"we_", ",", "x3_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"we", "//", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AllOnshellinv", "[", 
        RowBox[{"#", ",", "x3", ",", "z"}], "]"}], "&"}], ",", "#"}], "]"}], 
    "&"}]}]}]], "Input",
 CellChangeTimes->{{3.911557638813741*^9, 3.911557689950366*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"db283b66-0777-452b-8867-ab52b558dcc6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"softk1grav", "[", "p_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"p", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SuperscriptBox["ks", "2"], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "2", "]"}], "2"]}], ",", 
        RowBox[{
         SuperscriptBox["ks", "4"], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "2", "]"}], "4"]}], ",", 
        RowBox[{
         SuperscriptBox["ks", 
          RowBox[{"-", "2"}]], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "2", "]"}], 
          RowBox[{"-", "2"}]]}], ",", 
        RowBox[{
         SuperscriptBox["ks", 
          RowBox[{"-", "4"}]], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "2", "]"}], 
          RowBox[{"-", "4"}]]}]}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["kt", "2"], "->", 
        SuperscriptBox[
         RowBox[{"k", "[", "4", "]"}], "2"]}], ",", 
       RowBox[{
        SuperscriptBox["kt", "4"], "->", 
        SuperscriptBox[
         RowBox[{"k", "[", "4", "]"}], "4"]}], ",", 
       RowBox[{
        SuperscriptBox["kt", 
         RowBox[{"-", "2"}]], "->", 
        SuperscriptBox[
         RowBox[{"k", "[", "4", "]"}], 
         RowBox[{"-", "2"}]]}], ",", 
       RowBox[{
        SuperscriptBox["kt", 
         RowBox[{"-", "4"}]], "->", 
        SuperscriptBox[
         RowBox[{"k", "[", "4", "]"}], 
         RowBox[{"-", "4"}]]}]}], "}"}]}], "/.", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"k", "[", "1", "]"}], ",", "_"}], "]"}], "->", "0"}]}], "/.", 
   RowBox[{
    RowBox[{"k", "[", "1", "]"}], "->", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.9115765093422437`*^9, 3.9115765165642004`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"76aef263-1bdc-4324-bd2c-b6d2bdcbb86c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"softk1", "[", "p_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"p", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SuperscriptBox["ks", "2"], "->", 
          SuperscriptBox[
           RowBox[{"k", "[", "2", "]"}], "2"]}], ",", 
         RowBox[{
          SuperscriptBox["ks", "4"], "->", 
          SuperscriptBox[
           RowBox[{"k", "[", "2", "]"}], "4"]}], ",", 
         RowBox[{
          SuperscriptBox["ks", 
           RowBox[{"-", "2"}]], "->", 
          SuperscriptBox[
           RowBox[{"k", "[", "2", "]"}], 
           RowBox[{"-", "2"}]]}], ",", 
         RowBox[{
          SuperscriptBox["ks", 
           RowBox[{"-", "4"}]], "->", 
          SuperscriptBox[
           RowBox[{"k", "[", "2", "]"}], 
           RowBox[{"-", "4"}]]}]}], "}"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SuperscriptBox["kt", "2"], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "4", "]"}], "2"]}], ",", 
        RowBox[{
         SuperscriptBox["kt", "4"], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "4", "]"}], "4"]}], ",", 
        RowBox[{
         SuperscriptBox["kt", 
          RowBox[{"-", "2"}]], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "4", "]"}], 
          RowBox[{"-", "2"}]]}], ",", 
        RowBox[{
         SuperscriptBox["kt", 
          RowBox[{"-", "4"}]], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "4", "]"}], 
          RowBox[{"-", "4"}]]}]}], "}"}]}], "/.", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"k", "[", "i_", "]"}]}], "]"}], "->", "0"}]}], "/.", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"k", "[", "1", "]"}], ",", "_"}], "]"}], "->", "0"}]}], "/.", 
   RowBox[{
    RowBox[{"k", "[", "1", "]"}], "->", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.911543650231041*^9, 3.9115436621513553`*^9}, 
   3.9115585061172996`*^9, 3.911561981543016*^9},
 CellLabel->"In[40]:=",ExpressionUUID->"12d70e86-db7a-4716-9c61-6772312bc4b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"softk2", "[", "p_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"p", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SuperscriptBox["ks", "2"], "->", 
          SuperscriptBox[
           RowBox[{"k", "[", "1", "]"}], "2"]}], ",", 
         RowBox[{
          SuperscriptBox["ks", "4"], "->", 
          SuperscriptBox[
           RowBox[{"k", "[", "1", "]"}], "4"]}], ",", 
         RowBox[{
          SuperscriptBox["ks", 
           RowBox[{"-", "2"}]], "->", 
          SuperscriptBox[
           RowBox[{"k", "[", "1", "]"}], 
           RowBox[{"-", "2"}]]}], ",", 
         RowBox[{
          SuperscriptBox["ks", 
           RowBox[{"-", "4"}]], "->", 
          SuperscriptBox[
           RowBox[{"k", "[", "1", "]"}], 
           RowBox[{"-", "4"}]]}]}], "}"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SuperscriptBox["kt", "2"], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "3", "]"}], "2"]}], ",", 
        RowBox[{
         SuperscriptBox["kt", "4"], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "3", "]"}], "4"]}], ",", 
        RowBox[{
         SuperscriptBox["kt", 
          RowBox[{"-", "2"}]], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "3", "]"}], 
          RowBox[{"-", "2"}]]}], ",", 
        RowBox[{
         SuperscriptBox["kt", 
          RowBox[{"-", "4"}]], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "3", "]"}], 
          RowBox[{"-", "4"}]]}]}], "}"}]}], "/.", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"k", "[", "i_", "]"}]}], "]"}], "->", "0"}]}], "/.", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"k", "[", "2", "]"}], ",", "_"}], "]"}], "->", "0"}]}], "/.", 
   RowBox[{
    RowBox[{"k", "[", "2", "]"}], "->", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.9115583231665883`*^9, 3.911558344991724*^9}, 
   3.911558509162371*^9, 3.911561986893423*^9},
 CellLabel->"In[41]:=",ExpressionUUID->"392cdcbb-d355-4374-9426-a368929c1784"],

Cell[BoxData[
 RowBox[{
  RowBox[{"softk3", "[", "p_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"p", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SuperscriptBox["ks", "2"], "->", 
          SuperscriptBox[
           RowBox[{"k", "[", "4", "]"}], "2"]}], ",", 
         RowBox[{
          SuperscriptBox["ks", "4"], "->", 
          SuperscriptBox[
           RowBox[{"k", "[", "4", "]"}], "4"]}], ",", 
         RowBox[{
          SuperscriptBox["ks", 
           RowBox[{"-", "2"}]], "->", 
          SuperscriptBox[
           RowBox[{"k", "[", "4", "]"}], 
           RowBox[{"-", "2"}]]}], ",", 
         RowBox[{
          SuperscriptBox["ks", 
           RowBox[{"-", "4"}]], "->", 
          SuperscriptBox[
           RowBox[{"k", "[", "4", "]"}], 
           RowBox[{"-", "4"}]]}]}], "}"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SuperscriptBox["kt", "2"], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "2", "]"}], "2"]}], ",", 
        RowBox[{
         SuperscriptBox["kt", "4"], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "2", "]"}], "4"]}], ",", 
        RowBox[{
         SuperscriptBox["kt", 
          RowBox[{"-", "2"}]], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "2", "]"}], 
          RowBox[{"-", "2"}]]}], ",", 
        RowBox[{
         SuperscriptBox["kt", 
          RowBox[{"-", "4"}]], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "2", "]"}], 
          RowBox[{"-", "4"}]]}]}], "}"}]}], "/.", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"k", "[", "i_", "]"}]}], "]"}], "->", "0"}]}], "/.", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"k", "[", "3", "]"}], ",", "_"}], "]"}], "->", "0"}]}], "/.", 
   RowBox[{
    RowBox[{"k", "[", "3", "]"}], "->", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.912013992203238*^9, 3.912014037864622*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"55a169ed-8f4e-4e86-bd2b-f7e0e385c584"],

Cell[BoxData[
 RowBox[{
  RowBox[{"whatis", "[", 
   RowBox[{"wq_", ",", "si_", ",", "del_"}], "]"}], ":=", 
  RowBox[{"wq", "/.", 
   RowBox[{"si", "->", 
    RowBox[{
     FractionBox["del", "2"], "-", 
     FractionBox["d", "4"]}]}]}]}]], "Input",
 CellChangeTimes->{{3.9115443455628433`*^9, 3.9115443654601593`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"12013d4d-973b-4f12-9c80-968cbbb7267e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"k", "[", "1", "]"}], "->", "k1"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "1", "]"}], "->", "s1"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "1", "]"}], "->", "e1"}], ",", 
     RowBox[{
      RowBox[{"k", "[", "2", "]"}], "->", "k2"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "2", "]"}], "->", "s2"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "2", "]"}], "->", "e2"}], ",", 
     RowBox[{
      RowBox[{"k", "[", "3", "]"}], "->", "k3"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "3", "]"}], "->", "s3"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "3", "]"}], "->", "e3"}], ",", 
     RowBox[{
      RowBox[{"k", "[", "4", "]"}], "->", "k4"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "4", "]"}], "->", "s4"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "4", "]"}], "->", "e4"}], ",", 
     RowBox[{
      RowBox[{"k", "[", "5", "]"}], "->", "k5"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "5", "]"}], "->", "s5"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "5", "]"}], "->", "e5"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{3.9119956524162574`*^9},
 CellLabel->"In[44]:=",ExpressionUUID->"e0283e5e-9bc1-4f66-82a1-896d8e0bacfb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanMelindelta", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"x", "//", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exponent", "[", 
          RowBox[{"#", ",", "z1"}], "]"}], "==", 
         RowBox[{"-", "2"}]}], ",", 
        RowBox[{"ReplaceAll", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Mellindeltamy", "[", 
           RowBox[{"4", ",", 
            RowBox[{"-", "2"}], ",", 
            RowBox[{"s", "[", "4", "]"}]}], "]"}]}], "]"}], ",", "#"}], "]"}],
       "&"}]}], "//", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exponent", "[", 
         RowBox[{"#", ",", "z1"}], "]"}], "==", "0"}], ",", 
       RowBox[{"ReplaceAll", "[", 
        RowBox[{"#", ",", 
         RowBox[{"Mellindeltamy", "[", 
          RowBox[{"4", ",", "0", ",", 
           RowBox[{"s", "[", "4", "]"}]}], "]"}]}], "]"}], ",", "#"}], "]"}], 
     "&"}]}], "//", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Exponent", "[", 
        RowBox[{"#", ",", "z1"}], "]"}], "==", 
       RowBox[{"-", "4"}]}], ",", 
      RowBox[{"ReplaceAll", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Mellindeltamy", "[", 
         RowBox[{"4", ",", 
          RowBox[{"-", "4"}], ",", 
          RowBox[{"s", "[", "4", "]"}]}], "]"}]}], "]"}], ",", "#"}], "]"}], 
    "&"}]}]}]], "Input",
 CellChangeTimes->{{3.911540869211958*^9, 3.9115409383371787`*^9}, {
  3.9115410667317457`*^9, 3.9115410724129252`*^9}, {3.911541497773828*^9, 
  3.9115415043953753`*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"1c2c305d-825b-4dd7-ad6c-6a3c6338b558"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanMelindeltalist", "[", "x_", "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{"scanMelindelta", ",", "x"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.911541082299884*^9, 3.911541095391325*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"cc8930e0-20b5-40a9-9a6e-1f280e795486"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanMelindeltavar", "[", 
   RowBox[{"x_", ",", "si_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"x", "//", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Exponent", "[", 
            RowBox[{"#", ",", "z1"}], "]"}], "==", 
           RowBox[{"-", "2"}]}], ",", 
          RowBox[{"ReplaceAll", "[", 
           RowBox[{"#", ",", 
            RowBox[{"Mellindeltamy", "[", 
             RowBox[{"4", ",", 
              RowBox[{"-", "2"}], ",", "si"}], "]"}]}], "]"}], ",", "#"}], 
         "]"}], "&"}]}], "//", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exponent", "[", 
           RowBox[{"#", ",", "z1"}], "]"}], "==", "0"}], ",", 
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"#", ",", 
           RowBox[{"Mellindeltamy", "[", 
            RowBox[{"4", ",", "0", ",", "si"}], "]"}]}], "]"}], ",", "#"}], 
        "]"}], "&"}]}], "//", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exponent", "[", 
          RowBox[{"#", ",", "z1"}], "]"}], "==", 
         RowBox[{"-", "4"}]}], ",", 
        RowBox[{"ReplaceAll", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Mellindeltamy", "[", 
           RowBox[{"4", ",", 
            RowBox[{"-", "4"}], ",", "si"}], "]"}]}], "]"}], ",", "#"}], 
       "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exponent", "[", 
         RowBox[{"#", ",", "z1"}], "]"}], "==", "2"}], ",", 
       RowBox[{"ReplaceAll", "[", 
        RowBox[{"#", ",", 
         RowBox[{"Mellindeltamy", "[", 
          RowBox[{"4", ",", "2", ",", "si"}], "]"}]}], "]"}], ",", "#"}], 
      "]"}], "&"}]}], "//", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Exponent", "[", 
        RowBox[{"#", ",", "z1"}], "]"}], "==", "4"}], ",", 
      RowBox[{"ReplaceAll", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Mellindeltamy", "[", 
         RowBox[{"4", ",", "4", ",", "si"}], "]"}]}], "]"}], ",", "#"}], 
     "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.9115411563899508`*^9, 3.9115411722624655`*^9}, {
   3.911541541496923*^9, 3.9115415492203083`*^9}, {3.9117557274147344`*^9, 
   3.911755745059069*^9}, {3.9119322972712755`*^9, 3.9119323058969483`*^9}, 
   3.914430679421068*^9},
 CellLabel->"In[47]:=",ExpressionUUID->"d5959d73-e22c-4a85-8025-84d19224d714"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanMelindeltavar5", "[", 
   RowBox[{"x_", ",", "si_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "//", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Exponent", "[", 
                    RowBox[{"#", ",", "z1"}], "]"}], "==", 
                    RowBox[{"-", "2"}]}], ",", 
                    RowBox[{"ReplaceAll", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Mellindeltamy", "[", 
                    RowBox[{"5", ",", 
                    RowBox[{"-", "2"}], ",", "si"}], "]"}]}], "]"}], ",", 
                    "#"}], "]"}], "&"}]}], "//", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Exponent", "[", 
                    RowBox[{"#", ",", "z1"}], "]"}], "==", "0"}], ",", 
                    RowBox[{"ReplaceAll", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Mellindeltamy", "[", 
                    RowBox[{"5", ",", "0", ",", "si"}], "]"}]}], "]"}], ",", 
                    "#"}], "]"}], "&"}]}], "//", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Exponent", "[", 
                    RowBox[{"#", ",", "z1"}], "]"}], "==", 
                    RowBox[{"-", "4"}]}], ",", 
                    RowBox[{"ReplaceAll", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Mellindeltamy", "[", 
                    RowBox[{"5", ",", 
                    RowBox[{"-", "4"}], ",", "si"}], "]"}]}], "]"}], ",", 
                    "#"}], "]"}], "&"}]}], "//", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Exponent", "[", 
                    RowBox[{"#", ",", "z1"}], "]"}], "==", "2"}], ",", 
                   RowBox[{"ReplaceAll", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Mellindeltamy", "[", 
                    RowBox[{"5", ",", "2", ",", "si"}], "]"}]}], "]"}], ",", 
                   "#"}], "]"}], "&"}]}], "//", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Exponent", "[", 
                    RowBox[{"#", ",", "z1"}], "]"}], "==", "4"}], ",", 
                  RowBox[{"ReplaceAll", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"Mellindeltamy", "[", 
                    RowBox[{"5", ",", "4", ",", "si"}], "]"}]}], "]"}], ",", 
                  "#"}], "]"}], "&"}]}], "//", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Exponent", "[", 
                   RowBox[{"#", ",", "z1"}], "]"}], "==", "6"}], ",", 
                 RowBox[{"ReplaceAll", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"Mellindeltamy", "[", 
                    RowBox[{"5", ",", "6", ",", "si"}], "]"}]}], "]"}], ",", 
                 "#"}], "]"}], "&"}]}], "//", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Exponent", "[", 
                  RowBox[{"#", ",", "z1"}], "]"}], "==", 
                 RowBox[{"-", "6"}]}], ",", 
                RowBox[{"ReplaceAll", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"Mellindeltamy", "[", 
                   RowBox[{"5", ",", 
                    RowBox[{"-", "6"}], ",", "si"}], "]"}]}], "]"}], ",", 
                "#"}], "]"}], "&"}]}], "//", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Exponent", "[", 
                 RowBox[{"#", ",", "z1"}], "]"}], "==", 
                RowBox[{"-", "8"}]}], ",", 
               RowBox[{"ReplaceAll", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"Mellindeltamy", "[", 
                  RowBox[{"5", ",", 
                   RowBox[{"-", "8"}], ",", "si"}], "]"}]}], "]"}], ",", 
               "#"}], "]"}], "&"}]}], "//", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exponent", "[", 
                RowBox[{"#", ",", "z1"}], "]"}], "==", "8"}], ",", 
              RowBox[{"ReplaceAll", "[", 
               RowBox[{"#", ",", 
                RowBox[{"Mellindeltamy", "[", 
                 RowBox[{"5", ",", "8", ",", "si"}], "]"}]}], "]"}], ",", 
              "#"}], "]"}], "&"}]}], "//", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Exponent", "[", 
               RowBox[{"#", ",", "z1"}], "]"}], "==", 
              RowBox[{"-", "7"}]}], ",", 
             RowBox[{"ReplaceAll", "[", 
              RowBox[{"#", ",", 
               RowBox[{"Mellindeltamy", "[", 
                RowBox[{"5", ",", 
                 RowBox[{"-", "7"}], ",", "si"}], "]"}]}], "]"}], ",", "#"}], 
            "]"}], "&"}]}], "//", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exponent", "[", 
              RowBox[{"#", ",", "z1"}], "]"}], "==", "7"}], ",", 
            RowBox[{"ReplaceAll", "[", 
             RowBox[{"#", ",", 
              RowBox[{"Mellindeltamy", "[", 
               RowBox[{"5", ",", "7", ",", "si"}], "]"}]}], "]"}], ",", "#"}],
            "]"}], "&"}]}], "//", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Exponent", "[", 
             RowBox[{"#", ",", "z1"}], "]"}], "==", 
            RowBox[{"-", "5"}]}], ",", 
           RowBox[{"ReplaceAll", "[", 
            RowBox[{"#", ",", 
             RowBox[{"Mellindeltamy", "[", 
              RowBox[{"5", ",", 
               RowBox[{"-", "5"}], ",", "si"}], "]"}]}], "]"}], ",", "#"}], 
          "]"}], "&"}]}], "//", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Exponent", "[", 
            RowBox[{"#", ",", "z1"}], "]"}], "==", "5"}], ",", 
          RowBox[{"ReplaceAll", "[", 
           RowBox[{"#", ",", 
            RowBox[{"Mellindeltamy", "[", 
             RowBox[{"5", ",", "5", ",", "si"}], "]"}]}], "]"}], ",", "#"}], 
         "]"}], "&"}]}], "//", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exponent", "[", 
           RowBox[{"#", ",", "z1"}], "]"}], "==", 
          RowBox[{"-", "3"}]}], ",", 
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"#", ",", 
           RowBox[{"Mellindeltamy", "[", 
            RowBox[{"5", ",", 
             RowBox[{"-", "3"}], ",", "si"}], "]"}]}], "]"}], ",", "#"}], 
        "]"}], "&"}]}], "//", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exponent", "[", 
          RowBox[{"#", ",", "z1"}], "]"}], "==", "3"}], ",", 
        RowBox[{"ReplaceAll", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Mellindeltamy", "[", 
           RowBox[{"5", ",", "3", ",", "si"}], "]"}]}], "]"}], ",", "#"}], 
       "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exponent", "[", 
         RowBox[{"#", ",", "z1"}], "]"}], "==", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{"ReplaceAll", "[", 
        RowBox[{"#", ",", 
         RowBox[{"Mellindeltamy", "[", 
          RowBox[{"5", ",", 
           RowBox[{"-", "1"}], ",", "si"}], "]"}]}], "]"}], ",", "#"}], "]"}],
      "&"}]}], "//", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Exponent", "[", 
        RowBox[{"#", ",", "z1"}], "]"}], "==", "1"}], ",", 
      RowBox[{"ReplaceAll", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Mellindeltamy", "[", 
         RowBox[{"5", ",", "1", ",", "si"}], "]"}]}], "]"}], ",", "#"}], 
     "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.9119323306525764`*^9, 3.9119323851440964`*^9}, {
  3.9120952789306*^9, 3.912095293582445*^9}, {3.912858967570516*^9, 
  3.912858994191464*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"f8375f6b-22aa-43ea-9b6a-ff033f7afcb2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanMelindeltalistvar5", "[", 
   RowBox[{"x_", ",", "si_"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"scanMelindeltavar5", "[", 
      RowBox[{"#", ",", "si"}], "]"}], "&"}], ",", "x"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.911932394369542*^9, 3.9119323952558784`*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"3aee35f5-f483-4f4e-be90-759895047f0c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanMelindeltalistvar", "[", 
   RowBox[{"x_", ",", "si_"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"scanMelindeltavar", "[", 
      RowBox[{"#", ",", "si"}], "]"}], "&"}], ",", "x"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9115411782006636`*^9, 3.911541179999627*^9}, {
  3.9115412161354094`*^9, 3.9115412517941337`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"f7e77498-7e06-40d1-8507-7aaf8dd4e367"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanK2sOnshell", "[", 
   RowBox[{"p_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "[", 
     RowBox[{"FreeQ", "[", 
      RowBox[{"p", ",", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"k", "[", "i", "]"}], ",", "2"}], "]"}]}], "]"}], "]"}], ",", 
    RowBox[{"ReplaceAll", "[", 
     RowBox[{
      RowBox[{"p", "/.", 
       RowBox[{
        RowBox[{"s", "[", "i", "]"}], "->", 
        RowBox[{
         RowBox[{"s", "[", "i", "]"}], "+", "1"}]}]}], ",", 
      RowBox[{"Onshellcy", "[", 
       RowBox[{"d", ",", 
        RowBox[{"k", "[", "i", "]"}], ",", "z1"}], "]"}]}], "]"}], ",", "p"}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.911401498263362*^9, 3.911401529936572*^9}, {
  3.9114015667255025`*^9, 3.9114016637008767`*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"7a34bd8b-45e3-4557-937e-ff9ed1bd990a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanK2sOnshelllist", "[", "p_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"p", "//", 
       RowBox[{
        RowBox[{"scanK2sOnshell", "[", 
         RowBox[{"#", ",", "2"}], "]"}], "&"}]}], "//", 
      RowBox[{
       RowBox[{"scanK2sOnshell", "[", 
        RowBox[{"#", ",", "3"}], "]"}], "&"}]}], "//", 
     RowBox[{
      RowBox[{"scanK2sOnshell", "[", 
       RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"scanK2sOnshell", "[", 
      RowBox[{"#", ",", "4"}], "]"}], "&"}]}], "//", 
   RowBox[{
    RowBox[{"scanK2sOnshell", "[", 
     RowBox[{"#", ",", "5"}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.91140174603898*^9, 3.911401797054324*^9}, {
  3.9114018378165264`*^9, 3.9114018511659355`*^9}, {3.911924226609928*^9, 
  3.9119242282888126`*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"5bb7c6c9-6834-4047-ac7b-2727a4c2a329"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanK2sOnshelllistmap", "[", "p_", "]"}], ":=", 
  RowBox[{"p", "//", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"scanK2sOnshelllist", ",", "#"}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.9114036693173323`*^9, 3.9114036757702*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"e67f1094-e3d7-4c7a-86fc-6b17d5094e7f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rulesinv", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k1", "->", 
      RowBox[{"k", "[", "1", "]"}]}], ",", 
     RowBox[{"s1", "->", 
      RowBox[{"s", "[", "1", "]"}]}], ",", 
     RowBox[{"e1", "->", 
      RowBox[{"e", "[", "1", "]"}]}], ",", 
     RowBox[{"k2", "->", 
      RowBox[{"k", "[", "2", "]"}]}], ",", 
     RowBox[{"s2", "->", 
      RowBox[{"s", "[", "2", "]"}]}], ",", 
     RowBox[{"e2", "->", 
      RowBox[{"e", "[", "2", "]"}]}], ",", 
     RowBox[{"k3", "->", 
      RowBox[{"k", "[", "3", "]"}]}], ",", 
     RowBox[{"s3", "->", 
      RowBox[{"s", "[", "3", "]"}]}], ",", 
     RowBox[{"e3", "->", 
      RowBox[{"e", "[", "3", "]"}]}], ",", 
     RowBox[{"k4", "->", 
      RowBox[{"k", "[", "4", "]"}]}], ",", 
     RowBox[{"s4", "->", 
      RowBox[{"s", "[", "4", "]"}]}], ",", 
     RowBox[{"e4", "->", 
      RowBox[{"e", "[", "4", "]"}]}], ",", 
     RowBox[{"k5", "->", 
      RowBox[{"k", "[", "5", "]"}]}], ",", 
     RowBox[{"s5", "->", 
      RowBox[{"s", "[", "5", "]"}]}], ",", 
     RowBox[{"e5", "->", 
      RowBox[{"e", "[", "5", "]"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9114999392307577`*^9, 3.9114999424796515`*^9}, {
  3.911500015554905*^9, 3.911500017942329*^9}, {3.9117146138178663`*^9, 
  3.9117146368223886`*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"be80e31c-af80-40b1-9c3b-5cb2fdbb497d"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Mellindeltamy", "[", 
    RowBox[{"n_", ",", "b_", ",", "a_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"2", 
             RowBox[{"s", "[", "i", "]"}]}], "-", 
            RowBox[{"d", "/", "2"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "+", "d", "-", 
         "b"}], "\[Equal]", "0"}], ",", "a"}], "]"}], "}"}], "//", 
    "Flatten"}]}]}]], "Input",
 CellChangeTimes->{{3.9114039521715155`*^9, 3.9114039522255793`*^9}, {
   3.9114039841508985`*^9, 3.911403985331539*^9}, 3.911543205818709*^9},
 CellLabel->"In[55]:=",ExpressionUUID->"005ae8a7-d56b-48b3-8e4f-acb3dbf26526"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getExponent", "[", "ppow_", "]"}], ":=", 
  RowBox[{"ppow", "//", 
   RowBox[{
    RowBox[{"Exponent", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"k", "[", "1", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}], ",", 
        RowBox[{"k", "[", "3", "]"}], ",", 
        RowBox[{"k", "[", "4", "]"}], ",", 
        RowBox[{"k", "[", "5", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}], ",", 
        RowBox[{"kk", "[", "2", "]"}], ",", 
        RowBox[{"kk", "[", "3", "]"}], ",", 
        RowBox[{"kk", "[", "4", "]"}], ",", 
        RowBox[{"kk", "[", "5", "]"}], ",", 
        RowBox[{"kkk", "[", "1", "]"}], ",", 
        RowBox[{"kkk", "[", "2", "]"}], ",", 
        RowBox[{"kkk", "[", "3", "]"}], ",", 
        RowBox[{"kkk", "[", "4", "]"}], ",", 
        RowBox[{"kkk", "[", "5", "]"}], ",", 
        RowBox[{"kkkk", "[", "1", "]"}], ",", 
        RowBox[{"kkkk", "[", "2", "]"}], ",", 
        RowBox[{"kkkk", "[", "3", "]"}], ",", 
        RowBox[{"kkkk", "[", "4", "]"}], ",", 
        RowBox[{"kkkk", "[", "5", "]"}], ",", 
        RowBox[{"s", "[", "1", "]"}], ",", 
        RowBox[{"s", "[", "2", "]"}], ",", 
        RowBox[{"s", "[", "3", "]"}], ",", 
        RowBox[{"s", "[", "4", "]"}], ",", 
        RowBox[{"s", "[", "5", "]"}]}], "}"}]}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.912094541089758*^9, 3.912094545593626*^9}, {
  3.912094782248851*^9, 3.9120948079205585`*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"b4c2ae9e-7336-45eb-88b4-1ea3628ad366"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s3k2rl", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s", "[", "1", "]"}], "==", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "d", "-", 
          RowBox[{"2", " ", 
           RowBox[{"s", "[", "2", "]"}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"s", "[", "3", "]"}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"s", "[", "4", "]"}]}]}], ")"}]}]}], "}"}], "//", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"s", "[", "3", "]"}], "}"}]}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}]}]}], ";"}]], "Input",
 CellLabel->"In[57]:=",ExpressionUUID->"0d7ace40-069e-46f6-ae8b-3302885f5d9a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Onshellcy", "[", 
   RowBox[{"del_", ",", 
    RowBox[{"k", "[", "a_", "]"}], ",", "z_"}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"k", "[", "a", "]"}], "2"], ":>", 
   FractionBox[
    RowBox[{
     RowBox[{"4", 
      SuperscriptBox[
       RowBox[{"s", "[", "a", "]"}], "2"]}], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        FractionBox["d", "2"], "-", "del"}], ")"}], "2"]}], 
    SuperscriptBox["z", "2"]]}]}]], "Input",
 CellChangeTimes->{{3.9113863747189236`*^9, 3.9113863859231634`*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"1a684c9f-5249-43c2-b511-1d3c967e76eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Onshell", "[", "pqw_", "]"}], ":=", 
  RowBox[{"pqw", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Onshellcy", "[", 
      RowBox[{"d", ",", 
       RowBox[{"k", "[", "1", "]"}], ",", "z1"}], "]"}], ",", 
     RowBox[{"Onshellcy", "[", 
      RowBox[{"d", ",", 
       RowBox[{"k", "[", "2", "]"}], ",", "z1"}], "]"}], ",", 
     RowBox[{"Onshellcy", "[", 
      RowBox[{"d", ",", 
       RowBox[{"k", "[", "3", "]"}], ",", "z1"}], "]"}], ",", 
     RowBox[{"Onshellcy", "[", 
      RowBox[{"d", ",", 
       RowBox[{"k", "[", "4", "]"}], ",", "z1"}], "]"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.9113863598692675`*^9, 3.9113864182356234`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"03348e9f-f810-4afd-b20d-3878f32fd180"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1k0rl", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"s", "[", "1", "]"}], "+", 
       RowBox[{"s", "[", "2", "]"}], "+", 
       RowBox[{"s", "[", "3", "]"}], "+", 
       RowBox[{"s", "[", "4", "]"}]}], "==", 
      FractionBox["d", "2"]}], "//", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"#", ",", 
        RowBox[{"s", "[", "1", "]"}]}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s4k0rl", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"s", "[", "1", "]"}], "+", 
       RowBox[{"s", "[", "2", "]"}], "+", 
       RowBox[{"s", "[", "3", "]"}], "+", 
       RowBox[{"s", "[", "4", "]"}]}], "==", 
      FractionBox["d", "2"]}], "//", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"#", ",", 
        RowBox[{"s", "[", "4", "]"}]}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}]}]}], ";"}]}], "Input",
 CellLabel->"In[60]:=",ExpressionUUID->"dbaf73f3-37d9-4b93-917a-39edbb244d48"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s3k0rl", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"s", "[", "1", "]"}], "==", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"d", "-", 
         RowBox[{"2", " ", 
          RowBox[{"s", "[", "2", "]"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"s", "[", "3", "]"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"s", "[", "4", "]"}]}]}], ")"}]}]}], "//", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"#", ",", 
        RowBox[{"s", "[", "3", "]"}]}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}]}]}], ";"}]], "Input",
 CellLabel->"In[62]:=",ExpressionUUID->"2e230abd-4fb5-447b-8fcf-cfe4a3d133d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s3km2rl", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"s", "[", "1", "]"}], "==", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "d", "-", 
         RowBox[{"2", " ", 
          RowBox[{"s", "[", "2", "]"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"s", "[", "3", "]"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"s", "[", "4", "]"}]}]}], ")"}]}]}], "//", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"#", ",", 
        RowBox[{"s", "[", "3", "]"}]}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}]}]}], ";"}]], "Input",
 CellChangeTimes->{3.911386002813303*^9},
 CellLabel->"In[63]:=",ExpressionUUID->"6d3e7e72-4598-49e3-9ca9-a894c4e6a710"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s1km2rl", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"d", "+", "2"}], "\[Equal]", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"s", "[", "1", "]"}], "+", 
         RowBox[{"s", "[", "2", "]"}], "+", 
         RowBox[{"s", "[", "3", "]"}], "+", 
         RowBox[{"s", "[", "4", "]"}]}], ")"}]}]}], "//", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"#", ",", 
        RowBox[{"s", "[", "1", "]"}]}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}]}]}], ";"}]], "Input",
 CellLabel->"In[64]:=",ExpressionUUID->"7bee7357-afe7-4c28-921e-399375b400d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToShortestHelicityBasis4", "[", "o_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"o", "/.", 
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "x4_", "]"}], ",", 
         RowBox[{"k", "[", "x2_", "]"}]}], "]"}], "+", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "x4_", "]"}], ",", 
         RowBox[{"k", "[", "x3_", "]"}]}], "]"}]}], ":>", 
      RowBox[{"-", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "x4", "]"}], ",", 
         RowBox[{"k", "[", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"Range", "[", "4", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x2", ",", "x3"}], "}"}]}], "]"}], "]"}]}], "]"}]}]}]}], 
    "/.", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "x4_", "]"}], ",", 
       RowBox[{"k", "[", "l_List", "]"}]}], "]"}], "->", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "x4", "]"}], ",", 
         RowBox[{"k", "[", "i", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "l"}], "}"}]}], "]"}]}]}], "/.", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"k", "[", "i_", "]"}], ",", 
      RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.911388559510954*^9, 3.9113886278817253`*^9}, {
   3.9113887229122057`*^9, 3.9113887946341333`*^9}, {3.911389125466278*^9, 
   3.9113891278219557`*^9}, {3.911389179033951*^9, 3.911389208827175*^9}, {
   3.911651475791501*^9, 3.9116514829390297`*^9}, 3.9116517035678773`*^9, {
   3.911667585666851*^9, 3.9116675866991587`*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"5c928e27-faa0-477e-a4dd-51e1029148d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nok4e4", "[", "p_", "]"}], ":=", 
  RowBox[{"p", "/.", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"k", "[", "i_", "]"}], ",", 
      RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.9113888151405153`*^9, 3.9113888249630356`*^9}, {
   3.9116516137805495`*^9, 3.911651616862626*^9}, {3.9116675938583*^9, 
   3.911667595203745*^9}, 3.9131316298094816`*^9},
 CellLabel->"In[66]:=",ExpressionUUID->"3569a8c7-dd60-4c54-a933-7b0e9daf0954"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nokiei", "[", "p_", "]"}], ":=", 
  RowBox[{"p", "/.", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"k", "[", "i_", "]"}], ",", 
      RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.91313163254116*^9, 3.9131316335797586`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"bed9cba4-36c4-473c-9265-475c3d411f4b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1k2rl", "=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"2", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"s", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], "==", 
      RowBox[{"d", "-", "2"}]}], "//", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"#", ",", 
        RowBox[{"s", "[", "1", "]"}]}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s4k2rl", "=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"2", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"s", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], "==", 
      RowBox[{"d", "-", "2"}]}], "//", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"#", ",", 
        RowBox[{"s", "[", "4", "]"}]}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.911400754351497*^9, 3.9114007552420063`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"99cc1e9e-4f6e-4888-bd54-d27f0545f429"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"scs", "/:", 
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"scs", "[", 
       RowBox[{
        RowBox[{"k", "[", "i_", "]"}], ",", 
        RowBox[{"\[Mu]", "[", 
         RowBox[{"e", "[", "j_", "]"}], "]"}]}], "]"}], ",", "StandardForm"}],
      "]"}], ":=", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["k", "i"], ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["\[Epsilon]", "j"], ",", "StandardForm"}], "]"}]}], 
      "}"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeExpression", "[", 
     RowBox[{"(*", "assa", "*)"}], 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["k", "i_"], ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["\[Epsilon]", "j_"], ",", "StandardForm"}], "]"}]}], 
        "}"}], "]"}], 
      RowBox[{"(*", ".", "*)"}], ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"MakeExpression", "[", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<scs\>\"", ",", "\"\<[\>\"", ",", 
         RowBox[{"k", "[", "i", "]"}], ",", "\"\<,\>\"", ",", 
         RowBox[{"\[Mu]", "[", 
          RowBox[{"e", "[", "j", "]"}], "]"}], ",", "\"\<]\>\""}], "}"}], 
       "]"}], ",", "StandardForm"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"scs", "/:", 
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"scs", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", 
         RowBox[{"e", "[", "i_", "]"}], "]"}], ",", 
        RowBox[{"\[Mu]", "[", 
         RowBox[{"e", "[", "j_", "]"}], "]"}]}], "]"}], ",", "StandardForm"}],
      "]"}], ":=", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["\[Epsilon]", "i"], ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["\[Epsilon]", "j"], ",", "StandardForm"}], "]"}]}], 
      "}"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeExpression", "[", 
     RowBox[{"(*", "assa", "*)"}], 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["\[Epsilon]", "i_"], ",", "StandardForm"}], "]"}], 
         ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["\[Epsilon]", "j_"], ",", "StandardForm"}], "]"}]}], 
        "}"}], "]"}], 
      RowBox[{"(*", ".", "*)"}], ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"MakeExpression", "[", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<scs\>\"", ",", "\"\<[\>\"", ",", 
         RowBox[{"\[Mu]", "[", 
          RowBox[{"e", "[", "i", "]"}], "]"}], ",", "\"\<,\>\"", ",", 
         RowBox[{"\[Mu]", "[", 
          RowBox[{"e", "[", "j", "]"}], "]"}], ",", "\"\<]\>\""}], "}"}], 
       "]"}], ",", "StandardForm"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"scs", "/:", 
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"scs", "[", 
       RowBox[{
        RowBox[{"k", "[", "i_", "]"}], ",", 
        RowBox[{"k", "[", "j_", "]"}]}], "]"}], ",", "StandardForm"}], "]"}], 
    ":=", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["k", "i"], ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["k", "j"], ",", "StandardForm"}], "]"}]}], "}"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeExpression", "[", 
     RowBox[{"(*", "assa", "*)"}], 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["k", "i_"], ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["k", "j_"], ",", "StandardForm"}], "]"}]}], "}"}], 
       "]"}], 
      RowBox[{"(*", ".", "*)"}], ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"MakeExpression", "[", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<scs\>\"", ",", "\"\<[\>\"", ",", 
         RowBox[{"k", "[", "i", "]"}], ",", "\"\<,\>\"", ",", 
         RowBox[{"k", "[", "j", "]"}], ",", "\"\<]\>\""}], "}"}], "]"}], ",", 
      "StandardForm"}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"scs", "/:", 
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"scs", "[", 
       RowBox[{
        RowBox[{"k", "[", "i_", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "j_", "]"}]}], "]"}], ",", "StandardForm"}], 
     "]"}], ":=", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{"MakeBoxes", "[", 
       RowBox[{"Subsuperscript", "[", 
        RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeExpression", "[", 
     RowBox[{"(*", "assa", "*)"}], 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"MakeBoxes", "[", 
         RowBox[{"Subsuperscript", "[", 
          RowBox[{"k", ",", "i_", ",", "j_"}], "]"}], "]"}], "}"}], "]"}], 
      RowBox[{"(*", ".", "*)"}], ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"MakeExpression", "[", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<scs\>\"", ",", "\"\<[\>\"", ",", 
         RowBox[{"k", "[", "i", "]"}], ",", "\"\<,\[Mu][\>\"", ",", "j", ",", 
         "\"\<]\>\""}], "}"}], "]"}], ",", "StandardForm"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"scs", "/:", 
    RowBox[{"MakeBoxes", "[", " ", 
     RowBox[{
      RowBox[{"scs", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "i_", "]"}], ",", 
        RowBox[{"\[Mu]", "[", 
         RowBox[{"e", "[", "j_", "]"}], "]"}]}], "]"}], ",", "StandardForm"}],
      "]"}], ":=", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{"MakeBoxes", "[", 
       RowBox[{"Subsuperscript", "[", 
        RowBox[{"\[Epsilon]", ",", "j", ",", "i"}], "]"}], "]"}], "}"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeExpression", "[", 
     RowBox[{"(*", "assa", "*)"}], 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"MakeBoxes", "[", 
         RowBox[{"Subsuperscript", "[", 
          RowBox[{"\[Epsilon]", ",", "j_", ",", "i_"}], "]"}], "]"}], "}"}], 
       "]"}], 
      RowBox[{"(*", ".", "*)"}], ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"MakeExpression", "[", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<scs\>\"", ",", "\"\<[\>\"", ",", 
         RowBox[{"\[Mu]", "[", "i", "]"}], ",", "\"\<,\>\"", ",", 
         RowBox[{"\[Mu]", "[", 
          RowBox[{"e", "[", "j", "]"}], "]"}], ",", "\"\<]\>\""}], "}"}], 
       "]"}], ",", "StandardForm"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.9099065825303125`*^9, {3.909906757121278*^9, 3.90990692325452*^9}, {
   3.9099070318984594`*^9, 3.9099070705249567`*^9}, {3.9103670753061733`*^9, 
   3.910367100158693*^9}, {3.9103671509495716`*^9, 3.910367195426556*^9}, {
   3.9103672471932325`*^9, 3.9103673881680536`*^9}, {3.911464136504984*^9, 
   3.9114641587984686`*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"174eaa37-8ea4-4226-b586-96199a3d0142"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"scs", "/:", 
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"scs", "[", 
       RowBox[{
        RowBox[{"e", "[", "i_", "]"}], ",", 
        RowBox[{"e", "[", "j_", "]"}]}], "]"}], ",", "StandardForm"}], "]"}], 
    ":=", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["\[Epsilon]", "i"], ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["\[Epsilon]", "j"], ",", "StandardForm"}], "]"}]}], 
      "}"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeExpression", "[", 
     RowBox[{"(*", "assa", "*)"}], 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["\[Epsilon]", "i_"], ",", "StandardForm"}], "]"}], 
         ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["\[Epsilon]", "j_"], ",", "StandardForm"}], "]"}]}], 
        "}"}], "]"}], 
      RowBox[{"(*", ".", "*)"}], ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"MakeExpression", "[", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<scs\>\"", ",", "\"\<[\>\"", ",", 
         RowBox[{"e", "[", "i", "]"}], ",", "\"\<,\>\"", ",", 
         RowBox[{"e", "[", "j", "]"}], ",", "\"\<]\>\""}], "}"}], "]"}], ",", 
      "StandardForm"}], "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.911385873851326*^9, 3.9113858839041257`*^9}, {
  3.9114641595825324`*^9, 3.911464162646982*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"dcb4326b-093d-4cb0-82c0-8103badbe3b7"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"scs", "/:", 
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"scs", "[", 
       RowBox[{
        RowBox[{"k", "[", "i_", "]"}], ",", 
        RowBox[{"e", "[", "j_", "]"}]}], "]"}], ",", "StandardForm"}], "]"}], 
    ":=", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["k", "i"], ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["\[Epsilon]", "j"], ",", "StandardForm"}], "]"}]}], 
      "}"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeExpression", "[", 
     RowBox[{"(*", "assa", "*)"}], 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["k", "i_"], ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["\[Epsilon]", "j_"], ",", "StandardForm"}], "]"}]}], 
        "}"}], "]"}], 
      RowBox[{"(*", ".", "*)"}], ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"MakeExpression", "[", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<scs\>\"", ",", "\"\<[\>\"", ",", 
         RowBox[{"k", "[", "i", "]"}], ",", "\"\<,\>\"", ",", 
         RowBox[{"e", "[", "j", "]"}], ",", "\"\<]\>\""}], "}"}], "]"}], ",", 
      "StandardForm"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9113871263053465`*^9, 3.9113871303995695`*^9}, {
  3.9114641635763035`*^9, 3.9114641654090877`*^9}, {3.911580308431387*^9, 
  3.911580314008539*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"3888dbcf-88fa-4287-acf3-1956400c0e10"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"scs", "/:", 
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"scs", "[", 
       RowBox[{
        RowBox[{"e", "[", "j_", "]"}], ",", 
        RowBox[{"k", "[", "i_", "]"}]}], "]"}], ",", "StandardForm"}], "]"}], 
    ":=", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["k", "i"], ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["\[Epsilon]", "j"], ",", "StandardForm"}], "]"}]}], 
      "}"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeExpression", "[", 
     RowBox[{"(*", "assa", "*)"}], 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["k", "i_"], ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["\[Epsilon]", "j_"], ",", "StandardForm"}], "]"}]}], 
        "}"}], "]"}], 
      RowBox[{"(*", ".", "*)"}], ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"MakeExpression", "[", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<scs\>\"", ",", "\"\<[\>\"", ",", 
         RowBox[{"k", "[", "i", "]"}], ",", "\"\<,\>\"", ",", 
         RowBox[{"e", "[", "j", "]"}], ",", "\"\<]\>\""}], "}"}], "]"}], ",", 
      "StandardForm"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"ksqs", "/:", 
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"ksqs", "[", 
       RowBox[{"i_", ",", "j_"}], "]"}], ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["k", "i"], ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["k", "j"], ",", "StandardForm"}], "]"}]}], "}"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeExpression", "[", 
     RowBox[{"(*", "assa", "*)"}], 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["k", "i_"], ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["k", "j_"], ",", "StandardForm"}], "]"}]}], "}"}], 
       "]"}], 
      RowBox[{"(*", ".", "*)"}], ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"MakeExpression", "[", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{
        "\"\<ksqs\>\"", ",", "\"\<[\>\"", ",", "i", ",", "\"\<,\>\"", ",", 
         "j", ",", "\"\<]\>\""}], "}"}], "]"}], ",", "StandardForm"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9115803244525957`*^9, 3.911580329434168*^9}, {
  3.9118045233139944`*^9, 3.9118045555108185`*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"356d99cb-dd25-429b-a3e0-24771df96802"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToDisplay", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"x", "/.", 
    RowBox[{"sc", "->", "scs"}]}], "/.", 
   RowBox[{"ksq", "->", "ksqs"}]}]}]], "Input",
 CellChangeTimes->{{3.911464170268661*^9, 3.9114641802507124`*^9}, {
  3.9118045591801243`*^9, 3.9118045630658555`*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"f0ff4b37-b95c-433f-a2f7-168eea781df7"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Clear", "@", "sc"}], "*)"}]], "Input",
 CellChangeTimes->{{3.9113860464219103`*^9, 3.911386048729699*^9}, 
   3.911387124167036*^9, 3.911390488563719*^9, 3.9113992879475193`*^9},
 CellLabel->"In[89]:=",ExpressionUUID->"b4a3cee6-278b-43a5-b158-ea63eaea130f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllOnshellinv", "[", 
   RowBox[{"we_", ",", "x3_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"we", "/.", "\[VeryThinSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["c_.", 
       SuperscriptBox[
        RowBox[{"k", "[", "i_", "]"}], "2"]], "/;", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", "x3", "}"}], ",", "i"}], "]"}]}], ":>", 
     FractionBox[
      RowBox[{
       SuperscriptBox["z", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"c", "/.", 
         RowBox[{
          RowBox[{
           RowBox[{"s", "[", "ii_", "]"}], "/;", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", "x3", "}"}], ",", "ii"}], "]"}]}], "->", 
          RowBox[{
           RowBox[{"s", "[", "ii", "]"}], "-", "1"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"s", "[", "i", "]"}], "-", "1"}], ")"}], "2"]}], "-", 
       FractionBox[
        SuperscriptBox["d", "2"], "4"]}]]}], "}"}]}]}]], "Input",
 CellChangeTimes->{
  3.905958416950892*^9, {3.911544942531663*^9, 3.9115449659073744`*^9}, 
   3.9115573233420897`*^9, {3.9115573647751412`*^9, 3.911557365747381*^9}, {
   3.9115574259907346`*^9, 3.911557450664091*^9}, 3.9115574874782095`*^9, {
   3.9115575686624165`*^9, 3.911557614827813*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"987a17fd-d0a1-4b16-bd57-f3dd49f0b19d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"myFunction", "[", "resope_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ress", ",", "resf", ",", "ressf"}], "}"}], ",", 
     RowBox[{
      RowBox[{"ress", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"resope", "/.", " ", "AdS5ptmy"}], "/.", " ", 
                RowBox[{
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i_", "]"}], ",", 
                   RowBox[{"k", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.",
                " ", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"k", "[", "i_", "]"}], ",", 
                  RowBox[{"k", "[", "i_", "]"}]}], "]"}], ":>", 
                RowBox[{
                 RowBox[{"k", "[", "i", "]"}], "^", "2"}]}]}], "/.", " ", 
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"k", "[", "i_", "]"}], ",", 
                 RowBox[{"k", "[", "j_", "]"}]}], "]"}], "->", 
               RowBox[{
                RowBox[{"1", "/", "2"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ks", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], "^", "2"}], "-", 
                  RowBox[{
                   RowBox[{"k", "[", "i", "]"}], "^", "2"}], "-", 
                  RowBox[{
                   RowBox[{"k", "[", "j", "]"}], "^", "2"}]}], ")"}]}]}]}], "/.",
              " ", "kijrl"}], "/.", " ", "AdS5ptmy"}], "/.", " ", 
           RowBox[{
            RowBox[{"s", "[", "i_", "]"}], ":>", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"z1", " ", 
               RowBox[{"k", "[", "i", "]"}]}], ")"}], "/", "2"}]}]}], "/.", 
          " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"k", "[", "i_", "]"}], ",", 
               RowBox[{"k", "[", "j_", "]"}]}], "]"}], ":>", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"kk", "[", "i", "]"}], ",", 
               RowBox[{"kk", "[", "j", "]"}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i_", "]"}], ",", 
               RowBox[{"k", "[", "j_", "]"}]}], "]"}], ":>", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i", "]"}], ",", 
               RowBox[{"kk", "[", "j", "]"}]}], "]"}]}]}], "}"}]}], "/.", " ", 
         RowBox[{
          RowBox[{"k", "[", "3", "]"}], "->", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"k", "[", "1", "]"}]}], "-", 
           RowBox[{"k", "[", "2", "]"}], "-", 
           RowBox[{"k", "[", "5", "]"}], "-", 
           RowBox[{"k", "[", "4", "]"}]}]}]}], "/.", " ", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"D", ",", 
           RowBox[{"ks", "[", 
            RowBox[{"i_", ",", "j_"}], "]"}]}], "]"}], "->", 
         RowBox[{
          RowBox[{"z1", "^", "2"}], " ", 
          RowBox[{"S", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"resf", "=", 
       RowBox[{"ress", "//", 
        RowBox[{
         RowBox[{"Series", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"z1", ",", "\[Infinity]", ",", "1"}], "}"}]}], "]"}], 
         "&"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ressf", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"resf", "/.", " ", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"e", "[", "i_", "]"}], ",", 
                  RowBox[{"e", "[", "i_", "]"}]}], "]"}], "->", "0"}]}], "/.",
               " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"e", "[", "i_", "]"}], ",", 
                  RowBox[{"kk", "[", "1", "]"}]}], "]"}], ":>", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"sc", "[", 
                   RowBox[{
                    RowBox[{"e", "[", "i", "]"}], ",", 
                    RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i", "]"}], ",", 
                   RowBox[{"kk", "[", "3", "]"}]}], "]"}], "-", 
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i", "]"}], ",", 
                   RowBox[{"kk", "[", "4", "]"}]}], "]"}], "-", 
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i", "]"}], ",", 
                   RowBox[{"kk", "[", "5", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
             " ", 
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"kk", "[", "i_", "]"}], ",", 
                RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", 
            " ", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i_", "]"}], ",", 
               RowBox[{"kk", "[", "3", "]"}]}], "]"}], ":>", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"e", "[", "i", "]"}], ",", 
                 RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"kk", "[", "4", "]"}]}], "]"}], "-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"kk", "[", "1", "]"}]}], "]"}], "-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"kk", "[", "5", "]"}]}], "]"}]}]}]}], "/.", " ", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"kk", "[", "i_", "]"}], ",", 
              RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "//", 
          "Normal"}], "//", 
         RowBox[{"ReplaceAll", "[", 
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{"x1_", ",", "x2_"}], "]"}], "->", 
           RowBox[{
            RowBox[{
             RowBox[{"ks", "[", 
              RowBox[{"x1", ",", "x2"}], "]"}], "^", "2"}], "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"k", "[", "x1", "]"}], "^", "2"}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"k", "[", "x1", "]"}], " ", 
               RowBox[{"k", "[", "x2", "]"}]}], "+", 
              RowBox[{
               RowBox[{"k", "[", "x2", "]"}], "^", "2"}]}], ")"}]}]}], 
          "]"}]}], "//", 
        RowBox[{
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"k", "[", "3", "]"}], "->", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"k", "[", "1", "]"}]}], "-", 
             RowBox[{"k", "[", "2", "]"}], "-", 
             RowBox[{"k", "[", "5", "]"}], "-", 
             RowBox[{"k", "[", "4", "]"}]}]}]}], "]"}], "&"}]}]}], ";", 
      RowBox[{"Return", "[", "ressf", "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9130474291728506`*^9, 3.913047449466036*^9}, {
  3.9130479131508384`*^9, 3.9130479368870506`*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"aaf36d17-0803-4321-a484-dbe24af20ee1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlatSpaceMinimalEandK", "[", 
   RowBox[{"px_", ",", "kk_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"px", "/.", "\[VeryThinSpace]", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "i_", "]"}], ",", 
          RowBox[{"e", "[", "i_", "]"}]}], "]"}], "\[Rule]", "0"}]}], "/.", 
      "\[VeryThinSpace]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "i_", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], ",", 
            RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i", "]"}], ",", 
           RowBox[{"kk", "[", "3", "]"}]}], "]"}], "-", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i", "]"}], ",", 
           RowBox[{"kk", "[", "4", "]"}]}], "]"}], "-", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i", "]"}], ",", 
           RowBox[{"kk", "[", "5", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
     "\[VeryThinSpace]", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"kk", "[", "i_", "]"}], ",", 
        RowBox[{"e", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", "0"}]}], "/.",
     "\[VeryThinSpace]", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "i_", "]"}], ",", 
       RowBox[{"kk", "[", "3", "]"}]}], "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "i", "]"}], ",", 
         RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"kk", "[", "4", "]"}]}], "]"}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"kk", "[", "5", "]"}]}], "]"}]}]}]}], "/.", 
   "\[VeryThinSpace]", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"kk", "[", "i_", "]"}], ",", 
      RowBox[{"e", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
    "0"}]}]}]], "Input",
 CellLabel->"In[92]:=",ExpressionUUID->"d01a7e0b-62c5-49cd-aa70-4c3d1242a23b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nosckiki", "[", "p_", "]"}], ":=", 
  RowBox[{"p", "/.", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"k", "[", "i_", "]"}], ",", 
      RowBox[{"k", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
    SuperscriptBox[
     RowBox[{"k", "[", "i", "]"}], "2"]}]}]}]], "Input",
 CellChangeTimes->{{3.913131316474275*^9, 3.9131313217983847`*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"d9cb0b52-d671-425f-95e0-db4601242b1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AdSksMinimalVar", "[", "xp_", "]"}], ":=", 
  RowBox[{
   RowBox[{"xp", "//", 
    RowBox[{"ReplaceAll", "[", "AdS5ptmy", "]"}]}], "//", 
   RowBox[{"ReplaceAll", "[", "AdS5ptmyad", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9131316734666433`*^9, 3.9131316827277446`*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"75cd3692-ac5a-4a47-904b-888612af053f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MinimalVarAdSks", "[", "xp_", "]"}], ":=", 
  RowBox[{
   RowBox[{"xp", "//", 
    RowBox[{"ReplaceAll", "[", "AdS5ptmy", "]"}]}], "//", 
   RowBox[{"ReplaceAll", "[", "AdS5ptmyad", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9131477711474338`*^9, 3.9131477722427506`*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"17925d64-04e1-46c3-b828-dbac3d911e1b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToMinimalPolarizationVariable", "[", 
   RowBox[{
   "qqw_", ",", "x4_", ",", "x1_", ",", "x2_", ",", "x3_", ",", "x5_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"qqw", "/.", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "i_", "]"}], ",", 
       RowBox[{"k", "[", "x4", "]"}]}], "]"}], ":>", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "i", "]"}], ",", 
         RowBox[{"k", "[", "x2", "]"}]}], "]"}]}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"k", "[", "x3", "]"}]}], "]"}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"k", "[", "x1", "]"}]}], "]"}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"k", "[", "x5", "]"}]}], "]"}]}]}]}], "/.", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"k", "[", "i_", "]"}], ",", 
      RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.9131319854853554`*^9, 3.9131320431204276`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"6616b93b-5be7-4329-bee0-b208a91cb8c6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["rules", "Subsection",
 CellChangeTimes->{{3.912837379633031*^9, 
  3.9128373892138453`*^9}},ExpressionUUID->"66803432-d5f4-406f-8f5c-\
6293015146c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nosckiki", "[", "p_", "]"}], ":=", 
  RowBox[{"p", "/.", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"k", "[", "i_", "]"}], ",", 
      RowBox[{"k", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
    SuperscriptBox[
     RowBox[{"k", "[", "i", "]"}], "2"]}]}]}]], "Input",
 CellChangeTimes->{{3.913131316474275*^9, 3.9131313217983847`*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"386eb2fb-f04e-40dd-bae5-cb47aaf1e2e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"noeiei", "[", "lp_", "]"}], ":=", 
  RowBox[{"lp", "//", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "i_", "]"}], ",", 
       RowBox[{"e", "[", "i_", "]"}]}], "]"}], "->", "0"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.913131922213563*^9, 3.913131927059383*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"986de2a1-d843-46f9-b28a-fb8202b3d66b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"k", "[", "1", "]"}], "->", "k1"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "1", "]"}], "->", "s1"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "1", "]"}], "->", "e1"}], ",", 
     RowBox[{
      RowBox[{"k", "[", "2", "]"}], "->", "k2"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "2", "]"}], "->", "s2"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "2", "]"}], "->", "e2"}], ",", 
     RowBox[{
      RowBox[{"k", "[", "3", "]"}], "->", "k3"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "3", "]"}], "->", "s3"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "3", "]"}], "->", "e3"}], ",", 
     RowBox[{
      RowBox[{"k", "[", "4", "]"}], "->", "k4"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "4", "]"}], "->", "s4"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "4", "]"}], "->", "e4"}], ",", 
     RowBox[{
      RowBox[{"k", "[", "5", "]"}], "->", "k5"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "5", "]"}], "->", "s5"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "5", "]"}], "->", "e5"}]}], "}"}]}], ";"}]], "Input",
 CellLabel->"In[99]:=",ExpressionUUID->"43567a5b-581c-4149-a311-f9e898030772"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rulesinv", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k1", "->", 
      RowBox[{"k", "[", "1", "]"}]}], ",", 
     RowBox[{"s1", "->", 
      RowBox[{"s", "[", "1", "]"}]}], ",", 
     RowBox[{"e1", "->", 
      RowBox[{"e", "[", "1", "]"}]}], ",", 
     RowBox[{"k2", "->", 
      RowBox[{"k", "[", "2", "]"}]}], ",", 
     RowBox[{"s2", "->", 
      RowBox[{"s", "[", "2", "]"}]}], ",", 
     RowBox[{"e2", "->", 
      RowBox[{"e", "[", "2", "]"}]}], ",", 
     RowBox[{"k3", "->", 
      RowBox[{"k", "[", "3", "]"}]}], ",", 
     RowBox[{"s3", "->", 
      RowBox[{"s", "[", "3", "]"}]}], ",", 
     RowBox[{"e3", "->", 
      RowBox[{"e", "[", "3", "]"}]}], ",", 
     RowBox[{"k4", "->", 
      RowBox[{"k", "[", "4", "]"}]}], ",", 
     RowBox[{"s4", "->", 
      RowBox[{"s", "[", "4", "]"}]}], ",", 
     RowBox[{"e4", "->", 
      RowBox[{"e", "[", "4", "]"}]}], ",", 
     RowBox[{"k5", "->", 
      RowBox[{"k", "[", "5", "]"}]}], ",", 
     RowBox[{"s5", "->", 
      RowBox[{"s", "[", "5", "]"}]}], ",", 
     RowBox[{"e5", "->", 
      RowBox[{"e", "[", "5", "]"}]}]}], "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[100]:=",ExpressionUUID->"1b0f0ffc-8579-43fd-abf1-2e3dce0212d1"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "ksij", "]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"externalLegs", "=", 
    RowBox[{"Range", "[", "5", "]"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{"Assuming", " ", "5", " ", "external", " ", "legs"}], "*)"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"i", "<", "j"}], ",", 
       RowBox[{"\"\<ks\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", 
        RowBox[{"ToString", "[", "j", "]"}]}], ",", "Nothing"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "externalLegs"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "externalLegs"}], "}"}]}], "]"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ksijTerms", "=", 
   RowBox[{
    RowBox[{"%", "//", 
     RowBox[{
      RowBox[{"DeleteCases", "[", 
       RowBox[{"#", ",", "Null"}], "]"}], "&"}]}], "//", "ToExpression"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kijrl", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{"#", ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "//", "ToString"}], "//", 
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}], "//", 
         "ToExpression"}], "//", 
        RowBox[{
         RowBox[{"ks", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "&"}]}]}], "]"}], "&"}], 
    "/@", "ksijTerms"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.9128374241029835`*^9},
 CellLabel->
  "In[101]:=",ExpressionUUID->"874f7637-7705-4e42-9237-bda0a0ee4e07"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "ksij", "]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"externalLegs", "=", 
    RowBox[{"Range", "[", "5", "]"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{"Assuming", " ", "5", " ", "external", " ", "legs"}], "*)"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"i", "<", "j"}], ",", 
       RowBox[{"\"\<ks\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", 
        RowBox[{"ToString", "[", "j", "]"}]}], ",", "Nothing"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "externalLegs"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "externalLegs"}], "}"}]}], "]"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ksijTerms", "=", 
   RowBox[{
    RowBox[{"%", "//", 
     RowBox[{
      RowBox[{"DeleteCases", "[", 
       RowBox[{"#", ",", "Null"}], "]"}], "&"}]}], "//", "ToExpression"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kijrlinv", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "//", "ToString"}], "//", 
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}], "//", 
         "ToExpression"}], "//", 
        RowBox[{
         RowBox[{"ks", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "&"}]}], ",", "#"}], 
      "]"}], "&"}], "/@", "ksijTerms"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.912788407476832*^9, 3.9127884335317*^9}, {
  3.912837463754615*^9, 3.9128374647550697`*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"03d11e48-3dd1-44cd-b351-38abfd668194"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanK2sOnshellgluon", "[", 
   RowBox[{"p_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "[", 
     RowBox[{"FreeQ", "[", 
      RowBox[{"p", ",", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"k", "[", "i", "]"}], ",", "2"}], "]"}]}], "]"}], "]"}], ",", 
    RowBox[{"ReplaceAll", "[", 
     RowBox[{
      RowBox[{"p", "/.", 
       RowBox[{
        RowBox[{"s", "[", "i", "]"}], "->", 
        RowBox[{
         RowBox[{"s", "[", "i", "]"}], "+", "1"}]}]}], ",", 
      RowBox[{"Onshellcy", "[", 
       RowBox[{
        RowBox[{"d", "-", "1"}], ",", 
        RowBox[{"k", "[", "i", "]"}], ",", "z1"}], "]"}]}], "]"}], ",", "p"}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.9126989355409093`*^9, 3.9126989356511803`*^9}, {
  3.9126990125069475`*^9, 3.912699013226174*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"f2e7ca50-6dcd-4571-85b1-efa1e64e1368"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanK2sOnshelllistgluon", "[", "p_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"p", "//", 
       RowBox[{
        RowBox[{"scanK2sOnshellgluon", "[", 
         RowBox[{"#", ",", "2"}], "]"}], "&"}]}], "//", 
      RowBox[{
       RowBox[{"scanK2sOnshellgluon", "[", 
        RowBox[{"#", ",", "3"}], "]"}], "&"}]}], "//", 
     RowBox[{
      RowBox[{"scanK2sOnshellgluon", "[", 
       RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"scanK2sOnshellgluon", "[", 
      RowBox[{"#", ",", "4"}], "]"}], "&"}]}], "//", 
   RowBox[{
    RowBox[{"scanK2sOnshellgluon", "[", 
     RowBox[{"#", ",", "5"}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.912699018173874*^9, 3.9126990285968485`*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"10cd15dc-68f5-41a4-8cde-9453b51d663a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanK2sOnshelllistmapgluon", "[", "p_", "]"}], ":=", 
  RowBox[{"p", "//", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"scanK2sOnshelllistgluon", ",", "#"}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.912699029755474*^9, 3.912699031562392*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"541bc0a5-1642-438d-8ba5-f8d64283d490"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"k", "[", "i", "]"}], ",", 
           RowBox[{"k", "[", "j", "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"k", "[", "i_", "]"}], ",", 
         RowBox[{"k", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
       SuperscriptBox[
        RowBox[{"k", "[", "i", "]"}], "2"]}], ",", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"k", "[", "i_", "]"}], ",", 
         RowBox[{"k", "[", "j_", "]"}]}], "]"}], ":>", 
       RowBox[{
        RowBox[{"1", "/", "2"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ksq", "[", 
           RowBox[{"i", ",", "j"}], "]"}], "-", 
          SuperscriptBox[
           RowBox[{"k", "[", "i", "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"k", "[", "j", "]"}], "2"]}], ")"}]}]}]}], "}"}]}], "//", 
   "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AdS4ptmy", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"%", "\[Equal]", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ksq", "[", 
          RowBox[{"1", ",", "3"}], "]"}], ",", 
         RowBox[{"ksq", "[", 
          RowBox[{"1", ",", "4"}], "]"}], ",", 
         RowBox[{"ksq", "[", 
          RowBox[{"2", ",", "4"}], "]"}], ",", 
         RowBox[{"ksq", "[", 
          RowBox[{"3", ",", "4"}], "]"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"ksq", "[", 
       RowBox[{"i_", ",", "j_"}], "]"}], "\[RuleDelayed]", 
      SuperscriptBox[
       RowBox[{"ks", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "2"]}]}], "//", "Flatten"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9120714960782585`*^9, 3.9120714964194603`*^9}, {
   3.912697810853263*^9, 3.912697895041503*^9}, 3.91309763027353*^9},
 CellLabel->
  "In[114]:=",ExpressionUUID->"2dac28cd-5471-42b3-be06-b87d479f6f80"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToNoIndex", "[", "po_", "]"}], ":=", 
  RowBox[{
   RowBox[{"po", "//", 
    RowBox[{"ReplaceAll", "[", "rules", "]"}]}], "//", 
   RowBox[{"ReplaceAll", "[", "kijrlinv", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9131006172805443`*^9, 3.913100633957263*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"8313ad5d-13c3-4109-a3f6-614ada7f5e99"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scToks", "[", "pl_", "]"}], ":=", 
  RowBox[{"pl", "/.", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"k", "[", "i_", "]"}], ",", 
      RowBox[{"k", "[", "j_", "]"}]}], "]"}], "->", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"ks", "[", 
         RowBox[{"i", ",", "j"}], "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"k", "[", "i", "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"k", "[", "j", "]"}], "2"]}], ")"}]}]}]}]}]], "Input",
 CellChangeTimes->{
  3.9128579271878033`*^9, {3.9131040204371967`*^9, 3.913104028066124*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"67a9fc6d-c6c6-45d6-a379-047e405dad89"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "@", "S"}], "=", 
   RowBox[{"{", "Orderless", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.913048520554029*^9, 3.9130485509092216`*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"0ee54db0-1d01-498f-99a6-8afda6191eaf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "i", "]"}], ",", 
          RowBox[{"k", "[", "j", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}], "/.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"a_", ",", "a_"}], "]"}], "\[RuleDelayed]", "0"}]}], ")"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"momconservationS", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"%", "==", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "3", "]"}], ",", 
             RowBox[{"k", "[", "5", "]"}]}], "]"}], ",", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "1", "]"}], ",", 
             RowBox[{"k", "[", "4", "]"}]}], "]"}], ",", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "2", "]"}], ",", 
             RowBox[{"k", "[", "5", "]"}]}], "]"}], ",", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "2", "]"}], ",", 
             RowBox[{"k", "[", "4", "]"}]}], "]"}], ",", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "1", "]"}], ",", 
             RowBox[{"k", "[", "3", "]"}]}], "]"}]}], "}"}]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"k", "[", "1", "]"}], "->", "k1"}], ",", 
         RowBox[{
          RowBox[{"k", "[", "2", "]"}], "->", "k2"}], ",", 
         RowBox[{
          RowBox[{"k", "[", "3", "]"}], "->", "k3"}], ",", 
         RowBox[{
          RowBox[{"k", "[", "4", "]"}], "->", "k4"}], ",", 
         RowBox[{
          RowBox[{"k", "[", "5", "]"}], "->", "k5"}]}], "}"}]}], "/.", 
      "rulesinv"}], "//", "Flatten"}], "//", 
    RowBox[{"ReplaceAll", "[", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"k", "[", "x_", "]"}], ",", 
        RowBox[{"k", "[", "y_", "]"}]}], "]"}], ":>", 
      RowBox[{"S", "[", 
       RowBox[{
        RowBox[{"k", "[", "x", "]"}], ",", 
        RowBox[{"k", "[", "y", "]"}]}], "]"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.9130483911386347`*^9, {3.913048440075839*^9, 3.913048516838315*^9}, {
   3.9130485681466827`*^9, 3.913048589951713*^9}, 3.913048620162613*^9, {
   3.9130487712354355`*^9, 3.9130487732031345`*^9}, 3.9131049093865557`*^9},
 CellLabel->
  "In[119]:=",ExpressionUUID->"be67686e-137a-42f0-8647-a8453eb73158"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"myFunction", "[", "resope_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ress", ",", "resf", ",", "ressf"}], "}"}], ",", 
     RowBox[{
      RowBox[{"ress", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"resope", "/.", " ", "AdS5ptmy"}], "/.", " ", 
                RowBox[{
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i_", "]"}], ",", 
                   RowBox[{"k", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.",
                " ", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"k", "[", "i_", "]"}], ",", 
                  RowBox[{"k", "[", "i_", "]"}]}], "]"}], ":>", 
                RowBox[{
                 RowBox[{"k", "[", "i", "]"}], "^", "2"}]}]}], "/.", " ", 
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"k", "[", "i_", "]"}], ",", 
                 RowBox[{"k", "[", "j_", "]"}]}], "]"}], "->", 
               RowBox[{
                RowBox[{"1", "/", "2"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ks", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], "^", "2"}], "-", 
                  RowBox[{
                   RowBox[{"k", "[", "i", "]"}], "^", "2"}], "-", 
                  RowBox[{
                   RowBox[{"k", "[", "j", "]"}], "^", "2"}]}], ")"}]}]}]}], "/.",
              " ", "kijrl"}], "/.", " ", "AdS5ptmy"}], "/.", " ", 
           RowBox[{
            RowBox[{"s", "[", "i_", "]"}], ":>", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"z1", " ", 
               RowBox[{"k", "[", "i", "]"}]}], ")"}], "/", "2"}]}]}], "/.", 
          " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"k", "[", "i_", "]"}], ",", 
               RowBox[{"k", "[", "j_", "]"}]}], "]"}], ":>", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"kk", "[", "i", "]"}], ",", 
               RowBox[{"kk", "[", "j", "]"}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i_", "]"}], ",", 
               RowBox[{"k", "[", "j_", "]"}]}], "]"}], ":>", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i", "]"}], ",", 
               RowBox[{"kk", "[", "j", "]"}]}], "]"}]}]}], "}"}]}], "/.", " ", 
         RowBox[{
          RowBox[{"k", "[", "3", "]"}], "->", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"k", "[", "1", "]"}]}], "-", 
           RowBox[{"k", "[", "2", "]"}], "-", 
           RowBox[{"k", "[", "5", "]"}], "-", 
           RowBox[{"k", "[", "4", "]"}]}]}]}], "/.", " ", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"D", ",", 
           RowBox[{"ks", "[", 
            RowBox[{"i_", ",", "j_"}], "]"}]}], "]"}], "->", 
         RowBox[{
          RowBox[{"z1", "^", "2"}], " ", 
          RowBox[{"S", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"resf", "=", 
       RowBox[{"ress", "//", 
        RowBox[{
         RowBox[{"Series", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"z1", ",", "\[Infinity]", ",", "1"}], "}"}]}], "]"}], 
         "&"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ressf", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"resf", "/.", " ", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"e", "[", "i_", "]"}], ",", 
                  RowBox[{"e", "[", "i_", "]"}]}], "]"}], "->", "0"}]}], "/.",
               " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"e", "[", "i_", "]"}], ",", 
                  RowBox[{"kk", "[", "1", "]"}]}], "]"}], ":>", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"sc", "[", 
                   RowBox[{
                    RowBox[{"e", "[", "i", "]"}], ",", 
                    RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i", "]"}], ",", 
                   RowBox[{"kk", "[", "3", "]"}]}], "]"}], "-", 
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i", "]"}], ",", 
                   RowBox[{"kk", "[", "4", "]"}]}], "]"}], "-", 
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i", "]"}], ",", 
                   RowBox[{"kk", "[", "5", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
             " ", 
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"kk", "[", "i_", "]"}], ",", 
                RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", 
            " ", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i_", "]"}], ",", 
               RowBox[{"kk", "[", "3", "]"}]}], "]"}], ":>", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"e", "[", "i", "]"}], ",", 
                 RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"kk", "[", "4", "]"}]}], "]"}], "-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"kk", "[", "1", "]"}]}], "]"}], "-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"kk", "[", "5", "]"}]}], "]"}]}]}]}], "/.", " ", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"kk", "[", "i_", "]"}], ",", 
              RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "//", 
          "Normal"}], "//", 
         RowBox[{"ReplaceAll", "[", 
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{"x1_", ",", "x2_"}], "]"}], "->", 
           RowBox[{
            RowBox[{
             RowBox[{"ks", "[", 
              RowBox[{"x1", ",", "x2"}], "]"}], "^", "2"}], "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"k", "[", "x1", "]"}], "^", "2"}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"k", "[", "x1", "]"}], " ", 
               RowBox[{"k", "[", "x2", "]"}]}], "+", 
              RowBox[{
               RowBox[{"k", "[", "x2", "]"}], "^", "2"}]}], ")"}]}]}], 
          "]"}]}], "//", 
        RowBox[{
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"k", "[", "3", "]"}], "->", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"k", "[", "1", "]"}]}], "-", 
             RowBox[{"k", "[", "2", "]"}], "-", 
             RowBox[{"k", "[", "5", "]"}], "-", 
             RowBox[{"k", "[", "4", "]"}]}]}]}], "]"}], "&"}]}]}], ";", 
      RowBox[{"Return", "[", "ressf", "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9130474291728506`*^9, 3.913047449466036*^9}, {
  3.9130479131508384`*^9, 3.9130479368870506`*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"08673aeb-2d6f-4f6e-8581-0985029faa11"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"YMAmpAdSToFlat", "[", "resope_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ress", ",", "resf", ",", "ressf"}], "}"}], ",", 
     RowBox[{
      RowBox[{"ress", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"resope", "/.", " ", "AdS5ptmy"}], "/.", " ", 
                RowBox[{
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i_", "]"}], ",", 
                   RowBox[{"k", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.",
                " ", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"k", "[", "i_", "]"}], ",", 
                  RowBox[{"k", "[", "i_", "]"}]}], "]"}], ":>", 
                RowBox[{
                 RowBox[{"k", "[", "i", "]"}], "^", "2"}]}]}], "/.", " ", 
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"k", "[", "i_", "]"}], ",", 
                 RowBox[{"k", "[", "j_", "]"}]}], "]"}], "->", 
               RowBox[{
                RowBox[{"1", "/", "2"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ks", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], "^", "2"}], "-", 
                  RowBox[{
                   RowBox[{"k", "[", "i", "]"}], "^", "2"}], "-", 
                  RowBox[{
                   RowBox[{"k", "[", "j", "]"}], "^", "2"}]}], ")"}]}]}]}], "/.",
              " ", "kijrl"}], "/.", " ", "AdS5ptmy"}], "/.", " ", 
           RowBox[{
            RowBox[{"s", "[", "i_", "]"}], ":>", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"z1", " ", 
               RowBox[{"k", "[", "i", "]"}]}], ")"}], "/", "2"}]}]}], "/.", 
          " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"k", "[", "i_", "]"}], ",", 
               RowBox[{"k", "[", "j_", "]"}]}], "]"}], ":>", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"kk", "[", "i", "]"}], ",", 
               RowBox[{"kk", "[", "j", "]"}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i_", "]"}], ",", 
               RowBox[{"k", "[", "j_", "]"}]}], "]"}], ":>", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i", "]"}], ",", 
               RowBox[{"kk", "[", "j", "]"}]}], "]"}]}]}], "}"}]}], "/.", " ", 
         RowBox[{
          RowBox[{"k", "[", "3", "]"}], "->", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"k", "[", "1", "]"}]}], "-", 
           RowBox[{"k", "[", "2", "]"}], "-", 
           RowBox[{"k", "[", "5", "]"}], "-", 
           RowBox[{"k", "[", "4", "]"}]}]}]}], "/.", " ", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"D", ",", 
           RowBox[{"ks", "[", 
            RowBox[{"i_", ",", "j_"}], "]"}]}], "]"}], "->", 
         RowBox[{
          RowBox[{"z1", "^", "2"}], " ", 
          RowBox[{"S", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"resf", "=", 
       RowBox[{"ress", "//", 
        RowBox[{
         RowBox[{"Series", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"z1", ",", "\[Infinity]", ",", "1"}], "}"}]}], "]"}], 
         "&"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ressf", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"resf", "/.", " ", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"e", "[", "i_", "]"}], ",", 
                  RowBox[{"e", "[", "i_", "]"}]}], "]"}], "->", "0"}]}], "/.",
               " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"e", "[", "i_", "]"}], ",", 
                  RowBox[{"kk", "[", "1", "]"}]}], "]"}], ":>", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"sc", "[", 
                   RowBox[{
                    RowBox[{"e", "[", "i", "]"}], ",", 
                    RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i", "]"}], ",", 
                   RowBox[{"kk", "[", "3", "]"}]}], "]"}], "-", 
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i", "]"}], ",", 
                   RowBox[{"kk", "[", "4", "]"}]}], "]"}], "-", 
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i", "]"}], ",", 
                   RowBox[{"kk", "[", "5", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
             " ", 
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"kk", "[", "i_", "]"}], ",", 
                RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", 
            " ", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i_", "]"}], ",", 
               RowBox[{"kk", "[", "3", "]"}]}], "]"}], ":>", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"e", "[", "i", "]"}], ",", 
                 RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"kk", "[", "4", "]"}]}], "]"}], "-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"kk", "[", "1", "]"}]}], "]"}], "-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"kk", "[", "5", "]"}]}], "]"}]}]}]}], "/.", " ", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"kk", "[", "i_", "]"}], ",", 
              RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "//", 
          "Normal"}], "//", 
         RowBox[{"ReplaceAll", "[", 
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{"x1_", ",", "x2_"}], "]"}], "->", 
           RowBox[{
            RowBox[{
             RowBox[{"ks", "[", 
              RowBox[{"x1", ",", "x2"}], "]"}], "^", "2"}], "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"k", "[", "x1", "]"}], "^", "2"}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"k", "[", "x1", "]"}], " ", 
               RowBox[{"k", "[", "x2", "]"}]}], "+", 
              RowBox[{
               RowBox[{"k", "[", "x2", "]"}], "^", "2"}]}], ")"}]}]}], 
          "]"}]}], "//", 
        RowBox[{
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"k", "[", "3", "]"}], "->", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"k", "[", "1", "]"}]}], "-", 
             RowBox[{"k", "[", "2", "]"}], "-", 
             RowBox[{"k", "[", "5", "]"}], "-", 
             RowBox[{"k", "[", "4", "]"}]}]}]}], "]"}], "&"}]}]}], ";", 
      RowBox[{"Return", "[", "ressf", "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.913105519083804*^9, 3.9131055313411026`*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"80603a22-2679-4a83-8c9c-b37df8aa8ea8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "@", "S"}], "=", 
   RowBox[{"{", "Orderless", "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[123]:=",ExpressionUUID->"aaab3ead-e680-4224-970b-a32d1ca4fe82"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlatSpaceMinimalEandK", "[", 
   RowBox[{"px_", ",", "kk_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"px", "/.", "\[VeryThinSpace]", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "i_", "]"}], ",", 
          RowBox[{"e", "[", "i_", "]"}]}], "]"}], "\[Rule]", "0"}]}], "/.", 
      "\[VeryThinSpace]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "i_", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], ",", 
            RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i", "]"}], ",", 
           RowBox[{"kk", "[", "3", "]"}]}], "]"}], "-", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i", "]"}], ",", 
           RowBox[{"kk", "[", "4", "]"}]}], "]"}], "-", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i", "]"}], ",", 
           RowBox[{"kk", "[", "5", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
     "\[VeryThinSpace]", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"kk", "[", "i_", "]"}], ",", 
        RowBox[{"e", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", "0"}]}], "/.",
     "\[VeryThinSpace]", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "i_", "]"}], ",", 
       RowBox[{"kk", "[", "3", "]"}]}], "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "i", "]"}], ",", 
         RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"kk", "[", "4", "]"}]}], "]"}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"kk", "[", "5", "]"}]}], "]"}]}]}]}], "/.", 
   "\[VeryThinSpace]", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"kk", "[", "i_", "]"}], ",", 
      RowBox[{"e", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
    "0"}]}]}]], "Input",
 CellLabel->
  "In[124]:=",ExpressionUUID->"ebc1d902-86f9-4757-9ea3-cab74ad659d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlatSpaceMinimalEandK", "[", "px_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"px", "/.", " ", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "i_", "]"}], ",", 
          RowBox[{"e", "[", "i_", "]"}]}], "]"}], "->", "0"}]}], "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "i_", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], ",", 
            RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i", "]"}], ",", 
           RowBox[{"kk", "[", "3", "]"}]}], "]"}], "-", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i", "]"}], ",", 
           RowBox[{"kk", "[", "4", "]"}]}], "]"}], "-", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i", "]"}], ",", 
           RowBox[{"kk", "[", "5", "]"}]}], "]"}]}]}], "}"}]}], "/.", " ", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"kk", "[", "i_", "]"}], ",", 
        RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", " ", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "i_", "]"}], ",", 
       RowBox[{"kk", "[", "3", "]"}]}], "]"}], ":>", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "i", "]"}], ",", 
         RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"kk", "[", "4", "]"}]}], "]"}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"kk", "[", "5", "]"}]}], "]"}]}]}]}], "/.", " ", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"kk", "[", "i_", "]"}], ",", 
      RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.9130482583803577`*^9, 3.9130482679180984`*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"49f5f7e0-311a-42e5-8cc6-1bdb45582c83"],

Cell[BoxData[
 RowBox[{
  RowBox[{"to3momentum", "[", "pw_", "]"}], ":=", 
  RowBox[{"pw", "//", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"x1_", ",", "x2_"}], "]"}], "->", 
     RowBox[{
      RowBox[{
       RowBox[{"ks", "[", 
        RowBox[{"x1", ",", "x2"}], "]"}], "^", "2"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "[", "x1", "]"}], "^", "2"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"k", "[", "x1", "]"}], " ", 
         RowBox[{"k", "[", "x2", "]"}]}], "+", 
        RowBox[{
         RowBox[{"k", "[", "x2", "]"}], "^", "2"}]}], ")"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9130480811291227`*^9, 3.913048103676*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"3533d67b-b6fb-48ba-8cd5-4860839d2458"],

Cell[BoxData[
 RowBox[{
  RowBox[{"to4momentum", "[", "pw_", "]"}], ":=", 
  RowBox[{"pw", "//", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ks", "[", 
       RowBox[{"x1_", ",", "x2_"}], "]"}], "^", "2"}], "->", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"x1", ",", "x2"}], "]"}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "[", "x1", "]"}], "^", "2"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"k", "[", "x1", "]"}], " ", 
         RowBox[{"k", "[", "x2", "]"}]}], "+", 
        RowBox[{
         RowBox[{"k", "[", "x2", "]"}], "^", "2"}]}], ")"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9130481026735396`*^9, 3.913048120199679*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"91e01b21-6996-494b-9525-6ada2dcfe28c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"flat5momcon", "[", "xP_", "]"}], ":=", 
  RowBox[{"xP", "//", 
   RowBox[{
    RowBox[{"ReplaceAll", "[", 
     RowBox[{"#", ",", 
      RowBox[{
       RowBox[{"k", "[", "3", "]"}], "->", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"k", "[", "1", "]"}]}], "-", 
        RowBox[{"k", "[", "2", "]"}], "-", 
        RowBox[{"k", "[", "5", "]"}], "-", 
        RowBox[{"k", "[", "4", "]"}]}]}]}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.9130481688251333`*^9, 3.9130481773425493`*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"83bad50f-82e5-42d8-bf70-0b625cc06b98"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "i", "]"}], ",", 
          RowBox[{"k", "[", "j", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}], "/.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"a_", ",", "a_"}], "]"}], "\[RuleDelayed]", "0"}]}], ")"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"momconservation", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"%", "==", "0"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"k", "[", "1", "]"}], "->", "k1"}], ",", 
      RowBox[{
       RowBox[{"k", "[", "2", "]"}], "->", "k2"}], ",", 
      RowBox[{
       RowBox[{"k", "[", "3", "]"}], "->", "k3"}], ",", 
      RowBox[{
       RowBox[{"k", "[", "4", "]"}], "->", "k4"}], ",", 
      RowBox[{
       RowBox[{"k", "[", "5", "]"}], "->", "k5"}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.897649075750183*^9, 3.897649100785101*^9}, {
  3.8976491629060144`*^9, 3.8976491868267603`*^9}, {3.899529089767548*^9, 
  3.8995290970877447`*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"2a1ed18c-0fe7-443a-8de9-7e224ebe4f6e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VYMijk", "[", 
   RowBox[{"k1_", ",", "k2_", ",", "k3_", ",", "i_", ",", "j_", ",", "k_"}], 
   "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "i", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"\[Mu]", "[", "k", "]"}]}], "]"}], "-", 
       RowBox[{"sc", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"\[Mu]", "[", "k", "]"}]}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "j", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "k", "]"}]}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}], "-", 
       RowBox[{"sc", "[", 
        RowBox[{"k3", ",", 
         RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "k", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"k3", ",", 
         RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}], "-", 
       RowBox[{"sc", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}]}], ")"}]}]}], 
   ")"}]}]], "Input",
 CellChangeTimes->{3.8951271215313416`*^9},
 CellLabel->
  "In[131]:=",ExpressionUUID->"f99535f8-ab98-48e8-afa4-b2057abed69b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"VYMijk", "[", 
       RowBox[{"k1", ",", "k2", ",", 
        RowBox[{"-", "k12"}], ",", "e1", ",", "e2", ",", "k"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"-", "a_"}], ",", 
         RowBox[{"\[Mu]", "[", "b_", "]"}]}], "]"}], ":>", 
       RowBox[{"-", 
        RowBox[{"sc", "[", 
         RowBox[{"a", ",", 
          RowBox[{"\[Mu]", "[", "b", "]"}]}], "]"}]}]}]}], "/.", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{"k12", ",", 
        RowBox[{"\[Mu]", "[", "a_", "]"}]}], "]"}], ":>", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}], "+", 
       RowBox[{"sc", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}]}]}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"VYMijk", "[", 
       RowBox[{"k12", ",", "k3", ",", "k45", ",", "m", ",", "e3", ",", "n"}], 
       "]"}], "/.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"-", "a_"}], ",", 
         RowBox[{"\[Mu]", "[", "b_", "]"}]}], "]"}], ":>", 
       RowBox[{"-", 
        RowBox[{"sc", "[", 
         RowBox[{"a", ",", 
          RowBox[{"\[Mu]", "[", "b", "]"}]}], "]"}]}]}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k12", ",", 
          RowBox[{"\[Mu]", "[", "a_", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"k1", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}], "+", 
         RowBox[{"sc", "[", 
          RowBox[{"k2", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k45", ",", 
          RowBox[{"\[Mu]", "[", "a_", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"k4", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}], "+", 
         RowBox[{"sc", "[", 
          RowBox[{"k5", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}]}]}]}], "}"}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"VYMijk", "[", 
       RowBox[{
        RowBox[{"-", "k45"}], ",", "k4", ",", "k5", ",", "p", ",", "e4", ",", 
        "e5"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"-", "a_"}], ",", 
         RowBox[{"\[Mu]", "[", "b_", "]"}]}], "]"}], ":>", 
       RowBox[{"-", 
        RowBox[{"sc", "[", 
         RowBox[{"a", ",", 
          RowBox[{"\[Mu]", "[", "b", "]"}]}], "]"}]}]}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k12", ",", 
          RowBox[{"\[Mu]", "[", "a_", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"k1", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}], "+", 
         RowBox[{"sc", "[", 
          RowBox[{"k2", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k45", ",", 
          RowBox[{"\[Mu]", "[", "a_", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"k4", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}], "+", 
         RowBox[{"sc", "[", 
          RowBox[{"k5", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}]}]}]}], "}"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"contract", "[", 
    RowBox[{
     RowBox[{"%", " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "k", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "m", "]"}]}], "]"}], 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "n", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "p", "]"}]}], "]"}]}], ",", "d"}], "]"}], "//", 
   "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"YM5pt1", "=", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k5", ",", 
          RowBox[{"\[Mu]", "[", "e5", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k1", ",", 
          RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k2", ",", 
          RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k3", ",", 
          RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k4", ",", 
          RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], "->", "0"}]}], "}"}]}], 
    "//", "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8942681950030203`*^9, 3.8942682035242105`*^9}, {
   3.8942682621632986`*^9, 3.894268263363967*^9}, {3.894268321452218*^9, 
   3.8942683290185423`*^9}, {3.894268367108331*^9, 3.8942683815841303`*^9}, {
   3.894268598034874*^9, 3.894268601467407*^9}, {3.894268643459319*^9, 
   3.8942686611708384`*^9}, {3.894268697603653*^9, 3.894268698799119*^9}, {
   3.894268791788171*^9, 3.894268836483612*^9}, {3.89426943032482*^9, 
   3.894269438195872*^9}, {3.894352715929925*^9, 3.894352723994129*^9}, {
   3.894352769994816*^9, 3.8943527763634305`*^9}, {3.8951274830585814`*^9, 
   3.8951274848980317`*^9}, {3.8965227464758186`*^9, 3.896522771864021*^9}, 
   3.897643950608121*^9, {3.8976447200058317`*^9, 3.897644720766872*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"a9f0d278-1cba-47fb-99cf-1256d6089916"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"VYMijk", "[", 
       RowBox[{"k1", ",", "k2", ",", 
        RowBox[{"-", "k12"}], ",", "e1", ",", "e2", ",", "k"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"-", "a_"}], ",", 
         RowBox[{"\[Mu]", "[", "b_", "]"}]}], "]"}], ":>", 
       RowBox[{"-", 
        RowBox[{"sc", "[", 
         RowBox[{"a", ",", 
          RowBox[{"\[Mu]", "[", "b", "]"}]}], "]"}]}]}]}], "/.", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{"k12", ",", 
        RowBox[{"\[Mu]", "[", "a_", "]"}]}], "]"}], ":>", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}], "+", 
       RowBox[{"sc", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}]}]}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "k", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "e5", "]"}]}], "]"}], 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "e3", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "k", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "e3", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "e5", "]"}]}], "]"}]}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{"2", 
     RowBox[{"sc", "[", 
      RowBox[{"k4", ",", "k5"}], "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"contract", "[", 
   RowBox[{"%", ",", "d"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"YM5pt2", "=", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k5", ",", 
          RowBox[{"\[Mu]", "[", "e5", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k1", ",", 
          RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k2", ",", 
          RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k3", ",", 
          RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k4", ",", 
          RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], "->", "0"}]}], "}"}]}], 
    "//", "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8965228874533367`*^9, 3.8965230280003247`*^9}, 
   3.8965252463213215`*^9, 3.897643953555105*^9},
 CellLabel->
  "In[135]:=",ExpressionUUID->"5b0c18e8-56a3-4c74-a417-8b6ee24451fc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"VYMijk", "[", 
       RowBox[{
        RowBox[{"-", "k45"}], ",", "k4", ",", "k5", ",", "k", ",", "e4", ",", 
        "e5"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"-", "a_"}], ",", 
         RowBox[{"\[Mu]", "[", "b_", "]"}]}], "]"}], ":>", 
       RowBox[{"-", 
        RowBox[{"sc", "[", 
         RowBox[{"a", ",", 
          RowBox[{"\[Mu]", "[", "b", "]"}]}], "]"}]}]}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k12", ",", 
          RowBox[{"\[Mu]", "[", "a_", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"k1", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}], "+", 
         RowBox[{"sc", "[", 
          RowBox[{"k2", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k45", ",", 
          RowBox[{"\[Mu]", "[", "a_", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"k4", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}], "+", 
         RowBox[{"sc", "[", 
          RowBox[{"k5", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}]}]}]}], "}"}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "k", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "e2", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "k", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "e3", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}]}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{"2", 
     RowBox[{"sc", "[", 
      RowBox[{"k1", ",", "k2"}], "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"contract", "[", 
   RowBox[{"%", ",", "d"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"YM5pt3", "=", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k5", ",", 
          RowBox[{"\[Mu]", "[", "e5", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k1", ",", 
          RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k2", ",", 
          RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k3", ",", 
          RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k4", ",", 
          RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], "->", "0"}]}], "}"}]}], 
    "//", "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.896523076918626*^9, 3.8965230836875143`*^9}, {
   3.8965231450233345`*^9, 3.896523168194707*^9}, 3.896525248866237*^9, {
   3.8973851083314962`*^9, 3.897385110086599*^9}, 3.89764395611317*^9},
 CellLabel->
  "In[138]:=",ExpressionUUID->"a890d8c4-47f3-437e-a2f9-73b806c7bc14"],

Cell[BoxData[
 RowBox[{
  RowBox[{"n1", "=", 
   RowBox[{
    RowBox[{"YM5pt1", "-", " ", "YM5pt2", "-", " ", "YM5pt3"}], "//", 
    "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.896523181723384*^9, 3.896523189521145*^9}, {
   3.8965259885096245`*^9, 3.896525989547948*^9}, {3.8973848084104424`*^9, 
   3.897384810326605*^9}, {3.897384975059145*^9, 3.8973849755225196`*^9}, 
   3.8973850137515106`*^9, 3.8976450207668424`*^9, {3.897645572656638*^9, 
   3.8976455739107265`*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"aa677759-1f6a-4267-8218-3a5950a0d390"],

Cell[BoxData[
 RowBox[{
  RowBox[{"n1flat", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["n1", "8"], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"k1", "\[Rule]", 
           RowBox[{"k", "[", "1", "]"}]}], ",", 
          RowBox[{"k2", "\[Rule]", 
           RowBox[{"k", "[", "2", "]"}]}], ",", 
          RowBox[{"k3", "\[Rule]", 
           RowBox[{"k", "[", "3", "]"}]}], ",", 
          RowBox[{"k4", "\[Rule]", 
           RowBox[{"k", "[", "4", "]"}]}], ",", 
          RowBox[{"k5", "\[Rule]", 
           RowBox[{"k", "[", "5", "]"}]}]}], "}"}]}], "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"k", "[", "i_", "]"}], ",", 
            RowBox[{"\[Mu]", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"kk", "[", "i", "]"}], ",", "j"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"\[Mu]", "[", "i_", "]"}], ",", 
            RowBox[{"\[Mu]", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
          RowBox[{"sc", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}]}], "}"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"e1", "\[Rule]", 
         RowBox[{"e", "[", "1", "]"}]}], ",", 
        RowBox[{"e2", "\[Rule]", 
         RowBox[{"e", "[", "2", "]"}]}], ",", 
        RowBox[{"e3", "\[Rule]", 
         RowBox[{"e", "[", "3", "]"}]}], ",", 
        RowBox[{"e4", "\[Rule]", 
         RowBox[{"e", "[", "4", "]"}]}], ",", 
        RowBox[{"e5", "\[Rule]", 
         RowBox[{"e", "[", "5", "]"}]}]}], "}"}]}], ")"}], "//", 
    "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9119255897296553`*^9, 3.911925598495942*^9}, {
   3.9119256640212317`*^9, 3.9119257144814157`*^9}, {3.911925907642861*^9, 
   3.911925908553707*^9}, 3.911927803375145*^9, 3.9119279046297874`*^9},
 CellLabel->
  "In[142]:=",ExpressionUUID->"643e42dd-adaf-42e0-91c2-b6dd881b609d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToMinimalPolarizationVariable4", "[", 
   RowBox[{"qqw_", ",", "x4_", ",", "x1_", ",", "x2_", ",", "x3_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"qqw", "/.", "\[VeryThinSpace]", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "i_", "]"}], ",", 
       RowBox[{"k", "[", "x4", "]"}]}], "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "i", "]"}], ",", 
         RowBox[{"k", "[", "x2", "]"}]}], "]"}]}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"k", "[", "x3", "]"}]}], "]"}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"k", "[", "x1", "]"}]}], "]"}]}]}]}], "/.", 
   "\[VeryThinSpace]", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"k", "[", "i_", "]"}], ",", 
      RowBox[{"e", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
    "0"}]}]}]], "Input",
 CellChangeTimes->{{3.9142616868331394`*^9, 3.9142617001978292`*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"7537b0b4-63f0-4e09-bb5d-624ec09bff43"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["4 graviton amplitudes: answer and checks", "Chapter",
 CellChangeTimes->{{3.913124263729748*^9, 3.9131242668832483`*^9}, {
  3.9370457349612103`*^9, 
  3.9370457403631425`*^9}},ExpressionUUID->"5fc2cf29-d61d-48ea-886c-\
5fb28c50726a"],

Cell[CellGroupData[{

Cell["All bootstrap result initialise", "Section",
 CellChangeTimes->{{3.9370457144359922`*^9, 3.937045715686159*^9}, {
  3.9370464127012014`*^9, 
  3.9370464215760007`*^9}},ExpressionUUID->"9b778c78-bddc-4baf-9686-\
cfbd496b81d0"],

Cell[CellGroupData[{

Cell["4 point GR All contribution1", "Subsection",
 CellChangeTimes->{{3.9115425501146708`*^9, 3.9115425511555605`*^9}, {
   3.9115643908563595`*^9, 3.911564393803234*^9}, {3.912622416701469*^9, 
   3.91262242242074*^9}, 
   3.913026995859007*^9},ExpressionUUID->"c323172c-751f-4211-b313-\
fa246b59de14"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pi22GR1234", "[", 
   RowBox[{
   "z1_", ",", "ks_", ",", "kt_", ",", "k1_", ",", "k2_", ",", "k3_", ",", 
    "k4_", ",", "e1_", ",", "e2_", ",", "e3_", ",", "e4_", ",", "s1_", ",", 
    "s2_", ",", "s3_", ",", "s4_"}], "]"}], ":=", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["k1", "2"], "-", 
        SuperscriptBox["k2", "2"]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["k3", "2"], "-", 
        SuperscriptBox["k4", "2"]}], ")"}], "2"], " ", 
     SuperscriptBox["z1", "4"], " ", 
     SuperscriptBox[
      RowBox[{"sc", "[", 
       RowBox[{"e1", ",", "e2"}], "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"sc", "[", 
       RowBox[{"e3", ",", "e4"}], "]"}], "2"]}], 
    RowBox[{"16", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
     SuperscriptBox["ks", "4"]}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
     SuperscriptBox["ks", "4"], " ", 
     SuperscriptBox["z1", "4"], " ", 
     SuperscriptBox[
      RowBox[{"sc", "[", 
       RowBox[{"e1", ",", "e2"}], "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"sc", "[", 
       RowBox[{"e3", ",", "e4"}], "]"}], "2"]}], 
    RowBox[{"16", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "+", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"8", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], 
    SuperscriptBox["ks", "2"], " ", 
    SuperscriptBox["z1", "4"], " ", 
    RowBox[{"sc", "[", 
     RowBox[{"e1", ",", "e2"}], "]"}], " ", 
    RowBox[{"sc", "[", 
     RowBox[{"e3", ",", "e4"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{"e1", ",", "k3"}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e2", ",", "k1"}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e3", ",", "e4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{"e2", ",", "k1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"e1", ",", "e4"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{"e3", ",", "k1"}], "]"}], "+", 
               RowBox[{"sc", "[", 
                RowBox[{"e3", ",", "k2"}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"e1", ",", "e3"}], "]"}], " ", 
             RowBox[{"sc", "[", 
              RowBox[{"e4", ",", "k3"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{"e1", ",", "k2"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"sc", "[", 
               RowBox[{"e2", ",", "k3"}], "]"}]}], " ", 
             RowBox[{"sc", "[", 
              RowBox[{"e3", ",", "e4"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"e2", ",", "e4"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{"e3", ",", "k1"}], "]"}], "+", 
               RowBox[{"sc", "[", 
                RowBox[{"e3", ",", "k2"}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"e2", ",", "e3"}], "]"}], " ", 
             RowBox[{"sc", "[", 
              RowBox[{"e4", ",", "k3"}], "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"e1", ",", "e2"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["k1", "2"], "+", 
                 SuperscriptBox["k2", "2"], "+", 
                 SuperscriptBox["k3", "2"], "+", 
                 SuperscriptBox["k4", "2"]}], ")"}]}], ")"}]}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
             SuperscriptBox["kt", "2"]}]}], ")"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e3", ",", "e4"}], "]"}]}], "-", 
         RowBox[{"4", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"e3", ",", "k1"}], "]"}], " ", 
             RowBox[{"sc", "[", 
              RowBox[{"e4", ",", "k2"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"e3", ",", "k2"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{"e4", ",", "k2"}], "]"}], "+", 
               RowBox[{"sc", "[", 
                RowBox[{"e4", ",", "k3"}], "]"}]}], ")"}]}]}], ")"}]}]}], 
        ")"}]}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"8", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
      SuperscriptBox["ks", "2"]}]], 
    SuperscriptBox["z1", "4"], " ", 
    RowBox[{"sc", "[", 
     RowBox[{"e1", ",", "e2"}], "]"}], " ", 
    RowBox[{"sc", "[", 
     RowBox[{"e3", ",", "e4"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "4"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["k1", "2"], "-", 
         SuperscriptBox["k2", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["k3", "2"], "-", 
         SuperscriptBox["k4", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{"e1", ",", "k3"}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e2", ",", "k1"}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e3", ",", "e4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{"e2", ",", "k1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"e1", ",", "e4"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{"e3", ",", "k1"}], "]"}], "+", 
               RowBox[{"sc", "[", 
                RowBox[{"e3", ",", "k2"}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"e1", ",", "e3"}], "]"}], " ", 
             RowBox[{"sc", "[", 
              RowBox[{"e4", ",", "k3"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{"e1", ",", "k2"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"sc", "[", 
               RowBox[{"e2", ",", "k3"}], "]"}]}], " ", 
             RowBox[{"sc", "[", 
              RowBox[{"e3", ",", "e4"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"e2", ",", "e4"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{"e3", ",", "k1"}], "]"}], "+", 
               RowBox[{"sc", "[", 
                RowBox[{"e3", ",", "k2"}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"e2", ",", "e3"}], "]"}], " ", 
             RowBox[{"sc", "[", 
              RowBox[{"e4", ",", "k3"}], "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"e1", ",", "e2"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["k1", "4"], " ", 
             SuperscriptBox["k4", "2"]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["k2", "2"], " ", 
             SuperscriptBox["k3", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["k2", "2"], "+", 
               SuperscriptBox["k3", "2"], "-", 
               SuperscriptBox["k4", "2"]}], ")"}]}], "+", 
            RowBox[{"d", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["k1", "2"], "-", 
               SuperscriptBox["k2", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["k3", "2"], "-", 
               SuperscriptBox["k4", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["k1", "2"], "+", 
               SuperscriptBox["k2", "2"], "+", 
               SuperscriptBox["k3", "2"], "+", 
               SuperscriptBox["k4", "2"]}], ")"}]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["k1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["k4", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["k3", "2"], "-", 
                  SuperscriptBox["k4", "2"]}], ")"}]}], "+", 
               RowBox[{
                SuperscriptBox["k2", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["k3", "2"], "+", 
                  SuperscriptBox["k4", "2"]}], ")"}]}]}], ")"}]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["k1", "2"], "-", 
               SuperscriptBox["k2", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["k3", "2"], "-", 
               SuperscriptBox["k4", "2"]}], ")"}], " ", 
             SuperscriptBox["kt", "2"]}]}], ")"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e3", ",", "e4"}], "]"}]}], "+", 
         RowBox[{"4", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["k1", "2"], "-", 
            SuperscriptBox["k2", "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["k3", "2"], "-", 
            SuperscriptBox["k4", "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"e3", ",", "k1"}], "]"}], " ", 
             RowBox[{"sc", "[", 
              RowBox[{"e4", ",", "k2"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"e3", ",", "k2"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{"e4", ",", "k2"}], "]"}], "+", 
               RowBox[{"sc", "[", 
                RowBox[{"e4", ",", "k3"}], "]"}]}], ")"}]}]}], ")"}]}]}], 
        ")"}]}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["1", "16"], " ", 
    SuperscriptBox["z1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"16", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{"e1", ",", "k3"}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{"e2", ",", "k1"}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{"e3", ",", "e4"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{"e2", ",", "k1"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{"e1", ",", "e4"}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{"e3", ",", "k1"}], "]"}], "+", 
                RowBox[{"sc", "[", 
                 RowBox[{"e3", ",", "k2"}], "]"}]}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{"e1", ",", "e3"}], "]"}], " ", 
              RowBox[{"sc", "[", 
               RowBox[{"e4", ",", "k3"}], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{"e1", ",", "k2"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"sc", "[", 
                RowBox[{"e2", ",", "k3"}], "]"}]}], " ", 
              RowBox[{"sc", "[", 
               RowBox[{"e3", ",", "e4"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{"e2", ",", "e4"}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{"e3", ",", "k1"}], "]"}], "+", 
                RowBox[{"sc", "[", 
                 RowBox[{"e3", ",", "k2"}], "]"}]}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{"e2", ",", "e3"}], "]"}], " ", 
              RowBox[{"sc", "[", 
               RowBox[{"e4", ",", "k3"}], "]"}]}]}], ")"}]}]}], ")"}], "2"]}],
       "+", 
      RowBox[{"8", " ", 
       RowBox[{"sc", "[", 
        RowBox[{"e1", ",", "e2"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{"e1", ",", "k3"}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e2", ",", "k1"}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e3", ",", "e4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{"e2", ",", "k1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"e1", ",", "e4"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{"e3", ",", "k1"}], "]"}], "+", 
               RowBox[{"sc", "[", 
                RowBox[{"e3", ",", "k2"}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"e1", ",", "e3"}], "]"}], " ", 
             RowBox[{"sc", "[", 
              RowBox[{"e4", ",", "k3"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{"e1", ",", "k2"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"sc", "[", 
               RowBox[{"e2", ",", "k3"}], "]"}]}], " ", 
             RowBox[{"sc", "[", 
              RowBox[{"e3", ",", "e4"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"e2", ",", "e4"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{"e3", ",", "k1"}], "]"}], "+", 
               RowBox[{"sc", "[", 
                RowBox[{"e3", ",", "k2"}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"e2", ",", "e3"}], "]"}], " ", 
             RowBox[{"sc", "[", 
              RowBox[{"e4", ",", "k3"}], "]"}]}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k1", "2"]}], "-", 
            SuperscriptBox["k2", "2"], "-", 
            SuperscriptBox["k3", "2"], "-", 
            SuperscriptBox["k4", "2"], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["kt", "2"]}]}], ")"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e3", ",", "e4"}], "]"}]}], "-", 
         RowBox[{"4", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"e3", ",", "k1"}], "]"}], " ", 
             RowBox[{"sc", "[", 
              RowBox[{"e4", ",", "k2"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"e3", ",", "k2"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{"e4", ",", "k2"}], "]"}], "+", 
               RowBox[{"sc", "[", 
                RowBox[{"e4", ",", "k3"}], "]"}]}], ")"}]}]}], ")"}]}]}], 
        ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}]], 
       SuperscriptBox[
        RowBox[{"sc", "[", 
         RowBox[{"e1", ",", "e2"}], "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
             SuperscriptBox["k1", "4"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["k2", "4"]}], "+", 
            RowBox[{"d", " ", 
             SuperscriptBox["k2", "4"]}], "-", 
            RowBox[{"8", " ", 
             SuperscriptBox["k2", "2"], " ", 
             SuperscriptBox["k3", "2"]}], "+", 
            RowBox[{"4", " ", "d", " ", 
             SuperscriptBox["k2", "2"], " ", 
             SuperscriptBox["k3", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["k3", "4"]}], "+", 
            RowBox[{"d", " ", 
             SuperscriptBox["k3", "4"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["k2", "2"], " ", 
             SuperscriptBox["k4", "2"]}], "+", 
            RowBox[{"2", " ", "d", " ", 
             SuperscriptBox["k3", "2"], " ", 
             SuperscriptBox["k4", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["k4", "4"]}], "+", 
            RowBox[{"d", " ", 
             SuperscriptBox["k4", "4"]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["k1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d", " ", 
                SuperscriptBox["k2", "2"]}], "-", 
               RowBox[{"2", " ", 
                SuperscriptBox["k3", "2"]}], "-", 
               RowBox[{"4", " ", 
                SuperscriptBox["k4", "2"]}], "+", 
               RowBox[{"2", " ", "d", " ", 
                SuperscriptBox["k4", "2"]}]}], ")"}]}], "-", 
            RowBox[{"4", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["k1", "2"], "+", 
               SuperscriptBox["k2", "2"], "+", 
               SuperscriptBox["k3", "2"], "+", 
               SuperscriptBox["k4", "2"]}], ")"}], " ", 
             SuperscriptBox["kt", "2"]}], "+", 
            RowBox[{"4", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
             SuperscriptBox["kt", "4"]}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"sc", "[", 
            RowBox[{"e3", ",", "e4"}], "]"}], "2"]}], "-", 
         RowBox[{"8", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k1", "2"]}], "-", 
            SuperscriptBox["k2", "2"], "-", 
            SuperscriptBox["k3", "2"], "-", 
            SuperscriptBox["k4", "2"], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["kt", "2"]}]}], ")"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e3", ",", "e4"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"e3", ",", "k1"}], "]"}], " ", 
             RowBox[{"sc", "[", 
              RowBox[{"e4", ",", "k2"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"e3", ",", "k2"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{"e4", ",", "k2"}], "]"}], "+", 
               RowBox[{"sc", "[", 
                RowBox[{"e4", ",", "k3"}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"16", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{"e3", ",", "k1"}], "]"}], " ", 
              RowBox[{"sc", "[", 
               RowBox[{"e4", ",", "k2"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{"e3", ",", "k2"}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{"e4", ",", "k2"}], "]"}], "+", 
                RowBox[{"sc", "[", 
                 RowBox[{"e4", ",", "k3"}], "]"}]}], ")"}]}]}], ")"}], 
           "2"]}]}], ")"}]}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.911542560724918*^9, 3.9115425692467213`*^9}, 
   3.911542607593192*^9, {3.911543061824704*^9, 3.911543063780861*^9}, 
   3.9118048687232695`*^9},
 CellLabel->
  "In[144]:=",ExpressionUUID->"ea051dfb-6554-4dcb-bdba-77b4c2f061ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a1GR4", "[", 
   RowBox[{"x1_", ",", "x2_", ",", "x3_", ",", "x4_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{"pi22GR1234", "[", 
    RowBox[{"z1", ",", 
     RowBox[{"ks", "[", 
      RowBox[{"x1", ",", "x2"}], "]"}], ",", 
     RowBox[{"ks", "[", 
      RowBox[{"x2", ",", "x3"}], "]"}], ",", 
     RowBox[{"k", "[", "x1", "]"}], ",", 
     RowBox[{"k", "[", "x2", "]"}], ",", 
     RowBox[{"k", "[", "x3", "]"}], ",", 
     RowBox[{"k", "[", "x4", "]"}], ",", 
     RowBox[{"e", "[", "x1", "]"}], ",", 
     RowBox[{"e", "[", "x2", "]"}], ",", 
     RowBox[{"e", "[", "x3", "]"}], ",", 
     RowBox[{"e", "[", "x4", "]"}], ",", 
     RowBox[{"s", "[", "x1", "]"}], ",", 
     RowBox[{"s", "[", "x2", "]"}], ",", 
     RowBox[{"s", "[", "x3", "]"}], ",", 
     RowBox[{"s", "[", "x4", "]"}]}], "]"}], ")"}]}]], "Input",
 CellChangeTimes->{
  3.912923290545886*^9, {3.912923377092971*^9, 3.9129234085213604`*^9}, {
   3.912923526032663*^9, 3.912923583241997*^9}, 3.9129236668245907`*^9, {
   3.9129239116104264`*^9, 3.9129239124859114`*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"367c42a5-9913-4da0-9aaf-9986cf3cb1d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"aGR1234", "[", 
   RowBox[{
   "z1_", ",", "ks_", ",", "k1_", ",", "k2_", ",", "k3_", ",", "k4_", ",", 
    "e1_", ",", "e2_", ",", "e3_", ",", "e4_", ",", "s1_", ",", "s2_", ",", 
    "s3_", ",", "s4_"}], "]"}], ":=", 
  RowBox[{"-", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
      SuperscriptBox["ks", "4"]}]], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["k1", "2"], "-", 
       SuperscriptBox["k2", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["k3", "2"], "-", 
       SuperscriptBox["k4", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"s1", "-", "s2"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"s3", "-", "s4"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"sc", "[", 
       RowBox[{"e1", ",", "e2"}], "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"sc", "[", 
       RowBox[{"e3", ",", "e4"}], "]"}], "2"]}]}]}]}]], "Input",
 CellLabel->
  "In[146]:=",ExpressionUUID->"d90a8a2e-e625-4d8d-90e8-de828afed981"],

Cell[BoxData[
 RowBox[{
  RowBox[{"baGR1234", "[", 
   RowBox[{
   "z1_", ",", "ks_", ",", "k1_", ",", "k2_", ",", "k3_", ",", "k4_", ",", 
    "e1_", ",", "e2_", ",", "e3_", ",", "e4_", ",", "s1_", ",", "s2_", ",", 
    "s3_", ",", "s4_"}], "]"}], ":=", 
  RowBox[{"-", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
      SuperscriptBox["ks", "4"]}]], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["k1", "2"], "-", 
       SuperscriptBox["k2", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["k3", "2"], "-", 
       SuperscriptBox["k4", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"s1", "-", "s2"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"s3", "-", "s4"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"sc", "[", 
       RowBox[{"e1", ",", "e2"}], "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"sc", "[", 
       RowBox[{"e3", ",", "e4"}], "]"}], "2"]}]}]}]}]], "Input",
 CellChangeTimes->{3.9115424684658213`*^9},
 CellLabel->
  "In[147]:=",ExpressionUUID->"d9c80d94-bc46-41f7-8fb1-add719169342"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bspGR1234", "[", 
   RowBox[{
   "z1_", ",", "ks_", ",", "kt_", ",", "k1_", ",", "k2_", ",", "k3_", ",", 
    "k4_", ",", "e1_", ",", "e2_", ",", "e3_", ",", "e4_", ",", "s1_", ",", 
    "s2_", ",", "s3_", ",", "s4_"}], "]"}], ":=", 
  RowBox[{"-", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"2", " ", 
      SuperscriptBox["ks", "2"]}]], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["k1", "2"], "+", 
       SuperscriptBox["k2", "2"], "+", 
       SuperscriptBox["k3", "2"], "+", 
       SuperscriptBox["k4", "2"], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["kt", "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"s1", "-", "s2"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"s3", "-", "s4"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"sc", "[", 
       RowBox[{"e1", ",", "e2"}], "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"sc", "[", 
       RowBox[{"e3", ",", "e4"}], "]"}], "2"]}]}]}]}]], "Input",
 CellLabel->
  "In[148]:=",ExpressionUUID->"3467e71a-2233-42f5-b918-2ae16abaa42b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"brGR1234", "[", 
   RowBox[{
   "z1_", ",", "ks_", ",", "kt_", ",", "k1_", ",", "k2_", ",", "k3_", ",", 
    "k4_", ",", "e1_", ",", "e2_", ",", "e3_", ",", "e4_", ",", "s1_", ",", 
    "s2_", ",", "s3_", ",", "s4_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"16", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
     SuperscriptBox["ks", "2"]}]], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["k3", "2"], "-", 
          SuperscriptBox["k4", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["d", "2"], "-", 
          RowBox[{"8", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["s1", "2"], "+", 
             SuperscriptBox["s2", "2"]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"s3", "-", "s4"}], ")"}]}], 
       RowBox[{"d", "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"s3", "+", "s4"}], ")"}]}]}]], "+", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["k1", "2"], "-", 
          SuperscriptBox["k2", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"s1", "-", "s2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["d", "2"], "-", 
          RowBox[{"8", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["s3", "2"], "+", 
             SuperscriptBox["s4", "2"]}], ")"}]}]}], ")"}]}], 
       RowBox[{"d", "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"s1", "+", "s2"}], ")"}]}]}]], "+", 
      FractionBox[
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["k1", "2"], "-", 
          SuperscriptBox["k2", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["k3", "2"], "-", 
          SuperscriptBox["k4", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"s1", "-", "s2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"s3", "-", "s4"}], ")"}], " ", 
        SuperscriptBox["z1", "2"]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d", "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"s1", "+", "s2"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"d", "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"s3", "+", "s4"}], ")"}]}]}], ")"}]}]]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{"e1", ",", "e2"}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{"e3", ",", "e4"}], "]"}], "2"]}]}]}]], "Input",
 CellLabel->
  "In[149]:=",ExpressionUUID->"d1674dd9-c893-4190-bec7-ce70df0cd162"],

Cell[BoxData[
 RowBox[{
  RowBox[{"badGR1234", "[", 
   RowBox[{
   "z1_", ",", "ks_", ",", "kt_", ",", "k1_", ",", "k2_", ",", "k3_", ",", 
    "k4_", ",", "e1_", ",", "e2_", ",", "e3_", ",", "e4_", ",", "s1_", ",", 
    "s2_", ",", "s3_", ",", "s4_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     SuperscriptBox["ks", "2"]]}], "2", " ", 
   RowBox[{"(", 
    RowBox[{"s1", "-", "s2"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"s3", "-", "s4"}], ")"}], " ", 
   RowBox[{"sc", "[", 
    RowBox[{"e1", ",", "e2"}], "]"}], " ", 
   RowBox[{"sc", "[", 
    RowBox[{"e3", ",", "e4"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"sc", "[", 
        RowBox[{"e1", ",", "k3"}], "]"}]}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{"e2", ",", "k1"}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{"e3", ",", "e4"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{"e1", ",", "e4"}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{"e2", ",", "k1"}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{"e3", ",", "k1"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{"e1", ",", "e4"}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{"e2", ",", "k1"}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{"e3", ",", "k2"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{"e1", ",", "e2"}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{"e3", ",", "k1"}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{"e4", ",", "k2"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{"e1", ",", "e2"}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{"e3", ",", "k2"}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{"e4", ",", "k2"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{"e1", ",", "e3"}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{"e2", ",", "k1"}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{"e4", ",", "k3"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{"e1", ",", "e2"}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{"e3", ",", "k2"}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{"e4", ",", "k3"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{"e1", ",", "k2"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"e2", ",", "k3"}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{"e3", ",", "e4"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"e2", ",", "e4"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{"e3", ",", "k1"}], "]"}], "+", 
           RowBox[{"sc", "[", 
            RowBox[{"e3", ",", "k2"}], "]"}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"e2", ",", "e3"}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{"e4", ",", "k3"}], "]"}]}]}], ")"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.911576854691121*^9, 3.9115768558116527`*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"ae79d660-b0fb-4e18-8b42-c72c64076d2a"],

Cell[BoxData[
 RowBox[{"Clear", "@", "bGR4"}]], "Input",
 CellChangeTimes->{{3.913027103749402*^9, 3.91302711079462*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"c2dacb5d-d2d0-48d9-89d1-ecf9d42d22f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bGR4", "[", 
   RowBox[{"x1_", ",", "x2_", ",", "x3_", ",", "x4_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"baGR1234", "[", 
     RowBox[{"z1", ",", 
      RowBox[{"ks", "[", 
       RowBox[{"x1", ",", "x2"}], "]"}], ",", 
      RowBox[{"k", "[", "x1", "]"}], ",", 
      RowBox[{"k", "[", "x2", "]"}], ",", 
      RowBox[{"k", "[", "x3", "]"}], ",", 
      RowBox[{"k", "[", "x4", "]"}], ",", 
      RowBox[{"e", "[", "x1", "]"}], ",", 
      RowBox[{"e", "[", "x2", "]"}], ",", 
      RowBox[{"e", "[", "x3", "]"}], ",", 
      RowBox[{"e", "[", "x4", "]"}], ",", 
      RowBox[{"s", "[", "x1", "]"}], ",", 
      RowBox[{"s", "[", "x2", "]"}], ",", 
      RowBox[{"s", "[", "x3", "]"}], ",", 
      RowBox[{"s", "[", "x4", "]"}]}], "]"}], "+", 
    RowBox[{"bspGR1234", "[", 
     RowBox[{"z1", ",", 
      RowBox[{"ks", "[", 
       RowBox[{"x1", ",", "x2"}], "]"}], ",", 
      RowBox[{"ks", "[", 
       RowBox[{"x2", ",", "x3"}], "]"}], ",", 
      RowBox[{"k", "[", "x1", "]"}], ",", 
      RowBox[{"k", "[", "x2", "]"}], ",", 
      RowBox[{"k", "[", "x3", "]"}], ",", 
      RowBox[{"k", "[", "x4", "]"}], ",", 
      RowBox[{"e", "[", "x1", "]"}], ",", 
      RowBox[{"e", "[", "x2", "]"}], ",", 
      RowBox[{"e", "[", "x3", "]"}], ",", 
      RowBox[{"e", "[", "x4", "]"}], ",", 
      RowBox[{"s", "[", "x1", "]"}], ",", 
      RowBox[{"s", "[", "x2", "]"}], ",", 
      RowBox[{"s", "[", "x3", "]"}], ",", 
      RowBox[{"s", "[", "x4", "]"}]}], "]"}], "+", 
    RowBox[{"brGR1234nosPnos1", "[", 
     RowBox[{"z1", ",", 
      RowBox[{"ks", "[", 
       RowBox[{"x1", ",", "x2"}], "]"}], ",", 
      RowBox[{"ks", "[", 
       RowBox[{"x2", ",", "x3"}], "]"}], ",", 
      RowBox[{"k", "[", "x1", "]"}], ",", 
      RowBox[{"k", "[", "x2", "]"}], ",", 
      RowBox[{"k", "[", "x3", "]"}], ",", 
      RowBox[{"k", "[", "x4", "]"}], ",", 
      RowBox[{"e", "[", "x1", "]"}], ",", 
      RowBox[{"e", "[", "x2", "]"}], ",", 
      RowBox[{"e", "[", "x3", "]"}], ",", 
      RowBox[{"e", "[", "x4", "]"}], ",", 
      RowBox[{"s", "[", "x1", "]"}], ",", 
      RowBox[{"s", "[", "x2", "]"}], ",", 
      RowBox[{"s", "[", "x3", "]"}], ",", 
      RowBox[{"s", "[", "x4", "]"}]}], "]"}], "+", 
    RowBox[{"badGR1234", "[", 
     RowBox[{"z1", ",", 
      RowBox[{"ks", "[", 
       RowBox[{"x1", ",", "x2"}], "]"}], ",", 
      RowBox[{"ks", "[", 
       RowBox[{"x2", ",", "x3"}], "]"}], ",", 
      RowBox[{"k", "[", "x1", "]"}], ",", 
      RowBox[{"k", "[", "x2", "]"}], ",", 
      RowBox[{"k", "[", "x3", "]"}], ",", 
      RowBox[{"k", "[", "x4", "]"}], ",", 
      RowBox[{"e", "[", "x1", "]"}], ",", 
      RowBox[{"e", "[", "x2", "]"}], ",", 
      RowBox[{"e", "[", "x3", "]"}], ",", 
      RowBox[{"e", "[", "x4", "]"}], ",", 
      RowBox[{"s", "[", "x1", "]"}], ",", 
      RowBox[{"s", "[", "x2", "]"}], ",", 
      RowBox[{"s", "[", "x3", "]"}], ",", 
      RowBox[{"s", "[", "x4", "]"}]}], "]"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.9129237770702515`*^9, 3.9129237845266595`*^9}, {
   3.912923815932515*^9, 3.912923863953245*^9}, {3.9129239511985507`*^9, 
   3.9129239527330737`*^9}, 3.9130270235887127`*^9},
 CellLabel->
  "In[152]:=",ExpressionUUID->"e30c0791-e30d-48ed-af4e-3c95ac39586c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CsGR1234", "[", 
   RowBox[{
   "z1_", ",", "ks_", ",", "k1_", ",", "k2_", ",", "k3_", ",", "k4_", ",", 
    "e1_", ",", "e2_", ",", "e3_", ",", "e4_", ",", "s1_", ",", "s2_", ",", 
    "s3_", ",", "s4_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       SuperscriptBox["d", "2"], 
       RowBox[{"16", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"s1", "-", "s2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"s3", "-", "s4"}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"s1", "-", "s2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"s3", "-", "s4"}], ")"}], "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "-", 
         FractionBox["y4s", "2"]}], ")"}]}], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["d", "2"], " ", "y4s"}], "8"], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"s1", "+", "s2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"s3", "+", "s4"}], ")"}], " ", "y4s"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["s1", "2"], "+", 
         SuperscriptBox["s2", "2"], "+", 
         SuperscriptBox["s3", "2"], "+", 
         SuperscriptBox["s4", "2"]}], ")"}], " ", "y4s"}]}], ")"}], 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{"e1", ",", "e2"}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{"e3", ",", "e4"}], "]"}], "2"]}], "/.", 
   RowBox[{"y4s", "->", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.911978240894122*^9, 3.9119782428758845`*^9}, {
  3.912010357930998*^9, 3.9120103650625324`*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"29c0bcc0-75e7-4cab-b9bc-eaada185805f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CfGR1234", "[", 
    RowBox[{
    "z1_", ",", "ks_", ",", "kt_", ",", "k1_", ",", "k2_", ",", "k3_", ",", 
     "k4_", ",", "e1_", ",", "e2_", ",", "e3_", ",", "e4_", ",", "s1_", ",", 
     "s2_", ",", "s3_", ",", "s4_"}], "]"}], ":=", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "16"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", 
          RowBox[{"(", 
           RowBox[{"s1", "+", "s2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"s3", "+", "s4"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["ks", "2"], " ", 
          SuperscriptBox["z1", "2"]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"sc", "[", 
             RowBox[{"e1", ",", "e2"}], "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"sc", "[", 
             RowBox[{"e3", ",", "e4"}], "]"}], "2"]}], 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}]], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"e1", ",", "e4"}], "]"}], " ", 
             RowBox[{"sc", "[", 
              RowBox[{"e2", ",", "e3"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"e1", ",", "e3"}], "]"}], " ", 
             RowBox[{"sc", "[", 
              RowBox[{"e2", ",", "e4"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"e1", ",", "e2"}], "]"}], " ", 
             RowBox[{"sc", "[", 
              RowBox[{"e3", ",", "e4"}], "]"}]}]}], ")"}], "2"]}], ")"}]}], 
      "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{"e1", ",", "e4"}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e2", ",", "e3"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{"e1", ",", "e3"}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e2", ",", "e4"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["z1", "2"]}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e1", ",", "k3"}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e2", ",", "k1"}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e3", ",", "e4"}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["z1", "2"], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e1", ",", "k2"}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e2", ",", "k3"}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e3", ",", "e4"}], "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["z1", "2"], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e1", ",", "k2"}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e2", ",", "e4"}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e3", ",", "k1"}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["z1", "2"], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e1", ",", "e4"}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e2", ",", "k1"}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e3", ",", "k1"}], "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["z1", "2"], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e1", ",", "k2"}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e2", ",", "e4"}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e3", ",", "k2"}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["z1", "2"], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e1", ",", "e4"}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e2", ",", "k1"}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e3", ",", "k2"}], "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["z1", "2"], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e1", ",", "k2"}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e2", ",", "e3"}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e4", ",", "k3"}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["z1", "2"], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e1", ",", "e3"}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e2", ",", "k1"}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{"e4", ",", "k3"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{"e1", ",", "e2"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              FractionBox["1", "2"]}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", 
                RowBox[{"(", 
                 RowBox[{"s2", "+", "s3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"s1", "+", "s4"}], ")"}]}], "+", 
               RowBox[{
                SuperscriptBox["kt", "2"], " ", 
                SuperscriptBox["z1", "2"]}]}], ")"}], " ", 
             RowBox[{"sc", "[", 
              RowBox[{"e3", ",", "e4"}], "]"}]}], "+", 
            RowBox[{
             SuperscriptBox["z1", "2"], " ", 
             RowBox[{"sc", "[", 
              RowBox[{"e3", ",", "k1"}], "]"}], " ", 
             RowBox[{"sc", "[", 
              RowBox[{"e4", ",", "k2"}], "]"}]}], "+", 
            RowBox[{"z1", " ", 
             RowBox[{"sc", "[", 
              RowBox[{"e3", ",", "k2"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"z1", " ", 
                RowBox[{"sc", "[", 
                 RowBox[{"e4", ",", "k2"}], "]"}]}], "+", 
               RowBox[{"z1", " ", 
                RowBox[{"sc", "[", 
                 RowBox[{"e4", ",", "k3"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
        ")"}]}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9116673594514275`*^9, 3.911667376756008*^9}, {
  3.9116680895951614`*^9, 3.911668092009946*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"ad527d6f-3a15-41ba-9ef5-e66771caac77"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cGR4", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "x3_", ",", "x4_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"CsGR1234", "[", 
      RowBox[{"z1", ",", 
       RowBox[{"ks", "[", 
        RowBox[{"x1", ",", "x2"}], "]"}], ",", 
       RowBox[{"k", "[", "x1", "]"}], ",", 
       RowBox[{"k", "[", "x2", "]"}], ",", 
       RowBox[{"k", "[", "x3", "]"}], ",", 
       RowBox[{"k", "[", "x4", "]"}], ",", 
       RowBox[{"e", "[", "x1", "]"}], ",", 
       RowBox[{"e", "[", "x2", "]"}], ",", 
       RowBox[{"e", "[", "x3", "]"}], ",", 
       RowBox[{"e", "[", "x4", "]"}], ",", 
       RowBox[{"s", "[", "x1", "]"}], ",", 
       RowBox[{"s", "[", "x2", "]"}], ",", 
       RowBox[{"s", "[", "x3", "]"}], ",", 
       RowBox[{"s", "[", "x4", "]"}]}], "]"}], "+", 
     RowBox[{"CfGR1234", "[", 
      RowBox[{"z1", ",", 
       RowBox[{"ks", "[", 
        RowBox[{"x1", ",", "x2"}], "]"}], ",", 
       RowBox[{"ks", "[", 
        RowBox[{"x2", ",", "x3"}], "]"}], ",", 
       RowBox[{"k", "[", "x1", "]"}], ",", 
       RowBox[{"k", "[", "x2", "]"}], ",", 
       RowBox[{"k", "[", "x3", "]"}], ",", 
       RowBox[{"k", "[", "x4", "]"}], ",", 
       RowBox[{"e", "[", "x1", "]"}], ",", 
       RowBox[{"e", "[", "x2", "]"}], ",", 
       RowBox[{"e", "[", "x3", "]"}], ",", 
       RowBox[{"e", "[", "x4", "]"}], ",", 
       RowBox[{"s", "[", "x1", "]"}], ",", 
       RowBox[{"s", "[", "x2", "]"}], ",", 
       RowBox[{"s", "[", "x3", "]"}], ",", 
       RowBox[{"s", "[", "x4", "]"}]}], "]"}]}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9129241680630455`*^9, 3.9129241969447794`*^9}, 
   3.913027090243292*^9},
 CellLabel->
  "In[155]:=",ExpressionUUID->"347b983d-bbb5-43e4-989f-7243612a5edd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MGR1234", "[", 
    RowBox[{
    "z1_", ",", "ks_", ",", "kt_", ",", "k1_", ",", "k2_", ",", "k3_", ",", 
     "k4_", ",", "e1_", ",", "e2_", ",", "e3_", ",", "e4_", ",", "s1_", ",", 
     "s2_", ",", "s3_", ",", "s4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          SubscriptBox["D", "ks"]], 
         RowBox[{"pi22GR1234", "[", 
          RowBox[{
          "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
           "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
           "s2", ",", "s3", ",", "s4"}], "]"}]}], "/.", "rulesinv"}], ")"}], 
      "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"baGR1234", "[", 
          RowBox[{
          "z1", ",", "ks", ",", "k1", ",", "k2", ",", "k3", ",", "k4", ",", 
           "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", "s2", ",", 
           "s3", ",", "s4"}], "]"}], "+", 
         RowBox[{"bspGR1234", "[", 
          RowBox[{
          "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
           "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
           "s2", ",", "s3", ",", "s4"}], "]"}], "+", 
         RowBox[{"brGR1234", "[", 
          RowBox[{
          "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
           "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
           "s2", ",", "s3", ",", "s4"}], "]"}], "+", 
         RowBox[{"badGR1234", "[", 
          RowBox[{
          "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
           "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
           "s2", ",", "s3", ",", "s4"}], "]"}]}], "/.", "rulesinv"}], ")"}], 
      "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"CsGR1234", "[", 
          RowBox[{
          "z1", ",", "ks", ",", "k1", ",", "k2", ",", "k3", ",", "k4", ",", 
           "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", "s2", ",", 
           "s3", ",", "s4"}], "]"}], "+", 
         RowBox[{"CfGR1234", "[", 
          RowBox[{
          "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
           "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
           "s2", ",", "s3", ",", "s4"}], "]"}]}], "/.", "rulesinv"}], ")"}]}],
      ")"}], "/.", 
    RowBox[{"y4s", "->", "0"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.911801492376831*^9, 3.911801514507106*^9}, {
   3.9118015473699665`*^9, 3.911801548702524*^9}, {3.911804889280346*^9, 
   3.9118049136277733`*^9}, 3.912923302909602*^9},
 CellLabel->
  "In[156]:=",ExpressionUUID->"2df9e077-4255-48e8-98ac-9b1192bd9c5e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BtildeGR1234", "[", 
    RowBox[{
    "z1_", ",", "ks_", ",", "kt_", ",", "k1_", ",", "k2_", ",", "k3_", ",", 
     "k4_", ",", "e1_", ",", "e2_", ",", "e3_", ",", "e4_", ",", "s1_", ",", 
     "s2_", ",", "s3_", ",", "s4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"(*", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"pi22GR1234", "[", 
          RowBox[{
          "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
           "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
           "s2", ",", "s3", ",", "s4"}], "]"}], 
         SubscriptBox["D", "ks"]], "/.", "rulesinv"}], ")"}], "*)"}], 
     RowBox[{
      RowBox[{"+", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"baGR1234", "[", 
           RowBox[{
           "z1", ",", "ks", ",", "k1", ",", "k2", ",", "k3", ",", "k4", ",", 
            "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", "s2", ",", 
            "s3", ",", "s4"}], "]"}], "+", 
          RowBox[{"bspGR1234", "[", 
           RowBox[{
           "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
            "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
            "s2", ",", "s3", ",", "s4"}], "]"}], "+", 
          RowBox[{"brGR1234", "[", 
           RowBox[{
           "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
            "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
            "s2", ",", "s3", ",", "s4"}], "]"}], "+", 
          RowBox[{"badGR1234", "[", 
           RowBox[{
           "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
            "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
            "s2", ",", "s3", ",", "s4"}], "]"}]}], "/.", "rulesinv"}], 
        ")"}]}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"CsGR1234", "[", 
          RowBox[{
          "z1", ",", "ks", ",", "k1", ",", "k2", ",", "k3", ",", "k4", ",", 
           "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", "s2", ",", 
           "s3", ",", "s4"}], "]"}], "+", 
         RowBox[{"CfGR1234", "[", 
          RowBox[{
          "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
           "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
           "s2", ",", "s3", ",", "s4"}], "]"}]}], "/.", "rulesinv"}], ")"}]}],
      ")"}], "/.", 
    RowBox[{"y4s", "->", "0"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9118166341003237`*^9, 3.911816647572554*^9}, 
   3.9129233316037474`*^9},
 CellLabel->
  "In[157]:=",ExpressionUUID->"b1ab71a1-ef94-4d1d-8cc0-eb0a0b79aee6"]
}, Closed]],

Cell[CellGroupData[{

Cell["4 point GR  additional", "Subsection",
 CellChangeTimes->{{3.912232509477888*^9, 3.912232509955848*^9}, {
  3.912622426517482*^9, 
  3.91262243107096*^9}},ExpressionUUID->"94532124-0e07-4c09-a3b1-\
1e9e23003e69"],

Cell[BoxData[
 RowBox[{
  RowBox[{"brGR1234nosPnos1", "[", 
   RowBox[{
   "z1_", ",", "ks_", ",", "kt_", ",", "k1_", ",", "k2_", ",", "k3_", ",", 
    "k4_", ",", "e1_", ",", "e2_", ",", "e3_", ",", "e4_", ",", "s1_", ",", 
    "s2_", ",", "s3_", ",", "s4_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"16", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
     SuperscriptBox["ks", "2"], " ", 
     SuperscriptBox["z1", "2"]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["d", "4"]}], "+", 
     RowBox[{"4", " ", 
      SuperscriptBox["d", "3"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "s1", "+", 
        SuperscriptBox["s1", "2"], "+", "s2", "-", 
        RowBox[{"2", " ", "s1", " ", "s2"}], "+", 
        SuperscriptBox["s2", "2"], "+", 
        RowBox[{"2", " ", "s3"}]}], ")"}]}], "+", 
     RowBox[{"16", " ", "d", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["s1", "4"], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["s1", "3"], " ", "s3"}], "+", 
        RowBox[{
         SuperscriptBox["s2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["s2", "2"], "+", 
           RowBox[{"2", " ", "s3"}], "+", 
           RowBox[{"4", " ", "s2", " ", "s3"}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["s3", "2"]}]}], ")"}]}], "-", 
        RowBox[{"2", " ", "s1", " ", "s2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"6", " ", "s3"}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["s3", "2"]}], "+", 
           RowBox[{"2", " ", "s2", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "s3"}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{
         SuperscriptBox["s1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["s2", "2"]}], "-", 
           RowBox[{"2", " ", "s3"}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["s3", "2"]}], "+", 
           RowBox[{"4", " ", "s2", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "s3"}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{"32", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["s1", "4"], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["s1", "3"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "s2", "+", "s3"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["s2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["s2", "2"], "+", 
           RowBox[{"2", " ", "s3"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["s3", "2"]}], "+", 
           RowBox[{"2", " ", "s2", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "s3"}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"2", " ", "s1", " ", "s2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["s2", "2"], "+", 
           RowBox[{"2", " ", "s3", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "s3"}], ")"}]}], "+", 
           RowBox[{"s2", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"3", " ", "s3"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["s1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["s2", "2"]}], "+", 
           RowBox[{"2", " ", "s3"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["s3", "2"]}], "+", 
           RowBox[{"s2", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"6", " ", "s3"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox["d", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox["s1", "3"]}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["s2", "3"]}], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "s3"}]}], ")"}], "2"], "+", 
        RowBox[{"s2", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{"4", " ", "s3"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["s2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"4", "+", 
           RowBox[{"8", " ", "s3"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["s1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"4", "-", 
           RowBox[{"4", " ", "s2"}], "+", 
           RowBox[{"8", " ", "s3"}]}], ")"}]}], "-", 
        RowBox[{"2", " ", "s1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["s2", "2"]}], "-", 
           RowBox[{"2", " ", "s3"}], "+", 
           RowBox[{"s2", " ", 
            RowBox[{"(", 
             RowBox[{"4", "+", 
              RowBox[{"8", " ", "s3"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
    ")"}], " ", 
   SuperscriptBox[
    RowBox[{"sc", "[", 
     RowBox[{"e1", ",", "e2"}], "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"sc", "[", 
     RowBox[{"e3", ",", "e4"}], "]"}], "2"]}]}]], "Input",
 CellChangeTimes->{{3.912101470383748*^9, 3.912101551531175*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"fa6db0d0-950b-4852-9152-851f826641bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BtildeGR1234", "[", 
    RowBox[{
    "z1_", ",", "ks_", ",", "kt_", ",", "k1_", ",", "k2_", ",", "k3_", ",", 
     "k4_", ",", "e1_", ",", "e2_", ",", "e3_", ",", "e4_", ",", "s1_", ",", 
     "s2_", ",", "s3_", ",", "s4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"(*", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"pi22GR1234", "[", 
          RowBox[{
          "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
           "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
           "s2", ",", "s3", ",", "s4"}], "]"}], 
         SubscriptBox["D", "ks"]], "/.", "rulesinv"}], ")"}], "*)"}], 
     RowBox[{
      RowBox[{"+", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"aGR1234", "[", 
           RowBox[{
           "z1", ",", "ks", ",", "k1", ",", "k2", ",", "k3", ",", "k4", ",", 
            "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", "s2", ",", 
            "s3", ",", "s4"}], "]"}], "+", 
          RowBox[{"bspGR1234", "[", 
           RowBox[{
           "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
            "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
            "s2", ",", "s3", ",", "s4"}], "]"}], "+", 
          RowBox[{"brGR1234nosPnos1", "[", 
           RowBox[{
           "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
            "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
            "s2", ",", "s3", ",", "s4"}], "]"}], "+", 
          RowBox[{"badGR1234", "[", 
           RowBox[{
           "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
            "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
            "s2", ",", "s3", ",", "s4"}], "]"}]}], "/.", "rulesinv"}], 
        ")"}]}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"CsGR1234", "[", 
          RowBox[{
          "z1", ",", "ks", ",", "k1", ",", "k2", ",", "k3", ",", "k4", ",", 
           "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", "s2", ",", 
           "s3", ",", "s4"}], "]"}], "+", 
         RowBox[{"CfGR1234", "[", 
          RowBox[{
          "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
           "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
           "s2", ",", "s3", ",", "s4"}], "]"}]}], "/.", "rulesinv"}], ")"}]}],
      ")"}], "/.", 
    RowBox[{"y4s", "->", "0"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.912101786726903*^9, 3.91210179665455*^9}, 
   3.912597990910307*^9},
 CellLabel->
  "In[159]:=",ExpressionUUID->"d5c6937b-914f-4851-a597-4b57046e127d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MGR1234nos", "[", 
    RowBox[{
    "z1_", ",", "ks_", ",", "kt_", ",", "k1_", ",", "k2_", ",", "k3_", ",", 
     "k4_", ",", "e1_", ",", "e2_", ",", "e3_", ",", "e4_", ",", "s1_", ",", 
     "s2_", ",", "s3_", ",", "s4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"pi22GR1234", "[", 
          RowBox[{
          "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
           "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
           "s2", ",", "s3", ",", "s4"}], "]"}], 
         SubscriptBox["D", "ks"]], "/.", "rulesinv"}], ")"}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"aGR1234", "[", 
          RowBox[{
          "z1", ",", "ks", ",", "k1", ",", "k2", ",", "k3", ",", "k4", ",", 
           "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", "s2", ",", 
           "s3", ",", "s4"}], "]"}], "+", 
         RowBox[{"bspGR1234", "[", 
          RowBox[{
          "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
           "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
           "s2", ",", "s3", ",", "s4"}], "]"}], "+", 
         RowBox[{"brGR1234nosPnos1", "[", 
          RowBox[{
          "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
           "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
           "s2", ",", "s3", ",", "s4"}], "]"}], "+", 
         RowBox[{"badGR1234", "[", 
          RowBox[{
          "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
           "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
           "s2", ",", "s3", ",", "s4"}], "]"}]}], "/.", "rulesinv"}], ")"}], 
      "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"CsGR1234", "[", 
          RowBox[{
          "z1", ",", "ks", ",", "k1", ",", "k2", ",", "k3", ",", "k4", ",", 
           "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", "s2", ",", 
           "s3", ",", "s4"}], "]"}], "+", 
         RowBox[{"CfGR1234", "[", 
          RowBox[{
          "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
           "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
           "s2", ",", "s3", ",", "s4"}], "]"}]}], "/.", "rulesinv"}], ")"}]}],
      ")"}], "/.", 
    RowBox[{"y4s", "->", "0"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.912101583668024*^9, 3.9121015871950097`*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"7a28d688-4fba-47c9-abaa-41e2aa5388fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"bGR1234nos", "[", 
    RowBox[{
    "z1_", ",", "ks_", ",", "kt_", ",", "k1_", ",", "k2_", ",", "k3_", ",", 
     "k4_", ",", "e1_", ",", "e2_", ",", "e3_", ",", "e4_", ",", "s1_", ",", 
     "s2_", ",", "s3_", ",", "s4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"(*", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"pi22GR1234", "[", 
          RowBox[{
          "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
           "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
           "s2", ",", "s3", ",", "s4"}], "]"}], 
         SubscriptBox["D", "ks"]], "/.", "rulesinv"}], ")"}], "*)"}], 
     RowBox[{
      RowBox[{"+", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"aGR1234", "[", 
           RowBox[{
           "z1", ",", "ks", ",", "k1", ",", "k2", ",", "k3", ",", "k4", ",", 
            "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", "s2", ",", 
            "s3", ",", "s4"}], "]"}], "+", 
          RowBox[{"bspGR1234", "[", 
           RowBox[{
           "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
            "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
            "s2", ",", "s3", ",", "s4"}], "]"}], "+", 
          RowBox[{"brGR1234nosPnos1", "[", 
           RowBox[{
           "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
            "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
            "s2", ",", "s3", ",", "s4"}], "]"}], "+", 
          RowBox[{"badGR1234", "[", 
           RowBox[{
           "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
            "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
            "s2", ",", "s3", ",", "s4"}], "]"}]}], "/.", "rulesinv"}], 
        ")"}]}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"CsGR1234", "[", 
          RowBox[{
          "z1", ",", "ks", ",", "k1", ",", "k2", ",", "k3", ",", "k4", ",", 
           "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", "s2", ",", 
           "s3", ",", "s4"}], "]"}], "+", 
         RowBox[{"CfGR1234", "[", 
          RowBox[{
          "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
           "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
           "s2", ",", "s3", ",", "s4"}], "]"}]}], "/.", "rulesinv"}], ")"}]}],
      ")"}], "/.", 
    RowBox[{"y4s", "->", "0"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.912598064257152*^9, 3.9125980728046*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"9fb88810-07fc-49cb-9b70-0b2435066d37"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Full result ", "Subsection",
 CellChangeTimes->{{3.9370464467504854`*^9, 
  3.9370464481716833`*^9}},ExpressionUUID->"25459253-5f6d-42e6-b794-\
cf140a5906c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FourGRstu", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"a1GR4", "[", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}], 
     SubscriptBox["D", 
      RowBox[{"ks", "[", 
       RowBox[{"1", ",", "2"}], "]"}]]], "+", 
    RowBox[{"bGR4", "[", 
     RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}], "+", 
    RowBox[{"cGR4", "[", 
     RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}], "+", 
    FractionBox[
     RowBox[{"a1GR4", "[", 
      RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "]"}], 
     SubscriptBox["D", 
      RowBox[{"ks", "[", 
       RowBox[{"2", ",", "3"}], "]"}]]], "+", 
    RowBox[{"bGR4", "[", 
     RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "]"}], "+", 
    RowBox[{"cGR4", "[", 
     RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "]"}], "+", 
    FractionBox[
     RowBox[{"a1GR4", "[", 
      RowBox[{"2", ",", "4", ",", "3", ",", "1"}], "]"}], 
     SubscriptBox["D", 
      RowBox[{"ks", "[", 
       RowBox[{"2", ",", "4"}], "]"}]]], "+", 
    RowBox[{"bGR4", "[", 
     RowBox[{"2", ",", "4", ",", "3", ",", "1"}], "]"}], "+", 
    RowBox[{"cGR4", "[", 
     RowBox[{"2", ",", "4", ",", "3", ",", "1"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9370464508244896`*^9, 3.937046468099898*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"d5934a69-3f4e-495d-8639-2813cbd3a1a2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["4 point graviton  checks", "Section",
 CellChangeTimes->{{3.9115424004715686`*^9, 3.9115424039805818`*^9}, {
   3.9126224559780397`*^9, 3.9126224594051657`*^9}, {3.918453522214772*^9, 
   3.9184535315251465`*^9}, {3.9370457343269267`*^9, 3.93704574634118*^9}, 
   3.9370464115462418`*^9},ExpressionUUID->"26306dd9-295b-43fc-a116-\
93262a145f3d"],

Cell[CellGroupData[{

Cell["OPE limit", "Subsection",
 CellChangeTimes->{{3.9115432852881145`*^9, 
  3.9115432863536425`*^9}},ExpressionUUID->"aa0852ed-450e-40c8-861a-\
053b52705963"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fn4opecheck", "[", 
   RowBox[{"xz_", ",", "ks12c_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"xz", "/.", " ", 
              RowBox[{
               FractionBox["1", 
                SubscriptBox["D", 
                 RowBox[{"ks", "[", 
                  RowBox[{"x3_", ",", "x4_"}], "]"}]]], ":>", 
               RowBox[{
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{"2", "  ", 
                   RowBox[{"(", 
                    RowBox[{"2", "+", "d", "-", 
                    RowBox[{"2", " ", 
                    RowBox[{"s", "[", 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "x3", "]"}], "<>", 
                    RowBox[{"ToString", "[", "x4", "]"}]}], "]"}], "]"}]}]}], 
                    ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"s", "[", 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "x3", "]"}], "<>", 
                    RowBox[{"ToString", "[", "x4", "]"}]}], "]"}], "]"}]}], 
                    ")"}]}], ")"}]}], "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "/", 
                   RowBox[{"(", 
                    RowBox[{"4", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", "d", "-", 
                    RowBox[{"2", " ", 
                    RowBox[{"s", "[", 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "x3", "]"}], "<>", 
                    RowBox[{"ToString", "[", "x4", "]"}]}], "]"}], "]"}]}]}], 
                    ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "+", "d", "-", 
                    RowBox[{"2", " ", 
                    RowBox[{"s", "[", 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "x3", "]"}], "<>", 
                    RowBox[{"ToString", "[", "x4", "]"}]}], "]"}], "]"}]}]}], 
                    ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    RowBox[{"s", "[", 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "x3", "]"}], "<>", 
                    RowBox[{"ToString", "[", "x4", "]"}]}], "]"}], "]"}]}], 
                    ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"s", "[", 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "x3", "]"}], "<>", 
                    RowBox[{"ToString", "[", "x4", "]"}]}], "]"}], "]"}]}], 
                    ")"}]}], ")"}]}], ")"}], 
                 SuperscriptBox["z1", "2"], 
                 SuperscriptBox[
                  RowBox[{"ks", "[", 
                   RowBox[{"x3", ",", "x4"}], "]"}], "2"]}]}]}]}], "//", 
             RowBox[{"ReplaceAll", "[", 
              RowBox[{
               RowBox[{"s", "[", "p_", "]"}], ":>", 
               RowBox[{
                RowBox[{
                 RowBox[{"s", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "//", "ToString"}], "//", 
                    RowBox[{
                    RowBox[{"StringSplit", "[", 
                    RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}], "//", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "//", 
                   "ToExpression"}], "]"}], "+", 
                 RowBox[{"s", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "//", "ToString"}], "//", 
                    RowBox[{
                    RowBox[{"StringSplit", "[", 
                    RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}], "//", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "//", 
                   "ToExpression"}], "]"}]}], "/;", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{
                   RowBox[{"p", "//", "ToString"}], "//", 
                   RowBox[{
                    RowBox[{"StringSplit", "[", 
                    RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}], "]"}], 
                 ">", "1"}]}]}], "]"}]}], "//", 
            RowBox[{
             RowBox[{"Series", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{"ks12c", ",", "0", ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "]"}], "&"}]}], "//", 
           "Normal"}], "//", "Expand"}], "//", 
         RowBox[{
          RowBox[{"ReplaceAll", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"k", "[", "x_", "]"}], "4"], "->", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"k", "[", "x", "]"}], "2"], 
              SuperscriptBox[
               RowBox[{"kk", "[", "x", "]"}], "2"]}]}]}], "]"}], "&"}]}], "//",
         "scanK2sOnshelllistmap"}], "//", 
       RowBox[{
        RowBox[{"ReplaceAll", "[", 
         RowBox[{"#", ",", 
          RowBox[{"kk", "->", "k"}]}], "]"}], "&"}]}], "//", "Expand"}], "//",
      "scanK2sOnshelllistmap"}], "//", 
    RowBox[{
     RowBox[{"scanMelindeltalistvar", "[", 
      RowBox[{"#", ",", 
       RowBox[{"s", "[", "1", "]"}]}], "]"}], "&"}]}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.912924539620819*^9, 3.912924595031717*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"5bc00976-b487-4316-a59d-1afcc4b66989"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{"a1GR4", "[", 
     RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}], 
    SubscriptBox["D", 
     RowBox[{"ks", "[", 
      RowBox[{"1", ",", "2"}], "]"}]]], "+", 
   RowBox[{"bGR4", "[", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}], "+", 
   RowBox[{"cGR4", "[", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}]}], "//", 
  RowBox[{
   RowBox[{"fn4opecheck", "[", 
    RowBox[{"#", ",", 
     RowBox[{"ks", "[", 
      RowBox[{"1", ",", "2"}], "]"}]}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.9129245650842557`*^9, 3.912924565486328*^9}, {
  3.912924600500176*^9, 3.9129246073918095`*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"ed43715a-c2f9-40d6-9b2b-675700a4f973"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.912924611281523*^9, 3.913117396379657*^9, 
  3.9131372134425583`*^9, 3.913137395791046*^9, 3.913137646139737*^9, 
  3.9131378258040643`*^9, 3.913138087050583*^9, 3.913152906829611*^9, 
  3.914397899099774*^9, 3.914432717713873*^9, 3.915170246759437*^9, 
  3.915293849835281*^9, 3.915747165661957*^9, 3.915900921377233*^9, 
  3.915903701556211*^9, 3.916119577589587*^9, 3.916138267324664*^9, 
  3.916138679495309*^9, 3.916825589931796*^9, 3.91690002884339*^9, 
  3.9169000602552853`*^9, 3.9171752374716063`*^9, 3.9184003711202407`*^9, 
  3.9184535190149803`*^9, 3.9370457529917383`*^9, 3.9370458837644763`*^9, 
  3.9370464878258543`*^9},
 CellLabel->
  "Out[164]=",ExpressionUUID->"de572df4-a3e3-440e-ac33-c7fe52aa155e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{"a1GR4", "[", 
     RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "]"}], 
    SubscriptBox["D", 
     RowBox[{"ks", "[", 
      RowBox[{"2", ",", "3"}], "]"}]]], "+", 
   RowBox[{"bGR4", "[", 
    RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "]"}], "+", 
   RowBox[{"cGR4", "[", 
    RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "]"}]}], "//", 
  RowBox[{
   RowBox[{"fn4opecheck", "[", 
    RowBox[{"#", ",", 
     RowBox[{"ks", "[", 
      RowBox[{"2", ",", "3"}], "]"}]}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.912924641585183*^9, 3.9129246534186277`*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"ae1554fd-4016-4736-8c27-d2c120f68453"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.9129246590045757`*^9, 3.9131174042389956`*^9, 
  3.913137213746559*^9, 3.9131374018462944`*^9, 3.913137646422757*^9, 
  3.913137832030802*^9, 3.91313809096092*^9, 3.913152912004444*^9, 
  3.914397904646208*^9, 3.914432723360169*^9, 3.9151702520324497`*^9, 
  3.91529385518999*^9, 3.91574717113759*^9, 3.915900926686537*^9, 
  3.915903707298794*^9, 3.9161195830886183`*^9, 3.916138272801568*^9, 
  3.916138684992435*^9, 3.916825595439226*^9, 3.916900034200325*^9, 
  3.916900065054294*^9, 3.917175243214045*^9, 3.9184003769532137`*^9, 
  3.9184535220170946`*^9, 3.9370457562608404`*^9, 3.937045886700681*^9, 
  3.9370464908957305`*^9},
 CellLabel->
  "Out[165]=",ExpressionUUID->"7c4a711d-7fde-4b24-8af4-a0c18b8da3d4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{"a1GR4", "[", 
     RowBox[{"2", ",", "4", ",", "3", ",", "1"}], "]"}], 
    SubscriptBox["D", 
     RowBox[{"ks", "[", 
      RowBox[{"2", ",", "4"}], "]"}]]], "+", 
   RowBox[{"bGR4", "[", 
    RowBox[{"2", ",", "4", ",", "3", ",", "1"}], "]"}], "+", 
   RowBox[{"cGR4", "[", 
    RowBox[{"2", ",", "4", ",", "3", ",", "1"}], "]"}]}], "//", 
  RowBox[{
   RowBox[{"fn4opecheck", "[", 
    RowBox[{"#", ",", 
     RowBox[{"ks", "[", 
      RowBox[{"2", ",", "4"}], "]"}]}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.912943914696664*^9, 3.9129439195627394`*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"01cb70be-90a8-4b78-858c-bd60c188860d"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.912943937497924*^9, 3.9131174099634*^9, 
  3.91313721417156*^9, 3.913137406443804*^9, 3.9131376467638483`*^9, 
  3.913137836499301*^9, 3.9131380942208853`*^9, 3.913152916141745*^9, 
  3.914397909019466*^9, 3.914432727894814*^9, 3.915170256265684*^9, 
  3.915293859434122*^9, 3.9157471754870033`*^9, 3.915900930948654*^9, 
  3.915903711894808*^9, 3.916119587620009*^9, 3.916138277237322*^9, 
  3.916138689348407*^9, 3.9168255998379908`*^9, 3.916900038490734*^9, 
  3.916900068945278*^9, 3.917175247778018*^9, 3.918400380774308*^9, 
  3.918453524529657*^9, 3.937045759080185*^9, 3.9370458892271585`*^9, 
  3.937046493783476*^9},
 CellLabel->
  "Out[166]=",ExpressionUUID->"eebc4503-b9eb-440a-ac78-663cdb164c82"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["the soft limit \[Phi]\[Phi]hh Adler zero", "Subsection",
 CellChangeTimes->{{3.911576867609848*^9, 3.9115769158758993`*^9}, {
  3.9184535468942027`*^9, 
  3.9184535511059265`*^9}},ExpressionUUID->"5621e959-9a3d-4724-80e7-\
b4381411cc11"],

Cell[CellGroupData[{

Cell["some soft limit specific function", "Subsubsection",
 CellChangeTimes->{{3.9131166142645597`*^9, 
  3.9131166252041564`*^9}},ExpressionUUID->"df9038d9-3a81-4880-9f17-\
33bd9501ccc7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"softkn", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"ks", "[", 
          RowBox[{"n", ",", 
           RowBox[{"n", "+", "1"}]}], "]"}], "2"], "->", 
        SuperscriptBox[
         RowBox[{"k", "[", 
          RowBox[{"n", "+", "1"}], "]"}], "2"]}], ",", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"ks", "[", 
          RowBox[{"n", ",", 
           RowBox[{"n", "+", "1"}]}], "]"}], "4"], "->", 
        SuperscriptBox[
         RowBox[{"k", "[", 
          RowBox[{"n", "+", "1"}], "]"}], "4"]}], ",", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"ks", "[", 
          RowBox[{"n", ",", 
           RowBox[{"n", "+", "1"}]}], "]"}], 
         RowBox[{"-", "2"}]], "->", 
        SuperscriptBox[
         RowBox[{"k", "[", 
          RowBox[{"n", "+", "1"}], "]"}], 
         RowBox[{"-", "2"}]]}], ",", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"ks", "[", 
          RowBox[{"n", ",", 
           RowBox[{"n", "+", "1"}]}], "]"}], 
         RowBox[{"-", "4"}]], "->", 
        SuperscriptBox[
         RowBox[{"k", "[", 
          RowBox[{"n", "+", "1"}], "]"}], 
         RowBox[{"-", "4"}]]}], ",", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"ks", "[", 
          RowBox[{
           RowBox[{"n", "+", "1"}], ",", 
           RowBox[{"n", "+", "2"}]}], "]"}], "2"], "->", 
        SuperscriptBox[
         RowBox[{"k", "[", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"n", "+", "3"}], ",", "4", ",", "1"}], "]"}], "]"}], 
         "2"]}], ",", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"ks", "[", 
          RowBox[{
           RowBox[{"n", "+", "1"}], ",", 
           RowBox[{"n", "+", "2"}]}], "]"}], "4"], "->", 
        SuperscriptBox[
         RowBox[{"k", "[", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"n", "+", "3"}], ",", "4", ",", "1"}], "]"}], "]"}], 
         "4"]}], ",", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"ks", "[", 
          RowBox[{
           RowBox[{"n", "+", "1"}], ",", 
           RowBox[{"n", "+", "2"}]}], "]"}], 
         RowBox[{"-", "2"}]], "->", 
        SuperscriptBox[
         RowBox[{"k", "[", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"n", "+", "3"}], ",", "4", ",", "1"}], "]"}], "]"}], 
         RowBox[{"-", "2"}]]}], ",", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"ks", "[", 
          RowBox[{
           RowBox[{"n", "+", "1"}], ",", 
           RowBox[{"n", "+", "2"}]}], "]"}], 
         RowBox[{"-", "4"}]], "->", 
        SuperscriptBox[
         RowBox[{"k", "[", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"n", "+", "3"}], ",", "4", ",", "1"}], "]"}], "]"}], 
         RowBox[{"-", "4"}]]}]}], "}"}], "/.", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "n", "]"}], ",", 
        RowBox[{"k", "[", "i_", "]"}]}], "]"}], "->", "0"}]}], "/.", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"k", "[", "n", "]"}], ",", "_"}], "]"}], "->", "0"}]}], "/.", 
   RowBox[{
    RowBox[{"k", "[", "n", "]"}], "->", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.9129254615595274`*^9, 3.912925551805207*^9}, {
  3.9129255862513943`*^9, 3.912925597048168*^9}, {3.9129256760021667`*^9, 
  3.912925755003869*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"889e2fff-26e6-4e44-876f-1397a30feffd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"softknadd", "[", 
   RowBox[{"x_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"x", "/.", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "n", "]"}], ",", 
        RowBox[{"k", "[", "i_", "]"}]}], "]"}], "->", "0"}]}], "/.", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"k", "[", "n", "]"}], ",", "_"}], "]"}], "->", "0"}]}], "/.", 
   RowBox[{
    RowBox[{"k", "[", "n", "]"}], "->", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.9129258182234106`*^9, 3.912925833011453*^9}, 
   3.91292588097512*^9},
 CellLabel->
  "In[168]:=",ExpressionUUID->"0f2d89c4-855e-4640-9e84-a6119913e11d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"softk2t", "[", "p_", "]"}], ":=", 
  RowBox[{"p", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"ks", "[", 
        RowBox[{"2", ",", "3"}], "]"}], "2"], "\[Rule]", 
      SuperscriptBox[
       RowBox[{"k", "[", "3", "]"}], "2"]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"ks", "[", 
        RowBox[{"2", ",", "3"}], "]"}], "4"], "\[Rule]", 
      SuperscriptBox[
       RowBox[{"k", "[", "3", "]"}], "4"]}], ",", 
     RowBox[{
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"ks", "[", 
         RowBox[{"2", ",", "3"}], "]"}], "2"]], "\[Rule]", 
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"k", "[", "3", "]"}], "2"]]}], ",", 
     RowBox[{
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"ks", "[", 
         RowBox[{"2", ",", "3"}], "]"}], "4"]], "\[Rule]", 
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"k", "[", "3", "]"}], "4"]]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"ks", "[", 
        RowBox[{"3", ",", "4"}], "]"}], "2"], "\[Rule]", 
      SuperscriptBox[
       RowBox[{"k", "[", "1", "]"}], "2"]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"ks", "[", 
        RowBox[{"3", ",", "4"}], "]"}], "4"], "\[Rule]", 
      SuperscriptBox[
       RowBox[{"k", "[", "1", "]"}], "4"]}], ",", 
     RowBox[{
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"ks", "[", 
         RowBox[{"3", ",", "4"}], "]"}], "2"]], "\[Rule]", 
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"k", "[", "1", "]"}], "2"]]}], ",", 
     RowBox[{
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"ks", "[", 
         RowBox[{"3", ",", "4"}], "]"}], "4"]], "\[Rule]", 
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"k", "[", "1", "]"}], "4"]]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.912925242642064*^9, 3.9129252708289356`*^9}, {
   3.9129253021346493`*^9, 3.912925335684143*^9}, {3.9131168257288837`*^9, 
   3.9131168274923735`*^9}, 3.913116974101363*^9, 3.91311708359237*^9},
 CellLabel->
  "In[169]:=",ExpressionUUID->"006efc30-f54b-42e9-b06d-c5afbde62dbb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"softk1", "[", "p_", "]"}], ":=", 
  RowBox[{"p", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"ks", "[", 
        RowBox[{"1", ",", "2"}], "]"}], "2"], "\[Rule]", 
      SuperscriptBox[
       RowBox[{"k", "[", "2", "]"}], "2"]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"ks", "[", 
        RowBox[{"1", ",", "2"}], "]"}], "4"], "\[Rule]", 
      SuperscriptBox[
       RowBox[{"k", "[", "2", "]"}], "4"]}], ",", 
     RowBox[{
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"ks", "[", 
         RowBox[{"1", ",", "2"}], "]"}], "2"]], "\[Rule]", 
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"k", "[", "2", "]"}], "2"]]}], ",", 
     RowBox[{
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"ks", "[", 
         RowBox[{"1", ",", "2"}], "]"}], "4"]], "\[Rule]", 
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"k", "[", "2", "]"}], "4"]]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"ks", "[", 
        RowBox[{"2", ",", "3"}], "]"}], "2"], "\[Rule]", 
      SuperscriptBox[
       RowBox[{"k", "[", "4", "]"}], "2"]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"ks", "[", 
        RowBox[{"2", ",", "3"}], "]"}], "4"], "\[Rule]", 
      SuperscriptBox[
       RowBox[{"k", "[", "4", "]"}], "4"]}], ",", 
     RowBox[{
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"ks", "[", 
         RowBox[{"2", ",", "3"}], "]"}], "2"]], "\[Rule]", 
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"k", "[", "4", "]"}], "2"]]}], ",", 
     RowBox[{
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"ks", "[", 
         RowBox[{"2", ",", "3"}], "]"}], "4"]], "\[Rule]", 
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"k", "[", "4", "]"}], "4"]]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.9129256620852437`*^9, 3.9129256650366387`*^9}, 
   3.9131169984838476`*^9, 3.9131384097212515`*^9},
 CellLabel->
  "In[170]:=",ExpressionUUID->"a6c4cf75-2fa9-443d-8461-c4716c11f046"],

Cell[BoxData[
 RowBox[{
  RowBox[{"softknadd", "[", 
   RowBox[{"x_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"x", "/.", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "n", "]"}], ",", 
          RowBox[{"k", "[", "i_", "]"}]}], "]"}], "->", "0"}]}], "/.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"k", "[", "n", "]"}], ",", "_"}], "]"}], "->", "0"}]}], "/.", 
     RowBox[{
      RowBox[{"k", "[", "n", "]"}], "->", "0"}]}], "/.", 
    RowBox[{
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "i_", "]"}]}], "]"}], "/;", 
      RowBox[{"Not", "[", 
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", "i"}], "]"}], "]"}]}], "->", "0"}]}], "/.", 
   RowBox[{
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "i_", "]"}]}], "]"}], "/;", 
     RowBox[{"Not", "[", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", "2", "}"}], ",", "i"}], "]"}], "]"}]}], "->", 
    "0"}]}]}]], "Input",
 CellChangeTimes->{{3.9131375049266033`*^9, 3.9131375122156196`*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"427a89c1-3736-4774-9a22-72215012ca42"],

Cell[BoxData[
 RowBox[{
  RowBox[{"softk2u", "[", "p_", "]"}], ":=", 
  RowBox[{
   RowBox[{"p", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"ks", "[", 
         RowBox[{"2", ",", "4"}], "]"}], "2"], "->", 
       SuperscriptBox[
        RowBox[{"k", "[", "4", "]"}], "2"]}], ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"ks", "[", 
         RowBox[{"2", ",", "4"}], "]"}], "4"], "->", 
       SuperscriptBox[
        RowBox[{"k", "[", "4", "]"}], "4"]}], ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"ks", "[", 
         RowBox[{"2", ",", "4"}], "]"}], 
        RowBox[{"-", "2"}]], "->", 
       SuperscriptBox[
        RowBox[{"k", "[", "4", "]"}], 
        RowBox[{"-", "2"}]]}], ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"ks", "[", 
         RowBox[{"2", ",", "4"}], "]"}], 
        RowBox[{"-", "4"}]], "->", 
       SuperscriptBox[
        RowBox[{"k", "[", "4", "]"}], 
        RowBox[{"-", "4"}]]}]}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"ks", "[", 
        RowBox[{"4", ",", "3"}], "]"}], "2"], "->", 
      SuperscriptBox[
       RowBox[{"k", "[", "1", "]"}], "2"]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"ks", "[", 
        RowBox[{"4", ",", "3"}], "]"}], "4"], "->", 
      SuperscriptBox[
       RowBox[{"k", "[", "1", "]"}], "4"]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"ks", "[", 
        RowBox[{"4", ",", "3"}], "]"}], 
       RowBox[{"-", "2"}]], "->", 
      SuperscriptBox[
       RowBox[{"k", "[", "1", "]"}], 
       RowBox[{"-", "2"}]]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"ks", "[", 
        RowBox[{"4", ",", "3"}], "]"}], 
       RowBox[{"-", "4"}]], "->", 
      SuperscriptBox[
       RowBox[{"k", "[", "1", "]"}], 
       RowBox[{"-", "4"}]]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.9129437478649817`*^9, 3.9129437704847975`*^9}, {
  3.9129438027074327`*^9, 3.912943818921424*^9}, {3.9131170370242343`*^9, 
  3.913117041507665*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"43c40cda-64fb-4bc2-948c-14cf80b75e7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"softcheck", "[", 
   RowBox[{
   "xc_", ",", "s1_", ",", "s2_", ",", "softk1n_", ",", "n_", ",", "cd_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"xc", "/.", 
                   RowBox[{"y4s", "->", "0"}]}], "//", "softk1n"}], "//", 
                 RowBox[{
                  RowBox[{"softknadd", "[", 
                   RowBox[{"#", ",", "n"}], "]"}], "&"}]}], "//", 
                RowBox[{
                 RowBox[{"whatis", "[", 
                  RowBox[{"#", ",", "s1", ",", "d"}], "]"}], "&"}]}], "//", 
               "Expand"}], "//", "Simplify"}], "//", 
             "ToShortestHelicityBasis4"}], "//", 
            RowBox[{
             RowBox[{"softknadd", "[", 
              RowBox[{"#", ",", "n"}], "]"}], "&"}]}], "//", "Expand"}], "//",
           "scanK2sOnshelllistmap"}], "//", "Expand"}], "//", 
        RowBox[{
         RowBox[{"AllOnshellinvlist", "[", 
          RowBox[{"#", ",", "cd", ",", "z1"}], "]"}], "&"}]}], "//", 
       "Simplify"}], "//", 
      RowBox[{
       RowBox[{"scanMelindeltalistvar", "[", 
        RowBox[{"#", ",", "s2"}], "]"}], "&"}]}], "//", 
     RowBox[{
      RowBox[{"whatis", "[", 
       RowBox[{"#", ",", "s1", ",", "d"}], "]"}], "&"}]}], "//", "Simplify"}],
    "//", 
   RowBox[{
    RowBox[{"softknadd", "[", 
     RowBox[{"#", ",", "n"}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.9129250971899023`*^9, 3.9129251181919365`*^9}, {
   3.912925162064728*^9, 3.912925168414259*^9}, 3.9129253407687535`*^9, {
   3.9129256418424826`*^9, 3.912925643773305*^9}, {3.9129258932849727`*^9, 
   3.912925907217516*^9}, 3.9129259856298676`*^9, 3.9131170226182537`*^9, {
   3.913117198356823*^9, 3.9131172072658167`*^9}, {3.913122941064061*^9, 
   3.913122945559018*^9}, 3.913122975951892*^9, 3.9131374650376453`*^9, {
   3.9131382921070633`*^9, 3.913138306607241*^9}, {3.913138451463024*^9, 
   3.9131384534417715`*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"36774e27-0a16-4710-b099-21e84f72d391"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{"a1GR4", "[", 
     RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}], 
    SubscriptBox["D", 
     RowBox[{"ks", "[", 
      RowBox[{"1", ",", "2"}], "]"}]]], "+", 
   RowBox[{"bGR4", "[", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}], "+", 
   RowBox[{"cGR4", "[", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}]}], "//", 
  RowBox[{
   RowBox[{"softcheck", "[", 
    RowBox[{"#", ",", 
     RowBox[{"s", "[", "1", "]"}], ",", 
     RowBox[{"s", "[", "2", "]"}], ",", "softk1", ",", "1", ",", "2"}], "]"}],
    "&"}]}]], "Input",
 CellChangeTimes->{{3.912925131254981*^9, 3.912925137587053*^9}, {
   3.913116747513455*^9, 3.913116793512824*^9}, {3.9131172109469967`*^9, 
   3.9131172120155425`*^9}, 3.9131383664751616`*^9, 3.913138439854786*^9},
 CellLabel->
  "In[174]:=",ExpressionUUID->"08c20647-5033-41e5-be7f-1ebcf6366efd"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.9131167962989492`*^9, {3.9131170107759933`*^9, 3.9131170268697844`*^9}, 
   3.913117098886978*^9, 3.913117156414614*^9, 3.9131172177103243`*^9, 
   3.9131174129339237`*^9, {3.913122951516057*^9, 3.9131229810798035`*^9}, 
   3.9131372146608086`*^9, 3.913137409935907*^9, 3.9131374730032644`*^9, 
   3.9131375164411545`*^9, 3.913137648422491*^9, 3.9131378374203014`*^9, 
   3.91313809499189*^9, 3.913138309568816*^9, 3.913138367426875*^9, {
   3.913138413476713*^9, 3.913138456837737*^9}, 3.913152916669718*^9, 
   3.914397909576335*^9, 3.914432728246752*^9, 3.9151702567979927`*^9, 
   3.915293859966473*^9, 3.915747176135747*^9, 3.915900931446327*^9, 
   3.915903712401058*^9, 3.916119588066842*^9, 3.916138277679119*^9, 
   3.916138689799926*^9, 3.916825600311687*^9, 3.9169000389795732`*^9, 
   3.916900069146017*^9, 3.917175248263276*^9, 3.9184003828174195`*^9, 
   3.918453539182627*^9, 3.9370457597841253`*^9, 3.937045889852973*^9, 
   3.9370464944112434`*^9},
 CellLabel->
  "Out[174]=",ExpressionUUID->"0c72da03-6728-479b-8084-6be42482f630"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{"a1GR4", "[", 
     RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "]"}], 
    SubscriptBox["D", 
     RowBox[{"ks", "[", 
      RowBox[{"2", ",", "3"}], "]"}]]], "+", 
   RowBox[{"bGR4", "[", 
    RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "]"}], "+", 
   RowBox[{"cGR4", "[", 
    RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "]"}]}], "//", 
  RowBox[{
   RowBox[{"softcheck", "[", 
    RowBox[{"#", ",", 
     RowBox[{"s", "[", "2", "]"}], ",", 
     RowBox[{"s", "[", "3", "]"}], ",", "softk2t", ",", "2", ",", "3"}], 
    "]"}], "&"}]}]], "Input",
 CellChangeTimes->{
  3.9131168072525434`*^9, {3.913117057579727*^9, 3.9131170595146637`*^9}, {
   3.9131171059360075`*^9, 3.9131171069103155`*^9}, {3.913117213885783*^9, 
   3.9131172145270147`*^9}},
 CellLabel->
  "In[175]:=",ExpressionUUID->"c8723c9f-9a9a-43f5-b8eb-a92eeea3d5f1"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.9131170617834845`*^9, {3.913117101855088*^9, 3.913117109829623*^9}, 
   3.9131171578989434`*^9, 3.9131172199557114`*^9, 3.9131174155029984`*^9, 
   3.9131372150499125`*^9, 3.913137412531581*^9, 3.913137648685491*^9, 
   3.913137837707302*^9, 3.9131380953668957`*^9, 3.913138492769899*^9, 
   3.9131529167404423`*^9, 3.914397909622789*^9, 3.914432728331081*^9, 
   3.915170256858638*^9, 3.915293860027088*^9, 3.9157471761947727`*^9, 
   3.915900931507372*^9, 3.9159037124598837`*^9, 3.91611958809588*^9, 
   3.91613827771316*^9, 3.9161386898347273`*^9, 3.916825600369205*^9, 
   3.9169000390191107`*^9, 3.916900069185728*^9, 3.917175248314191*^9, 
   3.9184003837506924`*^9, 3.9184535394186525`*^9, 3.937045760064451*^9, 
   3.937045890120983*^9, 3.937046494687441*^9},
 CellLabel->
  "Out[175]=",ExpressionUUID->"58a5ded2-8a57-40b5-94a0-a7db93666fc8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{"a1GR4", "[", 
     RowBox[{"2", ",", "4", ",", "3", ",", "1"}], "]"}], 
    SubscriptBox["D", 
     RowBox[{"ks", "[", 
      RowBox[{"2", ",", "4"}], "]"}]]], "+", 
   RowBox[{"bGR4", "[", 
    RowBox[{"2", ",", "4", ",", "3", ",", "1"}], "]"}], "+", 
   RowBox[{"cGR4", "[", 
    RowBox[{"2", ",", "4", ",", "3", ",", "1"}], "]"}]}], "//", 
  RowBox[{
   RowBox[{"softcheck", "[", 
    RowBox[{"#", ",", 
     RowBox[{"s", "[", "2", "]"}], ",", 
     RowBox[{"s", "[", "4", "]"}], ",", "softk2u", ",", "2", ",", "4"}], 
    "]"}], "&"}]}]], "Input",
 CellChangeTimes->{
  3.913117230329497*^9, {3.9131173083700485`*^9, 3.913117315866193*^9}, 
   3.9131173533384604`*^9},
 CellLabel->
  "In[176]:=",ExpressionUUID->"50b95f8e-ebb4-4e8d-b359-150f5fe30c51"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.913117356671457*^9, 3.913117418198348*^9, 
  3.913137215383914*^9, 3.91313741593263*^9, 3.9131376489824915`*^9, 
  3.9131378380513067`*^9, 3.913138095721868*^9, 3.9131384941757793`*^9, 
  3.913152916812335*^9, 3.914397909697151*^9, 3.914432728413508*^9, 
  3.915170256926889*^9, 3.91529386008792*^9, 3.915747176284438*^9, 
  3.915900931568486*^9, 3.9159037125187683`*^9, 3.916119588126246*^9, 
  3.916138277744072*^9, 3.916138689866932*^9, 3.916825600411213*^9, 
  3.916900039064328*^9, 3.916900069257607*^9, 3.917175248361958*^9, 
  3.918400384526436*^9, 3.9184535397589254`*^9, 3.9370457604066043`*^9, 
  3.9370458903896613`*^9, 3.93704649493544*^9},
 CellLabel->
  "Out[176]=",ExpressionUUID->"45a99165-6a12-4c8b-b680-612effa9877b"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["flat space limit of AdS 4 Graviton amplitudes", "Subsection",
 CellChangeTimes->{{3.9116692942190886`*^9, 
  3.9116693065169325`*^9}},ExpressionUUID->"b4272ebe-f913-479f-9b91-\
e29d58ac630d"],

Cell[CellGroupData[{

Cell["flatspace full (just run)", "Subsubsection",
 CellChangeTimes->{{3.912839425995014*^9, 3.912839429064822*^9}, {
  3.912839462867282*^9, 
  3.9128394690199385`*^9}},ExpressionUUID->"30a96259-39b9-42bf-9b64-\
94a356812c6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VYMijk", "[", 
   RowBox[{"k1_", ",", "k2_", ",", "k3_", ",", "i_", ",", "j_", ",", "k_"}], 
   "]"}], ":=", 
  RowBox[{
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "i", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k1", ",", 
          RowBox[{"\[Mu]", "[", "k", "]"}]}], "]"}], "-", 
        RowBox[{"sc", "[", 
         RowBox[{"k2", ",", 
          RowBox[{"\[Mu]", "[", "k", "]"}]}], "]"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "j", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "k", "]"}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k2", ",", 
          RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}], "-", 
        RowBox[{"sc", "[", 
         RowBox[{"k3", ",", 
          RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "k", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k3", ",", 
          RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}], "-", 
        RowBox[{"sc", "[", 
         RowBox[{"k1", ",", 
          RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}]}], ")"}]}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.9113251611707892`*^9, 3.911325164847571*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"572b2102-6dc2-4fd0-b0de-020b84ab2db9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"VYMijk", "[", 
       RowBox[{"k1", ",", "k2", ",", 
        RowBox[{"-", "k12"}], ",", "e1", ",", "e2", ",", "k"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"-", "a_"}], ",", 
         RowBox[{"\[Mu]", "[", "b_", "]"}]}], "]"}], ":>", 
       RowBox[{"-", 
        RowBox[{"sc", "[", 
         RowBox[{"a", ",", 
          RowBox[{"\[Mu]", "[", "b", "]"}]}], "]"}]}]}]}], "/.", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{"k12", ",", 
        RowBox[{"\[Mu]", "[", "a_", "]"}]}], "]"}], ":>", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}], "+", 
       RowBox[{"sc", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}]}]}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"VYMijk", "[", 
       RowBox[{
        RowBox[{"-", "k34"}], ",", "k3", ",", "k4", ",", "p", ",", "e3", ",", 
        "e4"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"-", "a_"}], ",", 
         RowBox[{"\[Mu]", "[", "b_", "]"}]}], "]"}], ":>", 
       RowBox[{"-", 
        RowBox[{"sc", "[", 
         RowBox[{"a", ",", 
          RowBox[{"\[Mu]", "[", "b", "]"}]}], "]"}]}]}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k12", ",", 
          RowBox[{"\[Mu]", "[", "a_", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"k1", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}], "+", 
         RowBox[{"sc", "[", 
          RowBox[{"k2", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k34", ",", 
          RowBox[{"\[Mu]", "[", "a_", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"k3", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}], "+", 
         RowBox[{"sc", "[", 
          RowBox[{"k4", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}]}]}]}], "}"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"contract", "[", 
    RowBox[{
     RowBox[{"%", " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "k", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "p", "]"}]}], "]"}]}], ",", "d"}], "]"}], "//", 
   "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"YM4pt1", "=", 
  RowBox[{
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"k3", ",", 
         RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"k4", ",", 
         RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], "->", "0"}]}], "}"}]}], "//",
    "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.8942681950030203`*^9, 3.8942682035242105`*^9}, {
  3.8942682621632986`*^9, 3.894268263363967*^9}, {3.894268321452218*^9, 
  3.8942683290185423`*^9}, {3.894268367108331*^9, 3.8942683815841303`*^9}, {
  3.894268598034874*^9, 3.894268601467407*^9}, {3.894268643459319*^9, 
  3.8942686611708384`*^9}, {3.894268697603653*^9, 3.894268698799119*^9}, {
  3.894268791788171*^9, 3.894268836483612*^9}, {3.89426943032482*^9, 
  3.894269438195872*^9}, {3.894352715929925*^9, 3.894352723994129*^9}, {
  3.894352769994816*^9, 3.8943527763634305`*^9}, {3.8951274830585814`*^9, 
  3.8951274848980317`*^9}, {3.8965227464758186`*^9, 3.896522771864021*^9}, {
  3.8965233087473803`*^9, 3.8965233526867065`*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"8e568803-baec-40a4-b470-35fe89b19c3d"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k1", ",", 
       RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k3", ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k2", ",", 
       RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k3", ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k1", ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k4", ",", 
       RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k2", ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k4", ",", 
       RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k1", ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k3", ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}]}], "-", 
    RowBox[{"4", " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k1", ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k4", ",", 
       RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}], "-", 
    RowBox[{"4", " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k2", ",", 
       RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k3", ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e2", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k2", ",", 
       RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k4", ",", 
       RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e2", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k1", ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k3", ",", 
       RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e3", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k2", ",", 
       RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k3", ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e3", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k1", ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k4", ",", 
       RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e3", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k2", ",", 
       RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k4", ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e3", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{"k1", ",", "k3"}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e3", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{"k1", ",", "k4"}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e3", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{"k2", ",", "k3"}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e3", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{"k2", ",", "k4"}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e3", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.89426833045604*^9, 3.894268371046877*^9, {3.894268661561823*^9, 
   3.8942686996195145`*^9}, 3.8942688371224117`*^9, 3.894269438834528*^9, 
   3.894352779859576*^9, 3.8951272427157726`*^9, 3.895127485468483*^9, 
   3.895658821071148*^9, {3.8965227478454227`*^9, 3.896522776329074*^9}, 
   3.8965233533922596`*^9, 3.89738433172618*^9, 3.8974695598896427`*^9, 
   3.9083829618397436`*^9, 3.911325188476859*^9, 3.911637161489937*^9, 
   3.9128394323070097`*^9, 3.912928628333786*^9, 3.9131182492477727`*^9, 
   3.913119234586527*^9, 3.9131372158709188`*^9, 3.9131374163477097`*^9, 
   3.9131380961698737`*^9, 3.913152916999659*^9, 3.9143979098870792`*^9, 
   3.9144327285661163`*^9, 3.915170257065488*^9, 3.915293860221026*^9, 
   3.915747176434773*^9, 3.9159009316975183`*^9, 3.915903712654537*^9, 
   3.91611958823878*^9, 3.916138277842353*^9, 3.916138689967122*^9, 
   3.916825600524976*^9, 3.916900039194952*^9, 3.91690006932856*^9, 
   3.917175248479714*^9, 3.9184003853398404`*^9, 3.918453562455579*^9, 
   3.9370457608544397`*^9, 3.937045890752676*^9, 3.9370464954016333`*^9},
 CellLabel->
  "Out[180]=",ExpressionUUID->"c49e9778-a2cd-4655-9c2f-662c16c8aa59"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"sc", "[", 
    RowBox[{"k1", ",", "k2"}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "e2", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "e2", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"YM4pt2", "=", 
  RowBox[{
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"k3", ",", 
         RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"k4", ",", 
         RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], "->", "0"}]}], "}"}]}], "//",
    "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.896523547678892*^9, 3.896523633134882*^9}, {
   3.896525198082403*^9, 3.8965252020127926`*^9}, 3.9113251999325128`*^9, {
   3.9113252757684536`*^9, 3.9113252897105656`*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"d067a825-8fa3-404f-8b07-ba277e4debd4"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"sc", "[", 
   RowBox[{"k1", ",", "k2"}], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e2", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e2", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.8965236341742773`*^9, 3.8965252026182823`*^9, 3.897384336865507*^9, 
   3.8974695645340085`*^9, 3.9083829653005123`*^9, 3.911325202447994*^9, {
   3.9113252764669857`*^9, 3.911325290098585*^9}, 3.9116371668215237`*^9, 
   3.912839449086254*^9, 3.9129286284658823`*^9, 3.913118249585534*^9, 
   3.913119234935859*^9, 3.9131372162179155`*^9, 3.91313741665763*^9, 
   3.9131380964958696`*^9, 3.913152917045082*^9, 3.914397909939114*^9, 
   3.91443272862241*^9, 3.915170257123376*^9, 3.915293860283461*^9, 
   3.915747176498303*^9, 3.915900931757333*^9, 3.915903712717169*^9, 
   3.91611958827429*^9, 3.916138277869432*^9, 3.916138689998743*^9, 
   3.916825600568913*^9, 3.916900039232976*^9, 3.9169000693641777`*^9, 
   3.917175248528659*^9, 3.9184003860966825`*^9, 3.9184535626186037`*^9, 
   3.937045761158744*^9, 3.937045891023667*^9, 3.937046495633547*^9},
 CellLabel->
  "Out[182]=",ExpressionUUID->"6bdc2a1f-bada-4e7e-a380-e2bdf8793de0"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ns", "=", 
   RowBox[{
    RowBox[{"YM4pt1", "-", "YM4pt2"}], "//", "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.896523645193081*^9, 3.8965236483530645`*^9}, {
   3.896523732662918*^9, 3.8965237469140396`*^9}, {3.896524164749451*^9, 
   3.896524164898308*^9}, 3.896524753817893*^9, 3.896525200456482*^9},
 CellLabel->
  "In[183]:=",ExpressionUUID->"f272db37-ffc8-4ae7-8d91-15645f399894"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nt", "=", 
   RowBox[{"(", 
    RowBox[{"ns", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"e1", "->", "e2"}], ",", 
       RowBox[{"e2", "->", "e3"}], ",", 
       RowBox[{"e3", "->", "e4"}], ",", 
       RowBox[{"e4", "->", "e1"}], ",", 
       RowBox[{"k1", "->", "k2"}], ",", 
       RowBox[{"k2", "->", "k3"}], ",", 
       RowBox[{"k3", "->", "k4"}], ",", 
       RowBox[{"k4", "->", "k1"}]}], "}"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nu", "=", 
   RowBox[{"(", 
    RowBox[{"ns", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"e2", "->", "e3"}], ",", 
       RowBox[{"e3", "->", "e4"}], ",", 
       RowBox[{"e4", "->", "e2"}], ",", 
       RowBox[{"k2", "->", "k3"}], ",", 
       RowBox[{"k3", "->", "k4"}], ",", 
       RowBox[{"k4", "->", "k2"}]}], "}"}]}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8965237499484053`*^9, 3.896523763750085*^9}, {
  3.8965238230871058`*^9, 3.896523935697094*^9}, {3.9128757603919945`*^9, 
  3.9128757897289114`*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"b770f8bb-be9b-4d7f-8ff4-068316355687"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ns", "-", "nt", "+", "nu"}], "//", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"%", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{"k1", ",", 
             RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], "->", "0"}], ",", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{"a_", ",", "a_"}], "]"}], ":>", "0"}]}], "}"}]}], "/.", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k1", ",", "a_"}], "]"}], ":>", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"sc", "[", 
           RowBox[{"k2", ",", "a"}], "]"}]}], "-", 
         RowBox[{"sc", "[", 
          RowBox[{"k3", ",", "a"}], "]"}], "-", 
         RowBox[{"sc", "[", 
          RowBox[{"k4", ",", "a"}], "]"}]}]}]}], "/.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"a_", ",", "a_"}], "]"}], ":>", "0"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k1", ",", 
          RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k2", ",", 
          RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k3", ",", 
          RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k4", ",", 
          RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], "->", "0"}]}], "}"}]}], 
    "/.", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{"k2", ",", "a_"}], "]"}], ":>", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"sc", "[", 
        RowBox[{"k1", ",", "a"}], "]"}]}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{"k3", ",", "a"}], "]"}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{"k4", ",", "a"}], "]"}]}]}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{"k1", ",", 
        RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], "->", "0"}], ",", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{"a_", ",", "a_"}], "]"}], ":>", "0"}]}], "}"}]}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.896523938826205*^9, 3.896523996523876*^9}, {
   3.896524374487586*^9, 3.896524409186573*^9}, {3.896524769613826*^9, 
   3.8965248104055605`*^9}, {3.8965248630814757`*^9, 
   3.8965248722838955`*^9}, {3.8973843465435963`*^9, 
   3.8973843488096037`*^9}, {3.897384382874075*^9, 3.897384406891576*^9}, 
   3.912875805124318*^9},
 CellLabel->
  "In[186]:=",ExpressionUUID->"9ac1d8f6-9a1d-4141-a237-165361dd3495"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{"k1", ",", "k3"}], "]"}], "+", 
    RowBox[{"sc", "[", 
     RowBox[{"k1", ",", "k4"}], "]"}], "+", 
    RowBox[{"sc", "[", 
     RowBox[{"k3", ",", "k4"}], "]"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e2", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e3", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.8965239450750866`*^9, 3.8965239973899612`*^9, 3.896524171056017*^9, 
   3.896524409500586*^9, {3.8965247593781037`*^9, 3.896524812284218*^9}, 
   3.89652487334451*^9, 3.8965252109364457`*^9, 3.897384350318241*^9, {
   3.8973843922661495`*^9, 3.8973844074254646`*^9}, 3.908382971367154*^9, 
   3.9113252361097965`*^9, {3.9113252850482416`*^9, 3.911325295770754*^9}, 
   3.911637172827697*^9, 3.912839453909849*^9, {3.9128758021891556`*^9, 
   3.9128758063091574`*^9}, 3.9129286293258824`*^9, 3.9131182513071346`*^9, 
   3.913119235461589*^9, 3.913137217294918*^9, 3.913137417064646*^9, 
   3.91313809755789*^9, 3.913152917714625*^9, 3.9143979105878067`*^9, 
   3.91443272874119*^9, 3.91517025777052*^9, 3.9152938609115257`*^9, 
   3.915747177162827*^9, 3.9159009323664713`*^9, 3.915903713345717*^9, 
   3.9161195889243107`*^9, 3.916138278460102*^9, 3.916138690595055*^9, 
   3.9168256011751537`*^9, {3.916900039851735*^9, 3.9169000694652233`*^9}, 
   3.917175249158403*^9, 3.9184003877428007`*^9, 3.9184535633484707`*^9, 
   3.9370457620772886`*^9, 3.937045891721319*^9, 3.937046496401846*^9},
 CellLabel->
  "Out[187]=",ExpressionUUID->"aa296e58-c0b4-413e-9a26-07da873b28f6"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["flat space limit initialize (just run)", "Subsubsection",
 CellChangeTimes->{{3.911669629684531*^9, 
  3.911669641661518*^9}},ExpressionUUID->"41532947-f011-4591-99b8-\
bfbeb4d355da"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GRns", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               FractionBox[
                SuperscriptBox["ns", "2"], 
                RowBox[{"2", 
                 RowBox[{"S", "[", 
                  RowBox[{"1", ",", "2"}], "]"}]}]], "/.", "rulesinv"}], "/.", 
              RowBox[{
               RowBox[{"\[Mu]", "[", 
                RowBox[{"e", "[", "x_", "]"}], "]"}], "->", 
               RowBox[{"e", "[", "x", "]"}]}]}], "/.", 
             RowBox[{
              RowBox[{"s", "[", "i_", "]"}], "\[RuleDelayed]", 
              FractionBox[
               RowBox[{"z1", " ", 
                RowBox[{"k", "[", "i", "]"}]}], "2"]}]}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"k", "[", "i_", "]"}], ",", 
                 RowBox[{"k", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"kk", "[", "i", "]"}], ",", 
                 RowBox[{"kk", "[", "j", "]"}]}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"e", "[", "i_", "]"}], ",", 
                 RowBox[{"k", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"e", "[", "i", "]"}], ",", 
                 RowBox[{"kk", "[", "j", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
           RowBox[{
            RowBox[{"k", "[", "4", "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"k", "[", "1", "]"}]}], "-", 
             RowBox[{"k", "[", "2", "]"}], "-", 
             RowBox[{"k", "[", "3", "]"}]}]}]}], "/.", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"kk", "[", "i_", "]"}], ",", 
             RowBox[{"kk", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
           RowBox[{"S", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{"3", ",", "4"}], "]"}], "->", 
          RowBox[{"S", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"1", ",", "4"}], "]"}], "->", 
         RowBox[{"S", "[", 
          RowBox[{"2", ",", "3"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{"S", "[", 
         RowBox[{"1", ",", "3"}], "]"}], "->", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"S", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}], "-", 
         RowBox[{"S", "[", 
          RowBox[{"2", ",", "3"}], "]"}]}]}]}], "/.", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "4"}], "]"}], "->", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"S", "[", 
          RowBox[{"1", ",", "2"}], "]"}]}], "-", 
        RowBox[{"S", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}]}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"+", 
        RowBox[{"k", "[", "i", "]"}]}], 
       RowBox[{"k", "[", "j", "]"}]}], "*)"}], "//", "Expand"}], "//", 
    "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{3.911669389622587*^9, 3.9129291088608923`*^9},
 CellLabel->
  "In[188]:=",ExpressionUUID->"b4d2b61e-7ec1-4efc-aa44-70d1d4946dab"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"GRflat", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["z1", "2"], "GRns"}], "/.", 
           RowBox[{"kk", "->", "k"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "i_", "]"}], ",", 
              RowBox[{"k", "[", "1", "]"}]}], "]"}], ":>", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "-", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i", "]"}], ",", 
               RowBox[{"k", "[", "3", "]"}]}], "]"}], "-", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i", "]"}], ",", 
               RowBox[{"k", "[", "4", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"k", "[", "i_", "]"}], ",", 
            RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i_", "]"}], ",", 
           RowBox[{"k", "[", "4", "]"}]}], "]"}], ":>", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "i", "]"}], ",", 
             RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "-", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], ",", 
            RowBox[{"k", "[", "3", "]"}]}], "]"}], "-", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], ",", 
            RowBox[{"k", "[", "1", "]"}]}], "]"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "i_", "]"}], ",", 
          RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", 
      RowBox[{"k", "->", "kk"}]}], "//", "Simplify"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", 
  RowBox[{
   RowBox[{"FreeQ", "[", 
    RowBox[{"#", ",", 
     RowBox[{"kk", "[", "4", "]"}]}], "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{3.912929033907002*^9},
 CellLabel->
  "In[189]:=",ExpressionUUID->"36c02589-048c-4c35-b8b4-51eeca45e812"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.911667710916993*^9, 3.9116680060396557`*^9, 3.9116681094694347`*^9, 
   3.911668139668657*^9, 3.911669241933899*^9, 3.911669358682846*^9, 
   3.9116693930262213`*^9, 3.911669440125927*^9, 3.9116697161023684`*^9, 
   3.9117154745416775`*^9, 3.9117440052148438`*^9, 3.911801596494048*^9, 
   3.911804945911009*^9, 3.911835227434885*^9, 3.9119750144395466`*^9, 
   3.912065035326528*^9, 3.912065633300026*^9, 3.9120658412595825`*^9, 
   3.912165539957532*^9, 3.9126228143488293`*^9, 3.9126629614739037`*^9, 
   3.9126729210626945`*^9, 3.9129233560296183`*^9, 3.912929036653801*^9, 
   3.912929110873294*^9, 3.9131192580022116`*^9, 3.913137217756054*^9, 
   3.9131374174666386`*^9, 3.913138097975889*^9, 3.913152917961049*^9, 
   3.914397910794743*^9, 3.914432728809371*^9, 3.915170257998282*^9, 
   3.915293861105143*^9, 3.915747177292952*^9, 3.915900932541016*^9, 
   3.915903713519311*^9, 3.916119589068309*^9, 3.9161382786061993`*^9, 
   3.916138690739744*^9, 3.9168256013385897`*^9, {3.9169000400060787`*^9, 
   3.916900069523497*^9}, 3.917175249332613*^9, 3.918400388645152*^9, 
   3.9184535723341665`*^9, 3.9370457625304394`*^9, 3.9370458920963173`*^9, 
   3.9370464967855186`*^9},
 CellLabel->
  "Out[190]=",ExpressionUUID->"1a752abb-340c-4afc-ae06-6c29224fab93"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"GRnt", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               FractionBox[
                SuperscriptBox["nt", "2"], 
                RowBox[{"2", " ", 
                 RowBox[{"S", "[", 
                  RowBox[{"2", ",", "3"}], "]"}]}]], "/.", "rulesinv"}], "/.", 
              RowBox[{
               RowBox[{"\[Mu]", "[", 
                RowBox[{"e", "[", "x_", "]"}], "]"}], "->", 
               RowBox[{"e", "[", "x", "]"}]}]}], "/.", 
             RowBox[{
              RowBox[{"s", "[", "i_", "]"}], "\[RuleDelayed]", 
              FractionBox[
               RowBox[{"z1", " ", 
                RowBox[{"k", "[", "i", "]"}]}], "2"]}]}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"k", "[", "i_", "]"}], ",", 
                 RowBox[{"k", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"kk", "[", "i", "]"}], ",", 
                 RowBox[{"kk", "[", "j", "]"}]}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"e", "[", "i_", "]"}], ",", 
                 RowBox[{"k", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"e", "[", "i", "]"}], ",", 
                 RowBox[{"kk", "[", "j", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
           RowBox[{
            RowBox[{"k", "[", "4", "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"k", "[", "1", "]"}]}], "-", 
             RowBox[{"k", "[", "2", "]"}], "-", 
             RowBox[{"k", "[", "3", "]"}]}]}]}], "/.", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"kk", "[", "i_", "]"}], ",", 
             RowBox[{"kk", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
           RowBox[{"S", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{"3", ",", "4"}], "]"}], "->", 
          RowBox[{"S", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"1", ",", "4"}], "]"}], "->", 
         RowBox[{"S", "[", 
          RowBox[{"2", ",", "3"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{"S", "[", 
         RowBox[{"1", ",", "3"}], "]"}], "->", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"S", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}], "-", 
         RowBox[{"S", "[", 
          RowBox[{"2", ",", "3"}], "]"}]}]}]}], "/.", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "4"}], "]"}], "->", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"S", "[", 
          RowBox[{"1", ",", "2"}], "]"}]}], "-", 
        RowBox[{"S", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}]}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"+", 
        RowBox[{"k", "[", "i", "]"}]}], 
       RowBox[{"k", "[", "j", "]"}]}], "*)"}], "//", "Expand"}], "//", 
    "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.911669389622587*^9, {3.9129286643440895`*^9, 3.91292866976632*^9}, {
   3.912929066613428*^9, 3.9129290675475535`*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"8f6ee723-2490-4602-ad41-e72c57cf8fe0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"GRflatt", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["z1", "2"], "GRnt"}], "/.", 
           RowBox[{"kk", "->", "k"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "i_", "]"}], ",", 
              RowBox[{"k", "[", "1", "]"}]}], "]"}], ":>", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "-", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i", "]"}], ",", 
               RowBox[{"k", "[", "3", "]"}]}], "]"}], "-", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i", "]"}], ",", 
               RowBox[{"k", "[", "4", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"k", "[", "i_", "]"}], ",", 
            RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i_", "]"}], ",", 
           RowBox[{"k", "[", "4", "]"}]}], "]"}], ":>", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "i", "]"}], ",", 
             RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "-", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], ",", 
            RowBox[{"k", "[", "3", "]"}]}], "]"}], "-", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], ",", 
            RowBox[{"k", "[", "1", "]"}]}], "]"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "i_", "]"}], ",", 
          RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", 
      RowBox[{"k", "->", "kk"}]}], "//", "Simplify"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", 
  RowBox[{
   RowBox[{"FreeQ", "[", 
    RowBox[{"#", ",", 
     RowBox[{"kk", "[", "4", "]"}]}], "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.912928686356737*^9, 3.912928689180716*^9}, 
   3.9129290277540283`*^9},
 CellLabel->
  "In[192]:=",ExpressionUUID->"416519a5-8d74-4097-9894-63cb9d9e3f9f"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.911667710916993*^9, 3.9116680060396557`*^9, 3.9116681094694347`*^9, 
   3.911668139668657*^9, 3.911669241933899*^9, 3.911669358682846*^9, 
   3.9116693930262213`*^9, 3.911669440125927*^9, 3.9116697161023684`*^9, 
   3.9117154745416775`*^9, 3.9117440052148438`*^9, 3.911801596494048*^9, 
   3.911804945911009*^9, 3.911835227434885*^9, 3.9119750144395466`*^9, 
   3.912065035326528*^9, 3.912065633300026*^9, 3.9120658412595825`*^9, 
   3.912165539957532*^9, 3.9126228143488293`*^9, 3.9126629614739037`*^9, 
   3.9126729210626945`*^9, 3.9129233560296183`*^9, 3.9129286909161477`*^9, {
   3.912929028349206*^9, 3.912929036827727*^9}, 3.9129290696260395`*^9, 
   3.913119258669587*^9, 3.9131372183120575`*^9, 3.9131374178606415`*^9, 
   3.91313809838789*^9, 3.9131529181445637`*^9, 3.91439791095053*^9, 
   3.914432728921227*^9, 3.91517025814415*^9, 3.9152938612658567`*^9, 
   3.915747177427822*^9, 3.9159009326767397`*^9, 3.9159037136594048`*^9, 
   3.916119589174941*^9, 3.91613827871756*^9, 3.916138690852578*^9, 
   3.916825601458519*^9, {3.9169000401214113`*^9, 3.916900069571476*^9}, 
   3.91717524946426*^9, 3.9184003894738827`*^9, 3.9184535725999775`*^9, 
   3.937045762906842*^9, 3.937045892441317*^9, 3.9370464971445556`*^9},
 CellLabel->
  "Out[193]=",ExpressionUUID->"1942cd99-34f2-45fe-a041-f4c1db607271"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["GRflatt"], "Input",
 CellLabel->
  "In[194]:=",ExpressionUUID->"6554fce0-fa29-44e3-970d-96379b8bdfc6"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"8", " ", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "3"}], "]"}]}]], 
  RowBox[{
   SuperscriptBox["z1", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "3"}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", 
         RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", 
         RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"S", "[", 
              RowBox[{"1", ",", "2"}], "]"}]}], "+", 
            RowBox[{"S", "[", 
             RowBox[{"2", ",", "3"}], "]"}]}], ")"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "2", "]"}], ",", 
            RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "2", "]"}], ",", 
            RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "3", "]"}], ",", 
            RowBox[{"kk", "[", "1", "]"}]}], "]"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "2", "]"}], ",", 
            RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "3", "]"}], ",", 
            RowBox[{"kk", "[", "2", "]"}]}], "]"}]}]}], ")"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", 
         RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "4", "]"}], ",", 
         RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "4", "]"}], ",", 
         RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", 
         RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "4", "]"}], ",", 
         RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "4", "]"}], ",", 
         RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"S", "[", 
            RowBox[{"2", ",", "3"}], "]"}]}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "2", "]"}], ",", 
            RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "2", "]"}], ",", 
            RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "4", "]"}], ",", 
              RowBox[{"kk", "[", "2", "]"}]}], "]"}], "+", 
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "4", "]"}], ",", 
              RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], ")"}]}]}], ")"}]}]}], 
     ")"}], "2"]}]}]], "Output",
 CellChangeTimes->{
  3.9131194251621046`*^9, 3.9131372186580553`*^9, 3.9131374181746387`*^9, 
   3.9131380986958895`*^9, 3.9131529181952257`*^9, 3.914397911002345*^9, 
   3.914432728999859*^9, 3.915170258205267*^9, 3.915293861329391*^9, 
   3.9157471774876747`*^9, 3.91590093273349*^9, 3.9159037137178917`*^9, 
   3.916119589197914*^9, 3.916138278745475*^9, 3.916138690883246*^9, 
   3.916825601497384*^9, {3.916900040157629*^9, 3.9169000696057577`*^9}, 
   3.917175249510151*^9, 3.9184003902411532`*^9, 3.9184535727665076`*^9, 
   3.937045763181332*^9, 3.9370458927073183`*^9, 3.9370464973937187`*^9},
 CellLabel->
  "Out[194]=",ExpressionUUID->"0ae4ee2f-f186-4233-9715-d10f50463ba7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"GRnu", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               FractionBox[
                SuperscriptBox["nu", "2"], 
                RowBox[{"2", " ", 
                 RowBox[{"S", "[", 
                  RowBox[{"2", ",", "4"}], "]"}]}]], "/.", "rulesinv"}], "/.", 
              RowBox[{
               RowBox[{"\[Mu]", "[", 
                RowBox[{"e", "[", "x_", "]"}], "]"}], "->", 
               RowBox[{"e", "[", "x", "]"}]}]}], "/.", 
             RowBox[{
              RowBox[{"s", "[", "i_", "]"}], "\[RuleDelayed]", 
              FractionBox[
               RowBox[{"z1", " ", 
                RowBox[{"k", "[", "i", "]"}]}], "2"]}]}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"k", "[", "i_", "]"}], ",", 
                 RowBox[{"k", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"kk", "[", "i", "]"}], ",", 
                 RowBox[{"kk", "[", "j", "]"}]}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"e", "[", "i_", "]"}], ",", 
                 RowBox[{"k", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"e", "[", "i", "]"}], ",", 
                 RowBox[{"kk", "[", "j", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
           RowBox[{
            RowBox[{"k", "[", "4", "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"k", "[", "1", "]"}]}], "-", 
             RowBox[{"k", "[", "2", "]"}], "-", 
             RowBox[{"k", "[", "3", "]"}]}]}]}], "/.", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"kk", "[", "i_", "]"}], ",", 
             RowBox[{"kk", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
           RowBox[{"S", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{"3", ",", "4"}], "]"}], "->", 
          RowBox[{"S", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"1", ",", "4"}], "]"}], "->", 
         RowBox[{"S", "[", 
          RowBox[{"2", ",", "3"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{"S", "[", 
         RowBox[{"1", ",", "3"}], "]"}], "->", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"S", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}], "-", 
         RowBox[{"S", "[", 
          RowBox[{"2", ",", "3"}], "]"}]}]}]}], "/.", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "4"}], "]"}], "->", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"S", "[", 
          RowBox[{"1", ",", "2"}], "]"}]}], "-", 
        RowBox[{"S", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}]}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"+", 
        RowBox[{"k", "[", "i", "]"}]}], 
       RowBox[{"k", "[", "j", "]"}]}], "*)"}], "//", "Expand"}], "//", 
    "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.911669389622587*^9, {3.9129286643440895`*^9, 3.91292866976632*^9}, {
   3.912929066613428*^9, 3.9129290675475535`*^9}, {3.9129313675082045`*^9, 
   3.9129313705465355`*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"f7ca82e7-8ba5-47a7-9912-e4297b85cba9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"GRflatu", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["z1", "2"], "GRnu"}], "/.", 
           RowBox[{"kk", "->", "k"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "i_", "]"}], ",", 
              RowBox[{"k", "[", "1", "]"}]}], "]"}], ":>", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "-", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i", "]"}], ",", 
               RowBox[{"k", "[", "3", "]"}]}], "]"}], "-", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i", "]"}], ",", 
               RowBox[{"k", "[", "4", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"k", "[", "i_", "]"}], ",", 
            RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i_", "]"}], ",", 
           RowBox[{"k", "[", "4", "]"}]}], "]"}], ":>", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "i", "]"}], ",", 
             RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "-", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], ",", 
            RowBox[{"k", "[", "3", "]"}]}], "]"}], "-", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], ",", 
            RowBox[{"k", "[", "1", "]"}]}], "]"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "i_", "]"}], ",", 
          RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", 
      RowBox[{"k", "->", "kk"}]}], "//", "Simplify"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", 
  RowBox[{
   RowBox[{"FreeQ", "[", 
    RowBox[{"#", ",", 
     RowBox[{"kk", "[", "4", "]"}]}], "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.912928686356737*^9, 3.912928689180716*^9}, 
   3.9129290277540283`*^9, {3.9129313724338818`*^9, 3.912931374053586*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"bb5ab67c-9615-4e83-8279-7dce72e76cac"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.911667710916993*^9, 3.9116680060396557`*^9, 3.9116681094694347`*^9, 
   3.911668139668657*^9, 3.911669241933899*^9, 3.911669358682846*^9, 
   3.9116693930262213`*^9, 3.911669440125927*^9, 3.9116697161023684`*^9, 
   3.9117154745416775`*^9, 3.9117440052148438`*^9, 3.911801596494048*^9, 
   3.911804945911009*^9, 3.911835227434885*^9, 3.9119750144395466`*^9, 
   3.912065035326528*^9, 3.912065633300026*^9, 3.9120658412595825`*^9, 
   3.912165539957532*^9, 3.9126228143488293`*^9, 3.9126629614739037`*^9, 
   3.9126729210626945`*^9, 3.9129233560296183`*^9, 3.9129286909161477`*^9, {
   3.912929028349206*^9, 3.912929036827727*^9}, 3.9129290696260395`*^9, 
   3.912931376053196*^9, 3.913119259525682*^9, 3.9131372193070607`*^9, 
   3.913137418675736*^9, 3.9131380992199125`*^9, 3.9131529184497747`*^9, 
   3.914397911242243*^9, 3.9144327290975533`*^9, 3.91517025843382*^9, 
   3.915293861567432*^9, 3.915747177742073*^9, 3.915900932942792*^9, 
   3.915903713931952*^9, 3.9161195893868504`*^9, 3.916138278938195*^9, 
   3.916138691076481*^9, 3.916825601693475*^9, {3.916900040359871*^9, 
   3.916900069726274*^9}, 3.917175249720235*^9, 3.918400391149704*^9, 
   3.9184535731307507`*^9, 3.937045763655691*^9, 3.9370458931770997`*^9, 
   3.9370464977854385`*^9},
 CellLabel->
  "Out[197]=",ExpressionUUID->"ffd0d14e-257c-4666-94ad-c9f8a189135e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["lorentz invariant", "Subsubsection",
 CellChangeTimes->{{3.9116696881285677`*^9, 
  3.91166969078436*^9}},ExpressionUUID->"3c7e8b89-60c8-4fce-854c-\
0b5157284191"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getGRadsAmpflat4", "[", 
   RowBox[{"adsamp_", ",", "s12_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"result", ",", "GRadsns", ",", "GRadsns1"}], "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{"Your", " ", "entire", " ", "code", " ", "here"}], "*)"}], 
    RowBox[{
     RowBox[{"result", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"adsamp", "/.", " ", 
              RowBox[{
               SubscriptBox["D", 
                RowBox[{"ks", "[", 
                 RowBox[{"x3_", ",", "x4_"}], "]"}]], ":>", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["z1", "2"], 
                 SuperscriptBox[
                  RowBox[{"ks", "[", 
                   RowBox[{"x3", ",", "x4"}], "]"}], "2"]}], "+", 
                RowBox[{"2", "  ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "2"}], " ", 
                   RowBox[{"s", "[", 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "x3", "]"}], "<>", 
                    RowBox[{"ToString", "[", "x4", "]"}]}], "]"}], "]"}]}], 
                  ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"s", "[", 
                   RowBox[{"ToExpression", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "x3", "]"}], "<>", 
                    RowBox[{"ToString", "[", "x4", "]"}]}], "]"}], "]"}], 
                  ")"}]}]}]}]}], "//", 
             RowBox[{"ReplaceAll", "[", 
              RowBox[{
               RowBox[{"s", "[", "p_", "]"}], ":>", 
               RowBox[{
                RowBox[{
                 RowBox[{"s", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "//", "ToString"}], "//", 
                    RowBox[{
                    RowBox[{"StringSplit", "[", 
                    RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}], "//", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "//", 
                   "ToExpression"}], "]"}], "+", 
                 RowBox[{"s", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "//", "ToString"}], "//", 
                    RowBox[{
                    RowBox[{"StringSplit", "[", 
                    RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}], "//", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "//", 
                   "ToExpression"}], "]"}]}], "/;", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{
                   RowBox[{"p", "//", "ToString"}], "//", 
                   RowBox[{
                    RowBox[{"StringSplit", "[", 
                    RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}], "]"}], 
                 ">", "1"}]}]}], "]"}]}], ")"}], "/.", 
           RowBox[{
            RowBox[{"s", "[", "i_", "]"}], "\[RuleDelayed]", 
            FractionBox[
             RowBox[{"z1", " ", 
              RowBox[{"k", "[", "i", "]"}]}], "2"]}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"k", "[", "i_", "]"}], ",", 
               RowBox[{"k", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"kk", "[", "i", "]"}], ",", 
               RowBox[{"kk", "[", "j", "]"}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i_", "]"}], ",", 
               RowBox[{"k", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i", "]"}], ",", 
               RowBox[{"kk", "[", "j", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
         RowBox[{
          RowBox[{"k", "[", "4", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"k", "[", "1", "]"}]}], "-", 
           RowBox[{"k", "[", "2", "]"}], "-", 
           RowBox[{"k", "[", "3", "]"}]}]}]}], "//", 
        RowBox[{"ReplaceAll", "[", "kijrlinv", "]"}]}], "//", "Simplify"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Series", "[", 
         RowBox[{"result", ",", 
          RowBox[{"{", 
           RowBox[{"z1", ",", "Infinity", ",", 
            RowBox[{"-", "2"}]}], "}"}]}], "]"}], "//", "Normal"}], "//", 
       "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{
       RowBox[{"result", "//", "Expand"}], "//", "Simplify"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"result", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              SuperscriptBox["ks12", "2"], "\[Rule]", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"k", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"k", "[", "2", "]"}], "2"], "+", 
               RowBox[{"2", 
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"kk", "[", "1", "]"}], ",", 
                  RowBox[{"kk", "[", "2", "]"}]}], "]"}]}]}]}], ",", 
             RowBox[{
              SuperscriptBox["ks12", "4"], "\[Rule]", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"k", "[", "1", "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"k", "[", "2", "]"}], "2"], "+", 
                 RowBox[{"2", 
                  RowBox[{"sc", "[", 
                   RowBox[{
                    RowBox[{"kk", "[", "1", "]"}], ",", 
                    RowBox[{"kk", "[", "2", "]"}]}], "]"}]}]}], ")"}], 
               "2"]}]}], "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             SuperscriptBox["ks34", "2"], "\[Rule]", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"k", "[", "3", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"k", "[", "4", "]"}], "2"], "+", 
              RowBox[{"2", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"kk", "[", "3", "]"}], ",", 
                 RowBox[{"kk", "[", "4", "]"}]}], "]"}]}]}]}], ",", 
            RowBox[{
             SuperscriptBox["ks34", "4"], "\[Rule]", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"k", "[", "3", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"k", "[", "4", "]"}], "2"], "+", 
                RowBox[{"2", 
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"kk", "[", "3", "]"}], ",", 
                   RowBox[{"kk", "[", "4", "]"}]}], "]"}]}]}], ")"}], 
              "2"]}]}], "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SuperscriptBox["ks24", "2"], "\[Rule]", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"k", "[", "2", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"k", "[", "4", "]"}], "2"], "+", 
             RowBox[{"2", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"kk", "[", "2", "]"}], ",", 
                RowBox[{"kk", "[", "4", "]"}]}], "]"}]}]}]}], ",", 
           RowBox[{
            SuperscriptBox["ks24", "4"], "\[Rule]", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"k", "[", "2", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"k", "[", "4", "]"}], "2"], "+", 
               RowBox[{"2", 
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"kk", "[", "2", "]"}], ",", 
                  RowBox[{"kk", "[", "4", "]"}]}], "]"}]}]}], ")"}], "2"]}]}],
           "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SuperscriptBox["ks23", "2"], "\[Rule]", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"k", "[", "3", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"k", "[", "2", "]"}], "2"], "+", 
            RowBox[{"2", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"kk", "[", "3", "]"}], ",", 
               RowBox[{"kk", "[", "2", "]"}]}], "]"}]}]}]}], ",", 
          RowBox[{
           SuperscriptBox["ks23", "4"], "\[Rule]", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"k", "[", "3", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"k", "[", "2", "]"}], "2"], "+", 
              RowBox[{"2", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"kk", "[", "3", "]"}], ",", 
                 RowBox[{"kk", "[", "2", "]"}]}], "]"}]}]}], ")"}], "2"]}]}], 
         "}"}]}], "//", "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"GRadsns", "=", 
      RowBox[{
       RowBox[{"result", "/.", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"kk", "[", "i_", "]"}], ",", 
           RowBox[{"kk", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{"i", ",", "j"}], "]"}], "+", 
          RowBox[{
           RowBox[{"k", "[", "i", "]"}], 
           RowBox[{"k", "[", "j", "]"}]}]}]}]}], "//", "Simplify"}]}], ";", 
     RowBox[{"(*", "\[IndentingNewLine]", 
      RowBox[{"%", "//", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{"#", ",", 
          RowBox[{"k", "[", "_", "]"}]}], "]"}], "&"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"GRadsns1", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"GRadsns", "/.", 
                RowBox[{
                 RowBox[{"k", "[", "4", "]"}], "\[Rule]", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"k", "[", "1", "]"}]}], "-", 
                  RowBox[{"k", "[", "2", "]"}], "-", 
                  RowBox[{"k", "[", "3", "]"}]}]}]}], "/.", 
               RowBox[{"kk", "->", "k"}]}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"e", "[", "i_", "]"}], ",", 
                  RowBox[{"k", "[", "1", "]"}]}], "]"}], ":>", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"sc", "[", 
                   RowBox[{
                    RowBox[{"e", "[", "i", "]"}], ",", 
                    RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "-", 
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i", "]"}], ",", 
                   RowBox[{"k", "[", "3", "]"}]}], "]"}], "-", 
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i", "]"}], ",", 
                   RowBox[{"k", "[", "4", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"k", "[", "i_", "]"}], ",", 
                RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i_", "]"}], ",", 
               RowBox[{"k", "[", "4", "]"}]}], "]"}], ":>", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"e", "[", "i", "]"}], ",", 
                 RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"k", "[", "3", "]"}]}], "]"}], "-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"k", "[", "1", "]"}]}], "]"}]}]}]}], "/.", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"k", "[", "i_", "]"}], ",", 
              RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", 
          RowBox[{"k", "->", "kk"}]}], "//", 
         RowBox[{
          RowBox[{"Series", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"s12", ",", "0", ",", "4"}], "}"}]}], "]"}], "&"}]}], "//",
         "FullSimplify"}], "//", "Normal"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "GRadsns1"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9131184161075435`*^9, 3.9131184661691437`*^9}, {
  3.9131189396300616`*^9, 3.913118946118*^9}, {3.913119018329955*^9, 
  3.9131190277702155`*^9}, {3.913119072338377*^9, 3.9131190730132446`*^9}, {
  3.9131191639506283`*^9, 3.9131192044418674`*^9}, {3.9131198172063017`*^9, 
  3.9131198354951153`*^9}, {3.913120052834677*^9, 3.9131200658505397`*^9}},
 CellLabel->
  "In[198]:=",ExpressionUUID->"7ec5cf68-0003-48b9-ab88-7be0d4d3adac"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GRadsns1", "=", 
  RowBox[{"getGRadsAmpflat4", "[", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"a1GR4", "[", 
       RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}], 
      SubscriptBox["D", 
       RowBox[{"ks", "[", 
        RowBox[{"1", ",", "2"}], "]"}]]], "+", 
     RowBox[{"bGR4", "[", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}], "+", 
     RowBox[{"cGR4", "[", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}]}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "2"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9131189348598638`*^9, 3.9131189609175663`*^9}, {
  3.9131191010078793`*^9, 3.9131191019942756`*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"56db4f17-2f1e-4386-9912-86b21b0ef36f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   SuperscriptBox["z1", "2"], " ", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "2"}], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", 
         RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}]}]}], ")"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "2"}], "]"}]}]], 
   RowBox[{
    SuperscriptBox["z1", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "1", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "2", "]"}], ",", 
             RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "1", "]"}], ",", 
             RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "2", "]"}], ",", 
             RowBox[{"kk", "[", "1", "]"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "4", "]"}], ",", 
          RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{"2", ",", "3"}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "3", "]"}], ",", 
             RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "3", "]"}], ",", 
               RowBox[{"kk", "[", "1", "]"}]}], "]"}], "+", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "3", "]"}], ",", 
               RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], ")"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "4", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "3", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "4", "]"}], ",", 
             RowBox[{"kk", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}], 
     "2"]}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["z1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "1", "]"}], ",", 
            RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], ",", 
           RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"kk", "[", "1", "]"}]}], "]"}]}]}], ")"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "4", "]"}], ",", 
        RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"S", "[", 
           RowBox[{"2", ",", "3"}], "]"}]}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "3", "]"}], ",", 
             RowBox[{"kk", "[", "1", "]"}]}], "]"}], "+", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "3", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], ")"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "4", "]"}], ",", 
           RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "4", "]"}], ",", 
           RowBox[{"kk", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.9131190024995346`*^9, {3.9131190993686385`*^9, 3.913119120623906*^9}, 
   3.913119218245019*^9, 3.913119781729149*^9, 3.91312026397295*^9, 
   3.913120406431229*^9, 3.913137219710065*^9, 3.913137425177787*^9, 
   3.9131381045324316`*^9, 3.913152923168063*^9, 3.914397916198381*^9, 
   3.914432732914032*^9, 3.9151702633127403`*^9, 3.915293866500696*^9, 
   3.9157471827463007`*^9, 3.9159009377502737`*^9, 3.915903719118002*^9, 
   3.916119594367981*^9, 3.916138283798044*^9, 3.916138695923073*^9, 
   3.916825606575612*^9, {3.916900045184935*^9, 3.916900072975801*^9}, 
   3.917175254898506*^9, 3.9184003968335266`*^9, 3.9184535869773345`*^9, 
   3.937045779214297*^9, 3.937045897273528*^9, 3.9370465019822345`*^9},
 CellLabel->
  "Out[199]=",ExpressionUUID->"b35147f7-9939-4604-a7d2-50ca7ba3c4a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GRadsns1", "-", "\[IndentingNewLine]", "GRflat"}], "/.", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "3"}], "]"}], "->", 
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "4"}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"3", ",", "4"}], "]"}], "->", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "2"}], "]"}]}]}], "//", "Expand"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.9129290971273155`*^9, 3.912929104173717*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"31e7d66d-996e-49db-9044-d3092df7d214"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.9129290988464327`*^9, 3.9129291228323207`*^9}, 
   3.913119274819328*^9, {3.913119774641503*^9, 3.913119782315961*^9}, 
   3.9131204068778887`*^9, 3.913137220101066*^9, 3.9131374254947643`*^9, 
   3.913138104984227*^9, 3.913152923243741*^9, 3.914397916263464*^9, 
   3.914432733001287*^9, 3.915170263373703*^9, 3.915293866598523*^9, 
   3.915747182849422*^9, 3.915900937852703*^9, 3.915903719364079*^9, 
   3.9161195944339542`*^9, 3.91613828386622*^9, 3.9161386959936*^9, 
   3.916825606658164*^9, {3.916900045274352*^9, 3.916900073030751*^9}, 
   3.91717525501781*^9, 3.918400397876298*^9, 3.9184535871705217`*^9, 
   3.937045779507189*^9, 3.9370458975601463`*^9, 3.937046502341688*^9},
 CellLabel->
  "Out[200]=",ExpressionUUID->"e75ef97a-4ac7-4a97-92b4-f300df370f78"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GRadsnt1", "=", 
  RowBox[{"getGRadsAmpflat4", "[", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"a1GR4", "[", 
       RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "]"}], 
      SubscriptBox["D", 
       RowBox[{"ks", "[", 
        RowBox[{"2", ",", "3"}], "]"}]]], "+", 
     RowBox[{"bGR4", "[", 
      RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "]"}], "+", 
     RowBox[{"cGR4", "[", 
      RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "]"}]}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "4"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.913119284146082*^9, 3.9131192938185234`*^9}, {
  3.913119785379475*^9, 3.913119785981985*^9}},
 CellLabel->
  "In[201]:=",ExpressionUUID->"b5950cbf-74fb-48d3-9d4a-2cdc0cfe4c18"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"8", " ", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "3"}], "]"}]}]], 
  RowBox[{
   SuperscriptBox["z1", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "3"}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", 
         RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", 
         RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"S", "[", 
             RowBox[{"2", ",", "3"}], "]"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"S", "[", 
              RowBox[{"3", ",", "4"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "2", "]"}], ",", 
            RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "2", "]"}], ",", 
            RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "3", "]"}], ",", 
            RowBox[{"kk", "[", "1", "]"}]}], "]"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "2", "]"}], ",", 
            RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "3", "]"}], ",", 
            RowBox[{"kk", "[", "2", "]"}]}], "]"}]}]}], ")"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", 
         RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "4", "]"}], ",", 
         RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "4", "]"}], ",", 
         RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "1", "]"}], ",", 
            RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "2", "]"}], ",", 
            RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "1", "]"}], ",", 
            RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "3", "]"}], ",", 
            RowBox[{"kk", "[", "2", "]"}]}], "]"}]}]}], ")"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "4", "]"}], ",", 
         RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"S", "[", 
            RowBox[{"2", ",", "3"}], "]"}]}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "2", "]"}], ",", 
            RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "2", "]"}], ",", 
            RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "4", "]"}], ",", 
              RowBox[{"kk", "[", "2", "]"}]}], "]"}], "+", 
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "4", "]"}], ",", 
              RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], ")"}]}]}], ")"}]}]}], 
     ")"}], "2"]}]}]], "Output",
 CellChangeTimes->{
  3.913119303257693*^9, 3.9131196288368645`*^9, 3.9131197925665607`*^9, 
   3.9131198503772707`*^9, 3.9131204132830243`*^9, 3.9131372204347563`*^9, 
   3.9131374313374796`*^9, 3.913138110161939*^9, 3.9131529282142563`*^9, 
   3.9143979214528303`*^9, 3.914432736697249*^9, 3.915170268224555*^9, 
   3.915293871701858*^9, 3.9157471881016493`*^9, 3.915900943101651*^9, 
   3.915903724636859*^9, 3.916119599599865*^9, 3.916138288988318*^9, 
   3.916138700898699*^9, 3.916825611805912*^9, {3.916900050305915*^9, 
   3.9169000762739983`*^9}, 3.917175260272458*^9, 3.918400403900442*^9, 
   3.918453591247721*^9, 3.9370457836117535`*^9, 3.937045901038488*^9, 
   3.937046506352776*^9},
 CellLabel->
  "Out[201]=",ExpressionUUID->"37b93d5a-fce6-45c6-b74a-df70103cac5a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GRadsnt1", "-", "\[IndentingNewLine]", "GRflatt"}], "/.", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "3"}], "]"}], "->", 
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "4"}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"3", ",", "4"}], "]"}], "->", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "2"}], "]"}]}]}], "//", "Expand"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{
  3.9129286982867193`*^9, {3.912928955468666*^9, 3.9129289917970853`*^9}, {
   3.912929043014723*^9, 3.912929077664053*^9}, 3.9131193167526784`*^9},
 CellLabel->
  "In[202]:=",ExpressionUUID->"09068415-89f9-4493-aed9-2b595a680917"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.912928699098139*^9, {3.912928959399825*^9, 3.912928992372568*^9}, {
   3.912929060263129*^9, 3.912929077926114*^9}, 3.913119317473615*^9, {
   3.91311940268715*^9, 3.9131194146267595`*^9}, 3.9131196827674456`*^9, 
   3.9131197988573604`*^9, 3.913119850804899*^9, 3.9131204137239046`*^9, 
   3.913137220855758*^9, 3.9131374316444807`*^9, 3.91313811054085*^9, 
   3.913152928311554*^9, 3.914397921540751*^9, 3.91443273676747*^9, 
   3.9151702682741117`*^9, 3.9152938717725058`*^9, 3.9157471881715193`*^9, 
   3.915900943184018*^9, 3.9159037247290688`*^9, 3.9161195996402063`*^9, 
   3.916138289031144*^9, 3.916138700947966*^9, 3.916825611862351*^9, {
   3.9169000503626738`*^9, 3.916900076325729*^9}, 3.917175260332265*^9, 
   3.9184004051161814`*^9, 3.918453591479162*^9, 3.9370457838890133`*^9, 
   3.937045901354418*^9, 3.9370465066495495`*^9},
 CellLabel->
  "Out[202]=",ExpressionUUID->"05d1d647-3377-43e2-a64b-f9de67639c62"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GRadsnu1", "=", 
  RowBox[{"getGRadsAmpflat4", "[", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"a1GR4", "[", 
       RowBox[{"2", ",", "4", ",", "3", ",", "1"}], "]"}], 
      SubscriptBox["D", 
       RowBox[{"ks", "[", 
        RowBox[{"2", ",", "4"}], "]"}]]], "+", 
     RowBox[{"bGR4", "[", 
      RowBox[{"2", ",", "4", ",", "3", ",", "1"}], "]"}], "+", 
     RowBox[{"cGR4", "[", 
      RowBox[{"2", ",", "4", ",", "3", ",", "1"}], "]"}]}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "4"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.913120005348646*^9, 3.9131200122761316`*^9}},
 CellLabel->
  "In[203]:=",ExpressionUUID->"e0741015-62ce-40be-bdb9-f4ae4eceef73"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   SuperscriptBox["z1", "2"], " ", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "4"}], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}]}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", 
         RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}]}]}], ")"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["z1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}]}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "1", "]"}], ",", 
            RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "2", "]"}], ",", 
             RowBox[{"kk", "[", "1", "]"}]}], "]"}], "+", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "2", "]"}], ",", 
             RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], ",", 
           RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "4", "]"}], ",", 
           RowBox[{"kk", "[", "2", "]"}]}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "2", "]"}], ",", 
             RowBox[{"kk", "[", "1", "]"}]}], "]"}], "+", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "2", "]"}], ",", 
             RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], ")"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "4", "]"}], ",", 
           RowBox[{"kk", "[", "2", "]"}]}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"3", ",", "4"}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "4", "]"}], ",", 
           RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "2", "]"}], ",", 
             RowBox[{"kk", "[", "1", "]"}]}], "]"}], "+", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "2", "]"}], ",", 
             RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], ")"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "4", "]"}], ",", 
           RowBox[{"kk", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
  "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "4"}], "]"}]}]], 
   RowBox[{
    SuperscriptBox["z1", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "1", "]"}], ",", 
              RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "2", "]"}], ",", 
             RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "1", "]"}], ",", 
             RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "2", "]"}], ",", 
               RowBox[{"kk", "[", "1", "]"}]}], "]"}], "+", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "2", "]"}], ",", 
               RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "1", "]"}], ",", 
             RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "4", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}]}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "2", "]"}], ",", 
               RowBox[{"kk", "[", "1", "]"}]}], "]"}], "+", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "2", "]"}], ",", 
               RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], ")"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "3", "]"}], ",", 
             RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "2", "]"}], ",", 
             RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "3", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "2", "]"}], ",", 
             RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "4", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{"3", ",", "4"}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "2", "]"}], ",", 
             RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "2", "]"}], ",", 
             RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "4", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "2", "]"}], ",", 
               RowBox[{"kk", "[", "1", "]"}]}], "]"}], "+", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "2", "]"}], ",", 
               RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], ")"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "4", "]"}], ",", 
             RowBox[{"kk", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}], 
     "2"]}]}]}]], "Output",
 CellChangeTimes->{
  3.9131200229378653`*^9, 3.913120079282493*^9, 3.9131204207685084`*^9, 
   3.913137221198759*^9, 3.9131374378361607`*^9, 3.9131381162461*^9, 
   3.913152933626642*^9, 3.914397927053172*^9, 3.914432740971277*^9, 
   3.915170273959404*^9, 3.915293877255739*^9, 3.915747193759514*^9, 
   3.915900948614408*^9, 3.915903730353058*^9, 3.9161196052901773`*^9, 
   3.916138294513339*^9, 3.916138706584675*^9, 3.91682561729106*^9, {
   3.916900055732182*^9, 3.916900079853545*^9}, 3.9171752662260313`*^9, 
   3.9184004114285936`*^9, 3.918453595966687*^9, 3.9370457884621162`*^9, 
   3.9370459052367496`*^9, 3.9370465112363353`*^9},
 CellLabel->
  "Out[203]=",ExpressionUUID->"27bf8ef4-0020-42fc-abdf-6dfe63419d5a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"GRadsnu1", "-", "\[IndentingNewLine]", "GRflatu"}], "/.", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "3"}], "]"}], "->", 
       RowBox[{"S", "[", 
        RowBox[{"1", ",", "4"}], "]"}]}]}], "/.", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"3", ",", "4"}], "]"}], "->", 
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "2"}], "]"}]}]}], "//", "Expand"}], "//", 
   "Simplify"}], "//", 
  RowBox[{"ReplaceAll", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "2"}], "]"}], "+", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "4"}], "]"}], "+", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "4"}], "]"}]}], "->", "0"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.9129286982867193`*^9, {3.912928955468666*^9, 3.9129289917970853`*^9}, {
   3.912929043014723*^9, 3.912929077664053*^9}, 3.9129313572704196`*^9, {
   3.9131201251400576`*^9, 3.9131201328776197`*^9}, 3.9131202757712984`*^9, {
   3.9131203480502014`*^9, 3.9131203583354006`*^9}},
 CellLabel->
  "In[204]:=",ExpressionUUID->"b31b469f-4422-468e-88b6-f587524bf32b"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.912928699098139*^9, {3.912928959399825*^9, 3.912928992372568*^9}, {
   3.912929060263129*^9, 3.912929077926114*^9}, 3.9129313984446383`*^9, 
   3.913119712108306*^9, {3.9131201230550585`*^9, 3.9131201341491137`*^9}, 
   3.913120276493306*^9, {3.9131203498329687`*^9, 3.9131203597032223`*^9}, 
   3.9131204213047724`*^9, 3.91313722163476*^9, 3.913137438636162*^9, 
   3.9131381172001085`*^9, 3.913152934261043*^9, 3.914397927724616*^9, 
   3.914432741163638*^9, 3.915170274621294*^9, 3.9157471943972197`*^9, 
   3.915900949252865*^9, 3.915903730976121*^9, 3.916119605896406*^9, 
   3.916138295130289*^9, 3.916138707195279*^9, 3.916825617918501*^9, {
   3.9169000563511477`*^9, 3.9169000799643583`*^9}, 3.917175266846777*^9, 
   3.918400412925946*^9, 3.9184535965256104`*^9, 3.9370457890830407`*^9, 
   3.93704590575773*^9, 3.9370465118524375`*^9},
 CellLabel->
  "Out[204]=",ExpressionUUID->"2fded9c3-4158-411c-bf8f-ea88d82d1213"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["How we get the result", "Section",
 CellChangeTimes->{{3.918455708824129*^9, 
  3.9184557145341835`*^9}},ExpressionUUID->"f0f3d7a9-7234-4421-af0d-\
507824c6f8bf"],

Cell[CellGroupData[{

Cell["a1234: factorization", "Subsection",
 CellChangeTimes->{{3.918456878946432*^9, 3.9184568804063683`*^9}, {
  3.937046521776788*^9, 
  3.937046523303224*^9}},ExpressionUUID->"28376988-bc3e-41fc-a586-\
ebf7840e5219"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"M3", "[", 
    RowBox[{
     RowBox[{"k", "[", "1", "]"}], ",", 
     RowBox[{"k", "[", "2", "]"}], ",", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"k", "[", "1", "]"}], "+", 
        RowBox[{"k", "[", "2", "]"}]}], ")"}]}], ",", "z1", ",", 
     RowBox[{"e", "[", "1", "]"}], ",", 
     RowBox[{"e", "[", "2", "]"}], ",", 
     RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}], "//", "Expand"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"a_", ",", 
         RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}], 
       RowBox[{"sc", "[", 
        RowBox[{"b_", ",", 
         RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}]}], ":>", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"a", ",", 
         RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}], 
       RowBox[{"sc", "[", 
        RowBox[{"b", ",", 
         RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}]}]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"sc", "[", 
        RowBox[{"a_", ",", 
         RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}], "2"], ":>", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"a", ",", 
         RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}], 
       RowBox[{"sc", "[", 
        RowBox[{"a", ",", 
         RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"M3", "[", 
    RowBox[{
     RowBox[{"k", "[", "3", "]"}], ",", 
     RowBox[{"k", "[", "4", "]"}], ",", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"k", "[", "3", "]"}], "+", 
        RowBox[{"k", "[", "4", "]"}]}], ")"}]}], ",", "z1", ",", 
     RowBox[{"e", "[", "3", "]"}], ",", 
     RowBox[{"e", "[", "4", "]"}], ",", 
     RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}], "//", "Expand"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"a_", ",", 
         RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}], 
       RowBox[{"sc", "[", 
        RowBox[{"b_", ",", 
         RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}]}], ":>", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"a", ",", 
         RowBox[{"\[Mu]", "[", "j1", "]"}]}], "]"}], 
       RowBox[{"sc", "[", 
        RowBox[{"b", ",", 
         RowBox[{"\[Mu]", "[", "j2", "]"}]}], "]"}]}]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"sc", "[", 
        RowBox[{"a_", ",", 
         RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}], "2"], ":>", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"a", ",", 
         RowBox[{"\[Mu]", "[", "j1", "]"}]}], "]"}], 
       RowBox[{"sc", "[", 
        RowBox[{"a", ",", 
         RowBox[{"\[Mu]", "[", "j2", "]"}]}], "]"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"%", 
     RowBox[{"(", "%%%", ")"}], 
     RowBox[{"\[Pi]2", "[", 
      RowBox[{"i1", ",", "i2", ",", "j1", ",", "j2", ",", "ks"}], "]"}]}], "//.",
     "projection"}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"-", "b_"}]}], "]"}], ":>", 
      RowBox[{"-", 
       RowBox[{"sc", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"c_", "+", "d_"}]}], "]"}], ":>", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"a", ",", "c"}], "]"}], "+", 
       RowBox[{"sc", "[", 
        RowBox[{"a", ",", "d"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"k", "[", "i_", "]"}], ",", 
        RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"contract", "[", 
    RowBox[{"%", ",", "d"}], "]"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Expanding", " ", "the", " ", "propagator", " ", "to", " ", 
     RowBox[{"ks", "^", "2"}], " ", "order"}], ",", " ", 
    RowBox[{
     FormBox[
      RowBox[{
       FractionBox["1", 
        RowBox[{
         RowBox[{
          SuperscriptBox["z", "2"], 
          SuperscriptBox["ks", "2"]}], "+", "f"}]], "=", 
       RowBox[{
        FractionBox["1", "f"], "-", 
        FormBox[
         RowBox[{
          FractionBox["1", "f"], 
          SuperscriptBox["z", "2"], 
          SuperscriptBox["ks", "2"], 
          FractionBox["1", "f"]}],
         TraditionalForm]}]}],
      TraditionalForm], "+", 
     RowBox[{"O", 
      RowBox[{"(", 
       SuperscriptBox["ks", "4"], ")"}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"a_", ",", 
          RowBox[{"ks", "[", "L", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"a", ",", 
           RowBox[{"k", "[", "1", "]"}]}], "]"}], "+", 
         RowBox[{"sc", "[", 
          RowBox[{"a", ",", 
           RowBox[{"k", "[", "2", "]"}]}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"a_", ",", 
          RowBox[{"ks", "[", "R", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"sc", "[", 
           RowBox[{"a", ",", 
            RowBox[{"k", "[", "3", "]"}]}], "]"}]}], "-", 
         RowBox[{"sc", "[", 
          RowBox[{"a", ",", 
           RowBox[{"k", "[", "4", "]"}]}], "]"}]}]}]}], "}"}]}], "/.", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"k", "[", "i_", "]"}], ",", 
       RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"e", "[", "i_", "]"}], ",", 
      RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"%", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"k", "[", "1", "]"}], ",", 
              RowBox[{"k", "[", "2", "]"}]}], "]"}], "->", 
            RowBox[{
             RowBox[{"1", "/", "2"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ks", "^", "2"}], "-", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"k", "[", "1", "]"}], ",", 
                 RowBox[{"k", "[", "1", "]"}]}], "]"}], "-", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"k", "[", "2", "]"}], ",", 
                 RowBox[{"k", "[", "2", "]"}]}], "]"}]}], ")"}]}]}], ",", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"k", "[", "3", "]"}], ",", 
              RowBox[{"k", "[", "4", "]"}]}], "]"}], "->", 
            RowBox[{
             RowBox[{"1", "/", "2"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ks", "^", "2"}], "-", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"k", "[", "3", "]"}], ",", 
                 RowBox[{"k", "[", "3", "]"}]}], "]"}], "-", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"k", "[", "4", "]"}], ",", 
                 RowBox[{"k", "[", "4", "]"}]}], "]"}]}], ")"}]}]}], ",", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"k", "[", "1", "]"}], ",", 
              RowBox[{"k", "[", "4", "]"}]}], "]"}], "->", 
            RowBox[{
             RowBox[{"1", "/", "2"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"kt", "^", "2"}], "-", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"k", "[", "1", "]"}], ",", 
                 RowBox[{"k", "[", "1", "]"}]}], "]"}], "-", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"k", "[", "4", "]"}], ",", 
                 RowBox[{"k", "[", "4", "]"}]}], "]"}]}], ")"}]}]}], ",", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"k", "[", "2", "]"}], ",", 
              RowBox[{"k", "[", "3", "]"}]}], "]"}], "->", 
            RowBox[{
             RowBox[{"1", "/", "2"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"kt", "^", "2"}], "-", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"k", "[", "3", "]"}], ",", 
                 RowBox[{"k", "[", "3", "]"}]}], "]"}], "-", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"k", "[", "2", "]"}], ",", 
                 RowBox[{"k", "[", "2", "]"}]}], "]"}]}], ")"}]}]}], ",", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"k", "[", "1", "]"}], ",", 
              RowBox[{"k", "[", "3", "]"}]}], "]"}], "->", 
            RowBox[{
             RowBox[{"1", "/", "2"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ku", "^", "2"}], "-", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"k", "[", "1", "]"}], ",", 
                 RowBox[{"k", "[", "1", "]"}]}], "]"}], "-", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"k", "[", "3", "]"}], ",", 
                 RowBox[{"k", "[", "3", "]"}]}], "]"}]}], ")"}]}]}], ",", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"k", "[", "2", "]"}], ",", 
              RowBox[{"k", "[", "4", "]"}]}], "]"}], "->", 
            RowBox[{
             RowBox[{"1", "/", "2"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ku", "^", "2"}], "-", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"k", "[", "2", "]"}], ",", 
                 RowBox[{"k", "[", "2", "]"}]}], "]"}], "-", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"k", "[", "4", "]"}], ",", 
                 RowBox[{"k", "[", "4", "]"}]}], "]"}]}], ")"}]}]}]}], 
          "}"}]}], "/.", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"k", "[", "i_", "]"}], ",", 
           RowBox[{"k", "[", "i_", "]"}]}], "]"}], ":>", 
         SuperscriptBox[
          RowBox[{"k", "[", "i", "]"}], "2"]}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i_", "]"}], ",", 
           RowBox[{"k", "[", "1", "]"}]}], "]"}], ":>", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "i", "]"}], ",", 
             RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "-", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], ",", 
            RowBox[{"k", "[", "3", "]"}]}], "]"}], "-", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], ",", 
            RowBox[{"k", "[", "4", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"k", "[", "i_", "]"}], ",", 
         RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i_", "]"}], ",", 
        RowBox[{"k", "[", "4", "]"}]}], "]"}], ":>", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "i", "]"}], ",", 
          RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "-", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "i", "]"}], ",", 
         RowBox[{"k", "[", "3", "]"}]}], "]"}], "-", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "i", "]"}], ",", 
         RowBox[{"k", "[", "1", "]"}]}], "]"}]}]}]}], "/.", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"k", "[", "i_", "]"}], ",", 
       RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", 
   "momconser4pt"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MGR1234c", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{"%", ",", "ks", ",", "Simplify"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.918456510270384*^9},
 CellLabel->
  "In[205]:=",ExpressionUUID->"14252b37-952b-4df7-a2bd-ef8458bfc8c0"],

Cell["exactly what we get ", "Text",
 CellChangeTimes->{{3.9185854941749363`*^9, 
  3.918585496800327*^9}},ExpressionUUID->"b7777d6d-2514-4c64-9482-\
f0412a8622f9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MGR1234c", "-", 
     RowBox[{"a1GR4", "[", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}]}], "/.", 
    RowBox[{
     RowBox[{"ks", "[", 
      RowBox[{"1", ",", "2"}], "]"}], "->", "ks"}]}], "/.", 
   RowBox[{
    RowBox[{"ks", "[", 
     RowBox[{"2", ",", "3"}], "]"}], "->", "kt"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.9185854562873945`*^9, 3.918585486618579*^9}},
 CellLabel->
  "In[214]:=",ExpressionUUID->"bb9ca49a-ee87-4717-b671-a121682e6ea9"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.9185854613310413`*^9, 3.9185854868168316`*^9}, {
   3.937045790458161*^9, 3.9370458181597223`*^9}, 3.93704590646749*^9, 
   3.9370466013981705`*^9},
 CellLabel->
  "Out[214]=",ExpressionUUID->"aed8fcd7-cd7d-4f32-a091-cf58312417f7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["b1234: ope limit", "Subsection",
 CellChangeTimes->{{3.918457275678068*^9, 3.918457277272438*^9}, {
  3.9370465280611043`*^9, 
  3.93704653009284*^9}},ExpressionUUID->"1abb531b-5dab-4b68-b7b1-\
6d68d5f62535"],

Cell[CellGroupData[{

Cell[TextData[{
 "ks^-4: which is ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["b", "a"], 
    RowBox[{"(", "4", ")"}]], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d3093cda-e238-4140-8e2c-760a120fb3f2"]
}], "Subsubsection",
 CellChangeTimes->{{3.911387436906502*^9, 3.91138743780468*^9}, {
  3.918642300218594*^9, 
  3.9186423085399785`*^9}},ExpressionUUID->"8cb05b2c-c5ed-49be-81af-\
133f7137fa68"],

Cell[BoxData[
 RowBox[{"this", " ", "is", " ", "the", "  ", "starting", " ", "point", " ", 
  "for", " ", 
  SuperscriptBox["ks", 
   RowBox[{"-", "4"}]]}]], "Text",
 CellChangeTimes->{{3.9114713077263165`*^9, 
  3.9114713234155293`*^9}},ExpressionUUID->"d9506f47-2a2f-45f1-a147-\
4f2c18c2a5c3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MGR1234k41", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"MGR1234c", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"2", "  ", 
           RowBox[{"(", 
            RowBox[{"2", "+", "d", "-", 
             RowBox[{"2", " ", 
              RowBox[{"s", "[", "12", "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"s", "[", "12", "]"}]}], ")"}]}]], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"4", " ", 
              RowBox[{"(", 
               RowBox[{"2", "+", "d", "-", 
                RowBox[{"2", " ", 
                 RowBox[{"s", "[", "12", "]"}]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"4", "+", "d", "-", 
                RowBox[{"2", " ", 
                 RowBox[{"s", "[", "12", "]"}]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", 
                RowBox[{"s", "[", "12", "]"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"s", "[", "12", "]"}]}], ")"}]}], ")"}]}], ")"}], 
          SuperscriptBox["z1", "2"], 
          SuperscriptBox["ks", "2"]}]}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ks", ",", "0", ",", 
        RowBox[{"-", "4"}]}], "}"}]}], "]"}], "//", "Normal"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.911499572074686*^9, 3.911499622371352*^9}, 
   3.9184572882875786`*^9, 3.918583736881505*^9, {3.918585516275919*^9, 
   3.918585518035328*^9}},
 CellLabel->
  "In[215]:=",ExpressionUUID->"27cf859e-e413-4005-b955-bd8e5121a844"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
   SuperscriptBox["z1", "4"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"k", "[", "1", "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{"k", "[", "2", "]"}], "2"]}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"k", "[", "3", "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"e", "[", "1", "]"}], ",", 
      RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"e", "[", "3", "]"}], ",", 
      RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
  RowBox[{"32", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
   SuperscriptBox["ks", "4"], " ", 
   RowBox[{"(", 
    RowBox[{"2", "+", "d", "-", 
     RowBox[{"2", " ", 
      RowBox[{"s", "[", "12", "]"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"s", "[", "12", "]"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.911399791884946*^9, 3.91140687220718*^9, 3.9114094837854023`*^9, 
   3.911464342072728*^9, {3.9114966376885614`*^9, 3.911496665848735*^9}, {
   3.9114995728517213`*^9, 3.9114996231551347`*^9}, 3.9184573253171463`*^9, 
   3.918583699313985*^9, {3.9185837317033577`*^9, 3.918583739207694*^9}, 
   3.91858552807115*^9, 3.937045822449565*^9, 3.9370459067526093`*^9, 
   3.937046601678755*^9},
 CellLabel->
  "Out[215]=",ExpressionUUID->"d37ad9c8-35d4-4fa8-afa0-2a7372c690a4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MGR1234k4", "=", 
  RowBox[{
   RowBox[{"SeriesCoefficient", "[", 
    RowBox[{"MGR1234k41", ",", 
     RowBox[{"{", 
      RowBox[{"ks", ",", "0", ",", 
       RowBox[{"-", "4"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"k", "[", "i_", "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"k", "[", "j_", "]"}], "2"]}], ")"}], "2"], " ", "->", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"k", "[", "i", "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"k", "[", "j", "]"}], "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"kk", "[", "i", "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"kk", "[", "j", "]"}], "2"]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"%", "/.", 
              RowBox[{
               RowBox[{"s", "[", "12", "]"}], "->", 
               RowBox[{
                RowBox[{"s", "[", "12", "]"}], "+", "1"}]}]}], "/.", 
             RowBox[{"Onshellc", "[", 
              RowBox[{"d", ",", 
               RowBox[{"k", "[", "1", "]"}], ",", "z1"}], "]"}]}], "/.", 
            RowBox[{"Onshellc", "[", 
             RowBox[{"d", ",", 
              RowBox[{"k", "[", "2", "]"}], ",", "z1"}], "]"}]}], "/.", 
           RowBox[{"Onshellc", "[", 
            RowBox[{"d", ",", 
             RowBox[{"k", "[", "3", "]"}], ",", "z1"}], "]"}]}], "/.", 
          RowBox[{"Onshellc", "[", 
           RowBox[{"d", ",", 
            RowBox[{"k", "[", "4", "]"}], ",", "z1"}], "]"}]}], "//", 
         "Simplify"}], "//", 
        RowBox[{
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"s", "[", "i_", "]"}], "2"], "-", 
             SuperscriptBox[
              RowBox[{"s", "[", "j_", "]"}], "2"]}], "->", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"s", "[", "i", "]"}], "+", 
               RowBox[{"s", "[", "j", "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"s", "[", "i", "]"}], "-", 
               RowBox[{"s", "[", "j", "]"}]}], ")"}]}]}]}], "]"}], "&"}]}], "//", 
       RowBox[{
        RowBox[{"ReplaceAll", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Rule", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", "3", "]"}], "+", 
             RowBox[{"s", "[", "4", "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"s", "[", "3", "]"}], "+", 
              RowBox[{"s", "[", "4", "]"}]}], "/.", "s4k0rl"}]}], "]"}]}], 
         "]"}], "&"}]}], "//", 
      RowBox[{
       RowBox[{"ReplaceAll", "[", 
        RowBox[{"#", ",", 
         RowBox[{
          RowBox[{"s", "[", "12", "]"}], "->", 
          RowBox[{
           RowBox[{"s", "[", "1", "]"}], "+", 
           RowBox[{"s", "[", "2", "]"}]}]}]}], "]"}], "&"}]}], "//", 
     "Simplify"}], "//", 
    RowBox[{
     RowBox[{"ReplaceAll", "[", 
      RowBox[{"#", ",", 
       RowBox[{"a", "->", "1"}]}], "]"}], "&"}]}], "//", 
   RowBox[{
    RowBox[{"ReplaceAll", "[", 
     RowBox[{"#", ",", 
      RowBox[{"kk", "->", "k"}]}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"baProcess", "=", 
  FractionBox["%", 
   SuperscriptBox["ks", "4"]]}]}], "Input",
 CellChangeTimes->{{3.9104402682523456`*^9, 3.910440318667507*^9}, {
   3.910440685701734*^9, 3.910440712292946*^9}, {3.910440751483296*^9, 
   3.910440755632529*^9}, {3.911030128482476*^9, 3.911030136195197*^9}, 
   3.911030180806493*^9, 3.9110309504536*^9, 3.9110318850052195`*^9, {
   3.9113840694020586`*^9, 3.9113840935425615`*^9}, {3.9113841693132377`*^9, 
   3.9113841706778574`*^9}, {3.911384375385565*^9, 3.9113844442107735`*^9}, {
   3.9113845689358144`*^9, 3.911384583650196*^9}, {3.9113846368839426`*^9, 
   3.911384642990988*^9}, {3.9113846953107476`*^9, 3.9113847014008408`*^9}, {
   3.9113871656810627`*^9, 3.9113871662342663`*^9}, {3.9114732941905813`*^9, 
   3.911473295267482*^9}, 3.9114965868654118`*^9, {3.9114966850835094`*^9, 
   3.911496704568225*^9}, {3.9114967345705476`*^9, 3.9114967355092545`*^9}, {
   3.9114967905403357`*^9, 3.9114967919298816`*^9}, {3.911496871883298*^9, 
   3.9114968910230722`*^9}, 3.9114969778655386`*^9, {3.91149702302815*^9, 
   3.91149706197686*^9}, 3.911497136821594*^9, 3.9114976074956427`*^9, 
   3.918457295014532*^9, {3.9185834501578693`*^9, 3.9185834938577394`*^9}, {
   3.918583701237875*^9, 3.9185837478000774`*^9}, {3.918644567970378*^9, 
   3.9186445777218046`*^9}},
 CellLabel->
  "In[216]:=",ExpressionUUID->"8be01935-be53-4f07-aafb-ddb299ec200d"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
   SuperscriptBox["z1", "4"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"k", "[", "1", "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{"k", "[", "2", "]"}], "2"]}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"k", "[", "3", "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"e", "[", "1", "]"}], ",", 
      RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"e", "[", "3", "]"}], ",", 
      RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
  RowBox[{"32", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"2", "+", "d", "-", 
     RowBox[{"2", " ", 
      RowBox[{"s", "[", "12", "]"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"s", "[", "12", "]"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.9113845841488633`*^9, 3.9113846436051693`*^9, {3.9113846974839993`*^9, 
   3.911384701736825*^9}, 3.9113848173382673`*^9, 3.91138498549293*^9, 
   3.911385888656584*^9, 3.9113860585528336`*^9, 3.911386460594984*^9, 
   3.911387167270647*^9, 3.911406872814287*^9, 3.911409484009696*^9, 
   3.911464342763888*^9, 3.9114644292726126`*^9, 3.911473295789811*^9, {
   3.911496596184882*^9, 3.9114966220056686`*^9}, 3.9114966679946227`*^9, {
   3.911496728221753*^9, 3.911496735784505*^9}, 3.911496795338416*^9, {
   3.9114970240817585`*^9, 3.9114970621366224`*^9}, 3.911497137308923*^9, 
   3.911497607924492*^9, {3.911497667833155*^9, 3.911497679460224*^9}, 
   3.9184573255439544`*^9, {3.918583486768483*^9, 3.918583494172308*^9}, {
   3.918583673497467*^9, 3.918583701586194*^9}, {3.918583732692521*^9, 
   3.918583748112151*^9}, 3.918585532536725*^9, {3.918644568280585*^9, 
   3.9186445779285564`*^9}, 3.937045822739586*^9, 3.9370459069982853`*^9, 
   3.937046601933243*^9},
 CellLabel->
  "Out[216]=",ExpressionUUID->"216fede7-bd61-435b-823e-1358770bdb93"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"k", "[", "1", "]"}], "2"], "-", 
     SuperscriptBox[
      RowBox[{"k", "[", "2", "]"}], "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"k", "[", "3", "]"}], "2"], "-", 
     SuperscriptBox[
      RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"s", "[", "1", "]"}], "-", 
     RowBox[{"s", "[", "2", "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"s", "[", "3", "]"}], "-", 
     RowBox[{"s", "[", "4", "]"}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"e", "[", "1", "]"}], ",", 
      RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"e", "[", "3", "]"}], ",", 
      RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
  RowBox[{"4", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
   SuperscriptBox["ks", "4"]}]]], "Output",
 CellChangeTimes->{
  3.9113845841488633`*^9, 3.9113846436051693`*^9, {3.9113846974839993`*^9, 
   3.911384701736825*^9}, 3.9113848173382673`*^9, 3.91138498549293*^9, 
   3.911385888656584*^9, 3.9113860585528336`*^9, 3.911386460594984*^9, 
   3.911387167270647*^9, 3.911406872814287*^9, 3.911409484009696*^9, 
   3.911464342763888*^9, 3.9114644292726126`*^9, 3.911473295789811*^9, {
   3.911496596184882*^9, 3.9114966220056686`*^9}, 3.9114966679946227`*^9, {
   3.911496728221753*^9, 3.911496735784505*^9}, 3.911496795338416*^9, {
   3.9114970240817585`*^9, 3.9114970621366224`*^9}, 3.911497137308923*^9, 
   3.911497607924492*^9, {3.911497667833155*^9, 3.911497679460224*^9}, 
   3.9184573255439544`*^9, {3.918583486768483*^9, 3.918583494172308*^9}, {
   3.918583673497467*^9, 3.918583701586194*^9}, {3.918583732692521*^9, 
   3.918583748112151*^9}, 3.918585532536725*^9, {3.918644568280585*^9, 
   3.9186445779285564`*^9}, 3.937045822739586*^9, 3.9370459069982853`*^9, 
   3.9370466021567926`*^9},
 CellLabel->
  "Out[219]=",ExpressionUUID->"26fbec72-af28-49d4-90e4-8aee50e58fee"]
}, Open  ]],

Cell["so", "Text",
 CellChangeTimes->{{3.918583765248919*^9, 
  3.9185837653271074`*^9}},ExpressionUUID->"1f4d14e1-a9f0-49a9-8904-\
bb83ca227929"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"baGR1234", "[", 
   RowBox[{
   "z1", ",", "ks", ",", "k1", ",", "k2", ",", "k3", ",", "k4", ",", "e1", 
    ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", "s2", ",", "s3", ",", 
    "s4"}], "]"}], "/.", "rulesinv"}]], "Input",
 CellChangeTimes->{3.918462941915409*^9},
 CellLabel->
  "In[220]:=",ExpressionUUID->"e6dd20d5-3760-49b5-86f6-93f2efe336b4"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"k", "[", "1", "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{"k", "[", "2", "]"}], "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"k", "[", "3", "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"s", "[", "1", "]"}], "-", 
      RowBox[{"s", "[", "2", "]"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"s", "[", "3", "]"}], "-", 
      RowBox[{"s", "[", "4", "]"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
    SuperscriptBox["ks", "4"]}]]}]], "Output",
 CellChangeTimes->{3.9184579210222707`*^9, 3.918462947190605*^9, 
  3.9370458232126045`*^9, 3.937045907498746*^9, 3.937046602395874*^9},
 CellLabel->
  "Out[220]=",ExpressionUUID->"e4a912ff-8bef-4740-9c77-3a7a5c6bd106"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 FractionBox["baProcess", 
  RowBox[{
   RowBox[{"baGR1234", "[", 
    RowBox[{
    "z1", ",", "ks", ",", "k1", ",", "k2", ",", "k3", ",", "k4", ",", "e1", 
     ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", "s2", ",", "s3", ",", 
     "s4"}], "]"}], "/.", "rulesinv"}]]], "Input",
 CellChangeTimes->{{3.9186445838591013`*^9, 3.918644583995539*^9}},
 CellLabel->
  "In[221]:=",ExpressionUUID->"22a34f2c-5f0e-4bb2-a9ce-b79069e1fddd"],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellChangeTimes->{3.918644584313238*^9, 3.9370458234679594`*^9, 
  3.93704590777575*^9, 3.9370466026839848`*^9},
 CellLabel->
  "Out[221]=",ExpressionUUID->"efc13619-91cb-4be2-abd8-d7345af6f478"]
}, Open  ]],

Cell["\<\
the - 1 means we have to substract to cancel the OPE pole in ks -> 0 limit
So quick check:\
\>", "Text",
 CellChangeTimes->{{3.918583796024811*^9, 3.9185837972823615`*^9}, {
  3.9186445993000793`*^9, 
  3.918644603390365*^9}},ExpressionUUID->"e88d2647-94a2-48eb-9522-\
443e627b01b9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"aGR1234", "[", 
               RowBox[{
               "z1", ",", "ks", ",", "k1", ",", "k2", ",", "k3", ",", "k4", 
                ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
                "s2", ",", "s3", ",", "s4"}], "]"}], "/.", "rulesinv"}], 
             ")"}], "+", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 FractionBox["MGR1234c", 
                  SubscriptBox["D", "ks"]], "/.", " ", 
                 RowBox[{
                  FractionBox["1", 
                   SubscriptBox["D", "ks"]], "->", 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", 
                    RowBox[{"2", "  ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", "d", "-", 
                    RowBox[{"2", " ", 
                    RowBox[{"s", "[", "12", "]"}]}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"s", "[", "12", "]"}]}], ")"}]}]], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"4", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", "d", "-", 
                    RowBox[{"2", " ", 
                    RowBox[{"s", "[", "12", "]"}]}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "+", "d", "-", 
                    RowBox[{"2", " ", 
                    RowBox[{"s", "[", "12", "]"}]}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    RowBox[{"s", "[", "12", "]"}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"s", "[", "12", "]"}]}], ")"}]}], ")"}]}], ")"}], 
                    SuperscriptBox["z1", "2"], 
                    SuperscriptBox["ks", "2"]}]}], ")"}]}]}], "//", 
                RowBox[{
                 RowBox[{"Series", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"{", 
                    RowBox[{"ks", ",", "0", ",", 
                    RowBox[{"-", "4"}]}], "}"}]}], "]"}], "&"}]}], "//", 
               "Normal"}], "//", "Simplify"}], ")"}]}], "/.", 
           RowBox[{
            RowBox[{"s", "[", "12", "]"}], "->", 
            RowBox[{
             RowBox[{"s", "[", "1", "]"}], "+", 
             RowBox[{"s", "[", "2", "]"}]}]}]}], "//", "Expand"}], "//", 
         RowBox[{
          RowBox[{"ReplaceAll", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"k", "[", "x_", "]"}], "4"], "->", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"k", "[", "x", "]"}], "2"], 
              SuperscriptBox[
               RowBox[{"kk", "[", "x", "]"}], "2"]}]}]}], "]"}], "&"}]}], "//",
         "scanK2sOnshelllistmap"}], "//", 
       RowBox[{
        RowBox[{"ReplaceAll", "[", 
         RowBox[{"#", ",", 
          RowBox[{"kk", "->", "k"}]}], "]"}], "&"}]}], "//", "Expand"}], "//",
      "scanK2sOnshelllistmap"}], "//", 
    RowBox[{
     RowBox[{"scanMelindeltalistvar", "[", 
      RowBox[{"#", ",", 
       RowBox[{"s", "[", "1", "]"}]}], "]"}], "&"}]}], "//", "Simplify"}], "//",
   "Simplify"}]], "Input",
 CellChangeTimes->{
  3.9114995618606668`*^9, {3.911539826470564*^9, 3.911539881785628*^9}, 
   3.9115399419592443`*^9, 3.911540051155211*^9, {3.9115416741889496`*^9, 
   3.9115417090490475`*^9}, 3.9184572996559553`*^9, 3.918585428926026*^9, 
   3.9185855586921797`*^9},
 CellLabel->
  "In[222]:=",ExpressionUUID->"34693741-b222-4d40-9744-f15228479f17"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.911539837721353*^9, 3.9115398582329636`*^9}, 
   3.911539929862805*^9, {3.911540049048172*^9, 3.911540051641768*^9}, {
   3.9115416718937984`*^9, 3.911541709894185*^9}, 3.9184573266403475`*^9, 
   3.918585442204048*^9, 3.9185855412934413`*^9, 3.937045823979824*^9, 
   3.9370459082507505`*^9, 3.93704660313526*^9},
 CellLabel->
  "Out[222]=",ExpressionUUID->"191a2ae9-4a3e-4951-bd0c-68721682887f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["b1234 ks^-2 prepare", "Subsubsection",
 CellChangeTimes->{{3.9184660075126295`*^9, 3.9184660081286416`*^9}, {
  3.9185837991594586`*^9, 3.918583801210517*^9}, {3.9186423157982483`*^9, 
  3.9186423183776503`*^9}},ExpressionUUID->"ae19a3ec-f69f-4bff-83d3-\
13ece32abf81"],

Cell["\<\
note that MGR1234c is the same as a4GR[1,2,3,4] or \
aGR1234[z1,ks,k1,k2,k3,k4,e1,e2,e3,e4,s1,s2,s3,s4]\
\>", "Text",
 CellChangeTimes->{{3.918642159377039*^9, 
  3.918642172725726*^9}},ExpressionUUID->"c41ff6f7-f79f-4229-aeba-\
8ca4703d6c1c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MGR1234k42", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{
      RowBox[{"MGR1234c", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"2", "  ", 
           RowBox[{"(", 
            RowBox[{"2", "+", "d", "-", 
             RowBox[{"2", " ", 
              RowBox[{"s", "[", "12", "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"s", "[", "12", "]"}]}], ")"}]}]], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"4", " ", 
              RowBox[{"(", 
               RowBox[{"2", "+", "d", "-", 
                RowBox[{"2", " ", 
                 RowBox[{"s", "[", "12", "]"}]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"4", "+", "d", "-", 
                RowBox[{"2", " ", 
                 RowBox[{"s", "[", "12", "]"}]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", 
                RowBox[{"s", "[", "12", "]"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"s", "[", "12", "]"}]}], ")"}]}], ")"}]}], ")"}], 
          SuperscriptBox["z1", "2"], 
          SuperscriptBox["ks", "2"]}]}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ks", ",", "0", ",", 
        RowBox[{"-", "2"}]}], "}"}]}], "]"}], "//", "Normal"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.918584865863558*^9, 3.918584887394821*^9}},
 CellLabel->
  "In[223]:=",ExpressionUUID->"19721de3-c5bf-4cd1-aa2b-aa60d71c10dc"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"64", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", "d", "-", 
      RowBox[{"2", " ", 
       RowBox[{"s", "[", "12", "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"s", "[", "12", "]"}]}], ")"}]}]], 
  RowBox[{
   SuperscriptBox["z1", "4"], " ", 
   RowBox[{"sc", "[", 
    RowBox[{
     RowBox[{"e", "[", "1", "]"}], ",", 
     RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"sc", "[", 
    RowBox[{
     RowBox[{"e", "[", "3", "]"}], ",", 
     RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
        SuperscriptBox["z1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"k", "[", "1", "]"}], "2"], "-", 
           SuperscriptBox[
            RowBox[{"k", "[", "2", "]"}], "2"]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"k", "[", "3", "]"}], "2"], "-", 
           SuperscriptBox[
            RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}], "2"], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"4", "+", "d", "-", 
          RowBox[{"2", " ", 
           RowBox[{"s", "[", "12", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"s", "[", "12", "]"}]}], ")"}]}]]}], "-", 
     RowBox[{"16", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"k", "[", "1", "]"}], "2"], "-", 
        SuperscriptBox[
         RowBox[{"k", "[", "2", "]"}], "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"k", "[", "3", "]"}], "2"], "-", 
        SuperscriptBox[
         RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], ",", 
           RowBox[{"k", "[", "3", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "1", "]"}], ",", 
              RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "3", "]"}], ",", 
                RowBox[{"k", "[", "1", "]"}]}], "]"}], "+", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "3", "]"}], ",", 
                RowBox[{"k", "[", "2", "]"}]}], "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "1", "]"}], ",", 
              RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "4", "]"}], ",", 
              RowBox[{"k", "[", "3", "]"}]}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], ",", 
           RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "2", "]"}], ",", 
               RowBox[{"k", "[", "3", "]"}]}], "]"}]}], " ", 
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "3", "]"}], ",", 
              RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "2", "]"}], ",", 
              RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "3", "]"}], ",", 
                RowBox[{"k", "[", "1", "]"}]}], "]"}], "+", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "3", "]"}], ",", 
                RowBox[{"k", "[", "2", "]"}]}], "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "2", "]"}], ",", 
              RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "4", "]"}], ",", 
              RowBox[{"k", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
     "+", 
     RowBox[{"4", " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"k", "[", "1", "]"}], "4"], " ", 
            SuperscriptBox[
             RowBox[{"k", "[", "4", "]"}], "2"]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
            SuperscriptBox["kt", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"k", "[", "1", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"k", "[", "2", "]"}], "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"k", "[", "3", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"k", "[", "2", "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"k", "[", "3", "]"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"k", "[", "2", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"k", "[", "3", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}]}], "+", 
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"k", "[", "1", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"k", "[", "2", "]"}], "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"k", "[", "3", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"k", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"k", "[", "2", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"k", "[", "3", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"k", "[", "1", "]"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"k", "[", "4", "]"}], "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"k", "[", "3", "]"}], "2"], "-", 
                 SuperscriptBox[
                  RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}]}], "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"k", "[", "2", "]"}], "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"k", "[", "3", "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}]}]}], ")"}]}]}], 
          ")"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"k", "[", "1", "]"}], "2"], "-", 
           SuperscriptBox[
            RowBox[{"k", "[", "2", "]"}], "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"k", "[", "3", "]"}], "2"], "-", 
           SuperscriptBox[
            RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "3", "]"}], ",", 
              RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "4", "]"}], ",", 
              RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "3", "]"}], ",", 
              RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "4", "]"}], ",", 
                RowBox[{"k", "[", "2", "]"}]}], "]"}], "+", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "4", "]"}], ",", 
                RowBox[{"k", "[", "3", "]"}]}], "]"}]}], ")"}]}]}], ")"}]}]}],
        ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.918584867586626*^9, 3.918584888539648*^9}, 
   3.9185855805565133`*^9, 3.918640708148647*^9, 3.937045835702182*^9, 
   3.9370459086864233`*^9, 3.9370466037057395`*^9},
 CellLabel->
  "Out[223]=",ExpressionUUID->"f2b61348-5392-4772-a615-0f424bbdec1f"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pi11", "=", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"k", "[", "1", "]"}], ",", 
      RowBox[{"k", "[", "3", "]"}]}], "]"}], "-", 
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"k", "[", "1", "]"}], ",", 
      RowBox[{"k", "[", "4", "]"}]}], "]"}], "-", 
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"k", "[", "2", "]"}], ",", 
      RowBox[{"k", "[", "3", "]"}]}], "]"}], "+", 
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"k", "[", "2", "]"}], ",", 
      RowBox[{"k", "[", "4", "]"}]}], "]"}], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"k", "[", "1", "]"}], "2"], "-", 
        SuperscriptBox[
         RowBox[{"k", "[", "2", "]"}], "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"k", "[", "3", "]"}], "2"], "-", 
        SuperscriptBox[
         RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}]}], 
     SuperscriptBox[
      RowBox[{"k", "[", "s", "]"}], "2"]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pi10", "=", 
   FractionBox[
    RowBox[{"4", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"s", "[", "1", "]"}], "-", 
       RowBox[{"s", "[", "2", "]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"s", "[", "3", "]"}], "-", 
       RowBox[{"s", "[", "4", "]"}]}], ")"}]}], 
    RowBox[{
     SuperscriptBox["z", "2"], 
     SuperscriptBox[
      RowBox[{"k", "[", "s", "]"}], "2"]}]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"pi22trace", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      RowBox[{"d", "-", "1"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"k", "[", "1", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"k", "[", "2", "]"}], "2"], "-", 
         RowBox[{"2", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"k", "[", "1", "]"}], ",", 
            RowBox[{"k", "[", "2", "]"}]}], "]"}]}]}], ")"}], "-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"k", "[", "1", "]"}], "2"], "-", 
           SuperscriptBox[
            RowBox[{"k", "[", "2", "]"}], "2"]}], ")"}], "2"], 
        SuperscriptBox[
         RowBox[{"k", "[", "s", "]"}], "2"]]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"k", "[", "3", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"k", "[", "4", "]"}], "2"], "-", 
         RowBox[{"2", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"k", "[", "3", "]"}], ",", 
            RowBox[{"k", "[", "4", "]"}]}], "]"}]}]}], ")"}], "-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"k", "[", "3", "]"}], "2"], "-", 
           SuperscriptBox[
            RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}], "2"], 
        SuperscriptBox[
         RowBox[{"k", "[", "s", "]"}], "2"]]}], ")"}]}], "/.", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"k", "[", "i_", "]"}], ",", 
       RowBox[{"k", "[", "j_", "]"}]}], "]"}], ":>", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"k", "[", "s", "]"}], "2"], "-", 
        SuperscriptBox[
         RowBox[{"k", "[", "i", "]"}], "2"], "-", 
        SuperscriptBox[
         RowBox[{"k", "[", "j", "]"}], "2"]}], ")"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pi22DC", "=", 
   RowBox[{"pi11", " ", "pi11"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.90886717974673*^9, 3.9088672124462037`*^9}, 
   3.9088672620289583`*^9, {3.9088699504791136`*^9, 3.9088699554805264`*^9}, {
   3.908869990354164*^9, 3.908869993857766*^9}, {3.9088700433111916`*^9, 
   3.9088700629808083`*^9}, {3.908870334755124*^9, 3.9088703421297803`*^9}},
 CellLabel->
  "In[224]:=",ExpressionUUID->"b2728954-7393-47d8-aa47-42fe721010e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MGR1234k42g", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MGR1234k42", "//", "scToks"}], "//", 
      RowBox[{"ReplaceAll", "[", "AdS4ptmy", "]"}]}], "//", 
     RowBox[{"ReplaceAll", "[", 
      RowBox[{
       RowBox[{"k", "[", "s", "]"}], "->", 
       RowBox[{"ks", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], "]"}]}], "//", "Simplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.9186417356915555`*^9, {3.918641862965816*^9, 3.91864186380523*^9}, 
   3.918642056232707*^9},
 CellLabel->
  "In[228]:=",ExpressionUUID->"3dac3144-de4c-4b54-81e7-e28a2efc5f9e"],

Cell["it is good to first separate out the e12e34^2 part", "Text",
 CellChangeTimes->{{3.9186420635853634`*^9, 
  3.918642101082801*^9}},ExpressionUUID->"fe36103d-2086-4665-b7f1-\
e3312aab1bd2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MGR1234k42ge12e34", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox[
            SuperscriptBox["z1", "4"], "16"], " ", 
           SuperscriptBox[
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "1", "]"}], ",", 
              RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "3", "]"}], ",", 
              RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{"pi22DC", "-", "pi22trace"}], ")"}]}], "//", "scToks"}], "//", 
         RowBox[{"ReplaceAll", "[", "AdS4ptmy", "]"}]}], "//", 
        RowBox[{"ReplaceAll", "[", 
         RowBox[{
          RowBox[{"k", "[", "s", "]"}], "->", 
          RowBox[{"ks", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}], "]"}]}], "//", "Simplify"}], "//", 
      RowBox[{
       RowBox[{"SeriesCoefficient", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "/.", 
             RowBox[{
              RowBox[{"ks", "[", 
               RowBox[{"1", ",", "2"}], "]"}], "->", "ks"}]}], "/.", 
            RowBox[{
             RowBox[{"ks", "[", 
              RowBox[{"2", ",", "3"}], "]"}], "->", "kt"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"2", "  ", 
              RowBox[{"(", 
               RowBox[{"2", "+", "d", "-", 
                RowBox[{"2", " ", 
                 RowBox[{"s", "[", "12", "]"}]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"s", "[", "12", "]"}]}], ")"}]}]], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"4", " ", 
                 RowBox[{"(", 
                  RowBox[{"2", "+", "d", "-", 
                   RowBox[{"2", " ", 
                    RowBox[{"s", "[", "12", "]"}]}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"4", "+", "d", "-", 
                   RowBox[{"2", " ", 
                    RowBox[{"s", "[", "12", "]"}]}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "2"}], "+", 
                   RowBox[{"s", "[", "12", "]"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   RowBox[{"s", "[", "12", "]"}]}], ")"}]}], ")"}]}], ")"}], 
             SuperscriptBox["z1", "2"], 
             SuperscriptBox["ks", "2"]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ks", ",", "0", ",", 
           RowBox[{"-", "2"}]}], "}"}]}], "]"}], "&"}]}], "//", "Normal"}], "//",
     "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.918585199632058*^9, 3.9185852002627754`*^9}, {
  3.9186409668558836`*^9, 3.9186409769303503`*^9}, {3.9186410339218454`*^9, 
  3.918641041180237*^9}, {3.918641075633075*^9, 3.918641132397711*^9}, {
  3.918641688147897*^9, 3.918641706738297*^9}, {3.9186417616607804`*^9, 
  3.918641824524674*^9}, {3.918641921451193*^9, 3.9186419402403183`*^9}, {
  3.918642037770275*^9, 3.9186420592134075`*^9}},
 CellLabel->
  "In[229]:=",ExpressionUUID->"939e4814-3455-4802-a86d-46b3adcc1f2c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  SuperscriptBox[
   SubscriptBox["b", "ad"], 
   RowBox[{"(", "2", ")"}]], TraditionalForm]],
 FormatType->
  TraditionalForm,ExpressionUUID->"87ecd3e7-5418-4659-9b6e-a380026f941d"]], \
"Subsubsection",
 CellChangeTimes->{{3.9186422784205837`*^9, 
  3.918642292266527*^9}},ExpressionUUID->"add14767-a264-4fcb-a675-\
df7d05733644"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MGR1234k42gWs", "=", 
  RowBox[{
   RowBox[{"MGR1234k42g", "-", "MGR1234k42ge12e34"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.918641945879576*^9, 3.918641948108055*^9}, {
  3.918642106223854*^9, 3.9186421078705034`*^9}},
 CellLabel->
  "In[230]:=",ExpressionUUID->"f4df4ab3-de9c-4bd6-8bef-792efc99aeb8"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", "d", "-", 
      RowBox[{"2", " ", 
       RowBox[{"s", "[", "12", "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"s", "[", "12", "]"}]}], ")"}]}]], 
  RowBox[{
   SuperscriptBox["z1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"k", "[", "1", "]"}], "2"], "-", 
     SuperscriptBox[
      RowBox[{"k", "[", "2", "]"}], "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"k", "[", "3", "]"}], "2"], "-", 
     SuperscriptBox[
      RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}], " ", 
   RowBox[{"sc", "[", 
    RowBox[{
     RowBox[{"e", "[", "1", "]"}], ",", 
     RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"sc", "[", 
    RowBox[{
     RowBox[{"e", "[", "3", "]"}], ",", 
     RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"k", "[", "3", "]"}]}], "]"}]}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"k", "[", "1", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "4", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "4", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "4", "]"}], ",", 
        RowBox[{"k", "[", "3", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "4", "]"}], ",", 
        RowBox[{"k", "[", "3", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"k", "[", "3", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "3", "]"}], ",", 
             RowBox[{"k", "[", "1", "]"}]}], "]"}], "+", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "3", "]"}], ",", 
             RowBox[{"k", "[", "2", "]"}]}], "]"}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "4", "]"}], ",", 
           RowBox[{"k", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.918641948569587*^9, 3.918642044936244*^9, 
  3.918642108790702*^9, 3.937045852979502*^9, 3.937045909287185*^9, 
  3.9370466042938337`*^9},
 CellLabel->
  "Out[230]=",ExpressionUUID->"4c7be414-3617-4a92-aa2f-f355236c8d72"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"badProcess", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox["MGR1234k42gWs", "Ws"], "/.", 
          RowBox[{
           RowBox[{"s", "[", "12", "]"}], "->", 
           RowBox[{
            RowBox[{"s", "[", "1", "]"}], "+", 
            RowBox[{"s", "[", "2", "]"}]}]}]}], "/.", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "+", "d", "-", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"s", "[", "1", "]"}], "+", 
               RowBox[{"s", "[", "2", "]"}]}], ")"}]}]}], ")"}], ":>", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "+", "d", "-", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"s", "[", "1", "]"}], "+", 
                 RowBox[{"s", "[", "2", "]"}]}], ")"}]}]}], ")"}], "/.", 
            RowBox[{"Mellindeltamy", "[", 
             RowBox[{"4", ",", "4", ",", 
              RowBox[{"s", "[", "1", "]"}]}], "]"}]}], ")"}]}]}], "//", 
        RowBox[{
         RowBox[{"ToMinimalPolarizationVariable4", "[", 
          RowBox[{"#", ",", "1", ",", "2", ",", "3", ",", "4"}], "]"}], 
         "&"}]}], "//", 
       RowBox[{
        RowBox[{"ToMinimalPolarizationVariable4", "[", 
         RowBox[{"#", ",", "4", ",", "3", ",", "2", ",", "1"}], "]"}], 
        "&"}]}], "//", "Simplify"}], "//", "Expand"}], "//", 
    "scanK2sOnshelllistmap"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.918642152876096*^9, 3.9186421529211254`*^9}, {
   3.9186421900600634`*^9, 3.91864226158357*^9}, {3.9186423239837255`*^9, 
   3.918642334628482*^9}, 3.9186429921869917`*^9, {3.918644530509045*^9, 
   3.9186445352439833`*^9}},
 CellLabel->
  "In[231]:=",ExpressionUUID->"f73579fb-6fc2-4d07-8233-021bf378ec3e"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "Ws"], 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"s", "[", "1", "]"}], "-", 
     RowBox[{"s", "[", "2", "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"s", "[", "3", "]"}], "-", 
     RowBox[{"s", "[", "4", "]"}]}], ")"}], " ", 
   RowBox[{"sc", "[", 
    RowBox[{
     RowBox[{"e", "[", "1", "]"}], ",", 
     RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"sc", "[", 
    RowBox[{
     RowBox[{"e", "[", "3", "]"}], ",", 
     RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"k", "[", "3", "]"}]}], "]"}]}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"k", "[", "1", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "4", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "4", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "4", "]"}], ",", 
        RowBox[{"k", "[", "3", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "4", "]"}], ",", 
        RowBox[{"k", "[", "3", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"k", "[", "3", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "3", "]"}], ",", 
             RowBox[{"k", "[", "1", "]"}]}], "]"}], "+", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "3", "]"}], ",", 
             RowBox[{"k", "[", "2", "]"}]}], "]"}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "4", "]"}], ",", 
           RowBox[{"k", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.9186421964653015`*^9, {3.918642227972743*^9, 3.9186422624128494`*^9}, 
   3.9186423348263493`*^9, 3.918642992524352*^9, 3.9186445358628993`*^9, 
   3.9370458533072004`*^9, 3.9370459095878496`*^9, 3.9370466045745153`*^9},
 CellLabel->
  "Out[231]=",ExpressionUUID->"12678851-4c38-45af-a2aa-e76a9147dc3e"]
}, Open  ]],

Cell["which is just", "Text",
 CellChangeTimes->{{3.9186423532878785`*^9, 
  3.9186423555014076`*^9}},ExpressionUUID->"b820e37b-efc1-4881-b65b-\
90de1f4e037a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"badCompare", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"badGR1234", "[", 
         RowBox[{
         "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
          "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
          "s2", ",", "s3", ",", "s4"}], "]"}], "/.", "rulesinv"}], ")"}], 
      "Ws"], "//", 
     RowBox[{
      RowBox[{"ToMinimalPolarizationVariable4", "[", 
       RowBox[{"#", ",", "1", ",", "2", ",", "3", ",", "4"}], "]"}], "&"}]}], 
    "//", 
    RowBox[{
     RowBox[{"ToMinimalPolarizationVariable4", "[", 
      RowBox[{"#", ",", "4", ",", "3", ",", "2", ",", "1"}], "]"}], "&"}]}], "//",
    "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.9186423581734705`*^9, 3.918642378209492*^9}, {
  3.918644539108766*^9, 3.9186445424066086`*^9}},
 CellLabel->
  "In[232]:=",ExpressionUUID->"0c4ad358-43f0-4999-ac81-1ba29a44bc54"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     SuperscriptBox["ks", "2"], " ", "Ws"}]], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"s", "[", "1", "]"}], "-", 
      RowBox[{"s", "[", "2", "]"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"s", "[", "3", "]"}], "-", 
      RowBox[{"s", "[", "4", "]"}]}], ")"}], " ", 
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"e", "[", "1", "]"}], ",", 
      RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"e", "[", "3", "]"}], ",", 
      RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"k", "[", "3", "]"}]}], "]"}]}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", 
         RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", 
         RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"k", "[", "1", "]"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", 
         RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "4", "]"}], ",", 
         RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "4", "]"}], ",", 
         RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", 
         RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "4", "]"}], ",", 
         RowBox[{"k", "[", "3", "]"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "4", "]"}], ",", 
         RowBox[{"k", "[", "3", "]"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "2", "]"}], ",", 
            RowBox[{"k", "[", "3", "]"}]}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "3", "]"}], ",", 
            RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "2", "]"}], ",", 
            RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "3", "]"}], ",", 
              RowBox[{"k", "[", "1", "]"}]}], "]"}], "+", 
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "3", "]"}], ",", 
              RowBox[{"k", "[", "2", "]"}]}], "]"}]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "2", "]"}], ",", 
            RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "4", "]"}], ",", 
            RowBox[{"k", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.9186423599601836`*^9, 3.9186423787550073`*^9}, 
   3.918644542771643*^9, 3.937045853573741*^9, 3.937045909866233*^9, 
   3.9370466048454223`*^9},
 CellLabel->
  "Out[232]=",ExpressionUUID->"a0b0870b-630b-4eec-98f0-dbe6ae53be9f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 FractionBox[
  RowBox[{"badProcess", "/", 
   SuperscriptBox["ks", "2"]}], "badCompare"]], "Input",
 CellChangeTimes->{{3.918644550010334*^9, 3.918644551343671*^9}},
 CellLabel->
  "In[233]:=",ExpressionUUID->"0414722c-2d9e-4743-933a-bac7c772b1eb"],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellChangeTimes->{3.9186445519665527`*^9, 3.93704585381674*^9, 
  3.9370459101283054`*^9, 3.9370466051372404`*^9},
 CellLabel->
  "Out[233]=",ExpressionUUID->"c1511f83-88cd-431f-ac20-de6b83f87226"]
}, Open  ]],

Cell["", "PageBreak",
 PageBreakBelow->True,ExpressionUUID->"adf30a76-dbad-4bc0-878c-b134bf7e60e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["b", "sp"], " "}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "b6fced0a-0da9-4012-a93b-f1b28cdb6f07"],
 "and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["b", "r"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "8e6c2e80-f341-479f-9ae8-a98b66fd4090"]
}], "Subsubsection",
 CellChangeTimes->{{3.918643003972026*^9, 
  3.918643010926485*^9}},ExpressionUUID->"843eebd5-f533-41e7-872d-\
35139251b983"],

Cell[CellGroupData[{

Cell[BoxData["MGR1234k42ge12e34"], "Input",
 CellLabel->
  "In[234]:=",ExpressionUUID->"e6c7c82f-9240-4dbf-b41b-8a0221b8a71b"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"64", " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", "d", "-", 
      RowBox[{"2", " ", 
       RowBox[{"s", "[", "12", "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"s", "[", "12", "]"}]}], ")"}]}]], 
  RowBox[{
   SuperscriptBox["z1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"k", "[", "1", "]"}], "2"], "-", 
        SuperscriptBox[
         RowBox[{"k", "[", "2", "]"}], "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"k", "[", "3", "]"}], "2"], "-", 
        SuperscriptBox[
         RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SuperscriptBox["kt", "2"]}], "+", 
        SuperscriptBox[
         RowBox[{"k", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"k", "[", "2", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"k", "[", "3", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}]}], "+", 
     FractionBox[
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"k", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"k", "[", "2", "]"}], "2"]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"k", "[", "3", "]"}], "2"], "-", 
             SuperscriptBox[
              RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}], "2"]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"k", "[", "1", "]"}], "2"], "-", 
             SuperscriptBox[
              RowBox[{"k", "[", "2", "]"}], "2"]}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"k", "[", "3", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
       SuperscriptBox["z1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"k", "[", "1", "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"k", "[", "2", "]"}], "2"]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"k", "[", "3", "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}], "2"]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", "d", "-", 
         RowBox[{"2", " ", 
          RowBox[{"s", "[", "12", "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         RowBox[{"s", "[", "12", "]"}]}], ")"}]}]]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"e", "[", "1", "]"}], ",", 
      RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"e", "[", "3", "]"}], ",", 
      RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{3.9186423998493204`*^9, 3.9370459103863096`*^9, 
  3.937046605370515*^9},
 CellLabel->
  "Out[234]=",ExpressionUUID->"12c3d6f3-41c5-4a3e-85b5-63bba9871a76"]
}, Open  ]],

Cell["We split this to 4 terms:", "Text",
 CellChangeTimes->{{3.918642670052616*^9, 3.9186426755499735`*^9}, {
  3.918642728158642*^9, 
  3.918642733165072*^9}},ExpressionUUID->"8db57141-048c-45d0-9fea-\
01f3a85955dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"term1", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["z1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"k", "[", "1", "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"k", "[", "2", "]"}], "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"k", "[", "3", "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           SuperscriptBox["kt", "2"]}], "+", 
          SuperscriptBox[
           RowBox[{"k", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"k", "[", "2", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"k", "[", "3", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"64", " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "d", "-", 
        RowBox[{"2", " ", 
         RowBox[{"s", "[", "12", "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"s", "[", "12", "]"}]}], ")"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9186427367849245`*^9, 3.918642744258024*^9}},
 CellLabel->
  "In[235]:=",ExpressionUUID->"8b456eee-6fa8-4a11-8415-967feb62f299"],

Cell[BoxData[
 RowBox[{
  RowBox[{"term2", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["z1", "4"], " ", 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"k", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"k", "[", "2", "]"}], "2"]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"k", "[", "3", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}], "2"]}], ")"}]}], 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}]], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"64", " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "d", "-", 
        RowBox[{"2", " ", 
         RowBox[{"s", "[", "12", "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"s", "[", "12", "]"}]}], ")"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.918643514347333*^9, 3.918643527734378*^9}, 
   3.9186435910875998`*^9},
 CellLabel->
  "In[236]:=",ExpressionUUID->"f72814a2-2b92-41ac-9b44-e325fd624065"],

Cell[BoxData[
 RowBox[{
  RowBox[{"term3", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["z1", "4"], " ", 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"k", "[", "1", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"k", "[", "2", "]"}], "2"]}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"k", "[", "3", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}]], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"64", " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "d", "-", 
        RowBox[{"2", " ", 
         RowBox[{"s", "[", "12", "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"s", "[", "12", "]"}]}], ")"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9186435323575764`*^9, 3.9186435588099136`*^9}, 
   3.9186435916513414`*^9},
 CellLabel->
  "In[237]:=",ExpressionUUID->"444ace77-c361-427d-ad50-3bbf5964ccb5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"term4", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["z1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
          SuperscriptBox["z1", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"k", "[", "1", "]"}], "2"], "-", 
             SuperscriptBox[
              RowBox[{"k", "[", "2", "]"}], "2"]}], ")"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"k", "[", "3", "]"}], "2"], "-", 
             SuperscriptBox[
              RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}], "2"]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"4", "+", "d", "-", 
            RowBox[{"2", " ", 
             RowBox[{"s", "[", "12", "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", 
            RowBox[{"s", "[", "12", "]"}]}], ")"}]}]]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"64", " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "d", "-", 
        RowBox[{"2", " ", 
         RowBox[{"s", "[", "12", "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"s", "[", "12", "]"}]}], ")"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.918643567032503*^9, 3.91864359236798*^9}},
 CellLabel->
  "In[238]:=",ExpressionUUID->"718716b9-d708-44c1-affc-05cac766469a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
  "MGR1234k42ge12e34", "-", "term1", "-", "term2", "-", "term3", "-", 
   "term4"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.9186435974540844`*^9, 3.9186436061265965`*^9}},
 CellLabel->
  "In[239]:=",ExpressionUUID->"4af3a7f8-c42d-4d07-8ea1-cf44ae5b05b5"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.918643612297847*^9, 3.937045910682937*^9, 
  3.9370466056466527`*^9},
 CellLabel->
  "Out[239]=",ExpressionUUID->"93bfbc46-6fdc-4ae3-b554-3c0ee0bd235f"]
}, Open  ]],

Cell[TextData[{
 "term1 determines ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["b", "sp"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "156d6b57-948c-498c-a4e9-b5c91377d413"],
 " term 2 3 and 4 determine ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["b", "r"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a6c834f9-28da-4a55-bb55-e44b55a34a64"]
}], "Text",
 CellChangeTimes->{{3.9186436215316687`*^9, 
  3.9186436557229524`*^9}},ExpressionUUID->"674a3336-97f8-4311-ab12-\
1e10c54abd2f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  SuperscriptBox[
   SubscriptBox["b", "sp"], 
   RowBox[{"(", "2", ")"}]], TraditionalForm]],
 FormatType->
  TraditionalForm,ExpressionUUID->"bd23d0f3-f71a-462c-8b33-3f873b11820d"]], \
"Subsubsection",
 CellChangeTimes->{{3.9186430215707426`*^9, 
  3.9186430265958414`*^9}},ExpressionUUID->"cce52937-943c-445d-97dc-\
326633e0df9c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bspProcess", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["term1", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             SuperscriptBox["kt", "2"]}], "+", 
            SuperscriptBox[
             RowBox[{"k", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"k", "[", "2", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"k", "[", "3", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "1", "]"}], ",", 
             RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "3", "]"}], ",", 
             RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}]], "/.", 
        RowBox[{
         RowBox[{"s", "[", "12", "]"}], "->", 
         RowBox[{
          RowBox[{"s", "[", "1", "]"}], "+", 
          RowBox[{"s", "[", "2", "]"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "+", "d", "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"s", "[", "1", "]"}], "+", 
             RowBox[{"s", "[", "2", "]"}]}], ")"}]}]}], ")"}], ":>", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "+", "d", "-", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"s", "[", "1", "]"}], "+", 
               RowBox[{"s", "[", "2", "]"}]}], ")"}]}]}], ")"}], "/.", 
          RowBox[{"Mellindeltamy", "[", 
           RowBox[{"4", ",", "4", ",", 
            RowBox[{"s", "[", "1", "]"}]}], "]"}]}], ")"}]}]}], "//", 
      "Simplify"}], "//", "Expand"}], "//", "scanK2sOnshelllistmap"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.91864275707556*^9, 3.9186427853521304`*^9}, {
  3.9186428271649666`*^9, 3.918642883813429*^9}, {3.918644460811034*^9, 
  3.9186444846415186`*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"c6945eeb-f7ea-41ad-8a2c-199d15799a86"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"s", "[", "1", "]"}], "-", 
    RowBox[{"s", "[", "2", "]"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"s", "[", "3", "]"}], "-", 
    RowBox[{"s", "[", "4", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.918642766794806*^9, 3.918642786505849*^9}, {
   3.9186428362252607`*^9, 3.9186428520153065`*^9}, 3.9186428846133165`*^9, {
   3.918644466106362*^9, 3.918644488484221*^9}, 3.937045910928963*^9, 
   3.9370466059003177`*^9},
 CellLabel->
  "Out[240]=",ExpressionUUID->"29767d98-b6f1-40e2-9a42-df9a0b4591f2"]
}, Open  ]],

Cell["which is just what we have in the main text:", "Text",
 CellChangeTimes->{{3.91864295261248*^9, 
  3.9186429598979626`*^9}},ExpressionUUID->"dd5c3575-3f55-4fc7-aaa2-\
fe8ac6c8820d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bspCompare", "=", 
  FractionBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"bspGR1234", "[", 
      RowBox[{
      "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", "k4", 
       ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", "s2", ",", 
       "s3", ",", "s4"}], "]"}], "/.", "rulesinv"}], ")"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SuperscriptBox["kt", "2"]}], "+", 
      SuperscriptBox[
       RowBox[{"k", "[", "1", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"k", "[", "2", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"k", "[", "3", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}]]}]], "Input",
 CellChangeTimes->{{3.9186429208830786`*^9, 3.918642938213084*^9}, {
  3.9186444714379625`*^9, 3.9186444863672676`*^9}},
 CellLabel->
  "In[241]:=",ExpressionUUID->"a3613f1a-c6f7-4ec1-9ecc-e8b3321a0940"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"s", "[", "1", "]"}], "-", 
      RowBox[{"s", "[", "2", "]"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"s", "[", "3", "]"}], "-", 
      RowBox[{"s", "[", "4", "]"}]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["ks", "2"]}]]}]], "Output",
 CellChangeTimes->{{3.918642916213312*^9, 3.9186429393410378`*^9}, {
   3.9186444787031813`*^9, 3.918644487884761*^9}, 3.937045911254405*^9, 
   3.9370466061719103`*^9},
 CellLabel->
  "Out[241]=",ExpressionUUID->"9cf74198-c705-4923-a6c3-d2031bb6212d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 FractionBox[
  RowBox[{"bspProcess", "/", 
   SuperscriptBox["ks", "2"]}], "bspCompare"]], "Input",
 CellChangeTimes->{{3.918644490792147*^9, 3.9186445167988787`*^9}},
 CellLabel->
  "In[242]:=",ExpressionUUID->"53beb852-c2b9-4908-826a-f4594334eddb"],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellChangeTimes->{{3.9186445065690722`*^9, 3.918644517075673*^9}, 
   3.9370459115033226`*^9, 3.9370466064049096`*^9},
 CellLabel->
  "Out[242]=",ExpressionUUID->"89ff272c-5eec-4f6d-b8cb-188319649b37"]
}, Open  ]],

Cell["\<\
which is just what we have  for bsp, the - 1 means we have to substract to \
cancel the OPE pole in ks -> 0 limit\
\>", "Text",
 CellChangeTimes->{{3.918644499198545*^9, 
  3.918644505316472*^9}},ExpressionUUID->"cfb1e751-85e4-4def-bc3c-\
22db5777bb35"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  SuperscriptBox[
   SubscriptBox["b", "r"], 
   RowBox[{"(", "2", ")"}]], TraditionalForm]],
 FormatType->
  TraditionalForm,ExpressionUUID->"36032e6e-2aff-4f3b-91eb-792bd0e73f68"]], \
"Subsubsection",
 CellChangeTimes->{{3.918643673319302*^9, 
  3.918643676188492*^9}},ExpressionUUID->"db1d747e-764c-4477-bfce-\
8b73d1d259ac"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"term2", "/.", 
         RowBox[{
          RowBox[{"s", "[", "12", "]"}], "->", 
          RowBox[{
           RowBox[{"s", "[", "1", "]"}], "+", 
           RowBox[{"s", "[", "2", "]"}]}]}]}], "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "d", "-", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"s", "[", "1", "]"}], "+", 
              RowBox[{"s", "[", "2", "]"}]}], ")"}]}]}], ")"}], ":>", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "+", "d", "-", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"s", "[", "1", "]"}], "+", 
                RowBox[{"s", "[", "2", "]"}]}], ")"}]}]}], ")"}], "/.", 
           RowBox[{"Mellindeltamy", "[", 
            RowBox[{"4", ",", "4", ",", 
             RowBox[{"s", "[", "1", "]"}]}], "]"}]}], ")"}]}]}], "//", 
       "Simplify"}], "//", 
      RowBox[{"ReplaceAll", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"k", "[", "i_", "]"}], "2"], "-", 
           SuperscriptBox[
            RowBox[{"k", "[", "j_", "]"}], "2"]}], ")"}], "2"], " ", "->", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"k", "[", "i", "]"}], "2"], "-", 
           SuperscriptBox[
            RowBox[{"k", "[", "j", "]"}], "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"kk", "[", "i", "]"}], "2"], "-", 
           SuperscriptBox[
            RowBox[{"kk", "[", "j", "]"}], "2"]}], ")"}]}]}], "]"}]}], "//", 
     "Expand"}], "//", "scanK2sOnshelllistmap"}], "//", "Simplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"term2res", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"s", "[", "1", "]"}], "+", 
        RowBox[{"s", "[", "2", "]"}]}], ")"}], ":>", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"s", "[", "1", "]"}], "+", 
          RowBox[{"s", "[", "2", "]"}]}], ")"}], "/.", 
        RowBox[{"Mellindeltamy", "[", 
         RowBox[{"4", ",", "0", ",", 
          RowBox[{"s", "[", "1", "]"}]}], "]"}]}], ")"}]}]}], "/.", 
    RowBox[{"kk", "->", "k"}]}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.91864275707556*^9, 3.9186427853521304`*^9}, {
   3.9186428271649666`*^9, 3.918642883813429*^9}, {3.9186436983803897`*^9, 
   3.918643706747637*^9}, {3.91864376859085*^9, 3.918643862400489*^9}, 
   3.918643904709755*^9, {3.9186439650036497`*^9, 3.9186439861680565`*^9}, {
   3.9186440161876717`*^9, 3.918644058451622*^9}, {3.9186442573154025`*^9, 
   3.918644261909774*^9}},
 CellLabel->
  "In[243]:=",ExpressionUUID->"6fc412e8-df2b-40a6-b75d-89845cb8e2f0"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"k", "[", "3", "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["d", "2"], "-", 
      RowBox[{"8", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"s", "[", "1", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"s", "[", "2", "]"}], "2"]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"s", "[", "3", "]"}], "-", 
      RowBox[{"s", "[", "4", "]"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{"8", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"d", "-", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"s", "[", "3", "]"}], "+", 
         RowBox[{"s", "[", "4", "]"}]}], ")"}]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.918642766794806*^9, 3.918642786505849*^9}, {
   3.9186428362252607`*^9, 3.9186428520153065`*^9}, 3.9186428846133165`*^9, 
   3.9186437076209497`*^9, {3.918643768912955*^9, 3.9186438587137976`*^9}, 
   3.9186439064557023`*^9, {3.918643970920864*^9, 3.9186439867728868`*^9}, {
   3.918644033488659*^9, 3.918644058785449*^9}, 3.918644316833025*^9, 
   3.9306606925297155`*^9, 3.937045911802419*^9, 3.937046606679386*^9},
 CellLabel->
  "Out[244]=",ExpressionUUID->"442a292b-152f-4815-b7b9-9bb588a9ab89"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"term3", "/.", 
         RowBox[{
          RowBox[{"s", "[", "12", "]"}], "->", 
          RowBox[{
           RowBox[{"s", "[", "1", "]"}], "+", 
           RowBox[{"s", "[", "2", "]"}]}]}]}], "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "d", "-", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"s", "[", "1", "]"}], "+", 
              RowBox[{"s", "[", "2", "]"}]}], ")"}]}]}], ")"}], ":>", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "+", "d", "-", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"s", "[", "1", "]"}], "+", 
                RowBox[{"s", "[", "2", "]"}]}], ")"}]}]}], ")"}], "/.", 
           RowBox[{"Mellindeltamy", "[", 
            RowBox[{"4", ",", "4", ",", 
             RowBox[{"s", "[", "1", "]"}]}], "]"}]}], ")"}]}]}], "//", 
       "Simplify"}], "//", 
      RowBox[{"ReplaceAll", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"k", "[", "i_", "]"}], "2"], "-", 
           SuperscriptBox[
            RowBox[{"k", "[", "j_", "]"}], "2"]}], ")"}], "2"], " ", "->", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"k", "[", "i", "]"}], "2"], "-", 
           SuperscriptBox[
            RowBox[{"k", "[", "j", "]"}], "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"kk", "[", "i", "]"}], "2"], "-", 
           SuperscriptBox[
            RowBox[{"kk", "[", "j", "]"}], "2"]}], ")"}]}]}], "]"}]}], "//", 
     "Expand"}], "//", "scanK2sOnshelllistmap"}], "//", "Simplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"term3res", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"%", "/.", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"s", "[", "3", "]"}], "+", 
        RowBox[{"s", "[", "4", "]"}]}], ")"}], ":>", 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"s", "[", "3", "]"}], "+", 
          RowBox[{"s", "[", "4", "]"}]}], ")"}], "/.", 
        RowBox[{"Mellindeltamy", "[", 
         RowBox[{"4", ",", "0", ",", 
          RowBox[{"s", "[", "3", "]"}]}], "]"}]}], ")"}]}]}], "/.", 
    RowBox[{"kk", "->", "k"}]}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.918644080541148*^9, 3.9186440972288504`*^9}, {
  3.9186442634338436`*^9, 3.9186442675512114`*^9}},
 CellLabel->
  "In[245]:=",ExpressionUUID->"7659042d-c462-4b31-92af-d0aa0d326b64"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"k", "[", "1", "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{"k", "[", "2", "]"}], "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"s", "[", "1", "]"}], "-", 
      RowBox[{"s", "[", "2", "]"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["d", "2"], "-", 
      RowBox[{"8", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"s", "[", "3", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"s", "[", "4", "]"}], "2"]}], ")"}]}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{"8", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"d", "-", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"s", "[", "1", "]"}], "+", 
         RowBox[{"s", "[", "2", "]"}]}], ")"}]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.918644088644391*^9, 3.918644097801628*^9}, 
   3.9186443171272545`*^9, 3.9306606936457534`*^9, 3.9370459120890408`*^9, 
   3.937046606946054*^9},
 CellLabel->
  "Out[246]=",ExpressionUUID->"18a6463b-ea54-498f-ae35-0faba92850e8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"k", "[", "1", "]"}], "2"], "-", 
        SuperscriptBox[
         RowBox[{"k", "[", "2", "]"}], "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"s", "[", "1", "]"}], "-", 
        RowBox[{"s", "[", "2", "]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["d", "2"], "-", 
        RowBox[{"8", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"s", "[", "3", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"s", "[", "4", "]"}], "2"]}], ")"}]}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "3", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"8", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"d", "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"s", "[", "1", "]"}], "+", 
           RowBox[{"s", "[", "2", "]"}]}], ")"}]}]}], ")"}]}], ")"}]}], 
   ")"}]}]], "Input",
 CellLabel->
  "In[247]:=",ExpressionUUID->"0f6c0b8d-a007-421c-9cbf-1ab40225be25"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"k", "[", "1", "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{"k", "[", "2", "]"}], "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"s", "[", "1", "]"}], "-", 
      RowBox[{"s", "[", "2", "]"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["d", "2"], "-", 
      RowBox[{"8", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"s", "[", "3", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"s", "[", "4", "]"}], "2"]}], ")"}]}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{"8", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"d", "-", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"s", "[", "1", "]"}], "+", 
         RowBox[{"s", "[", "2", "]"}]}], ")"}]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.937045912370968*^9, 3.937046607198224*^9},
 CellLabel->
  "Out[247]=",ExpressionUUID->"1247bbfc-cd92-40a7-a89b-d9e710c3b989"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"term4", "/.", 
          RowBox[{
           RowBox[{"s", "[", "12", "]"}], "->", 
           RowBox[{
            RowBox[{"s", "[", "1", "]"}], "+", 
            RowBox[{"s", "[", "2", "]"}]}]}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "+", "d", "-", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"s", "[", "1", "]"}], "+", 
                 RowBox[{"s", "[", "2", "]"}]}], ")"}]}]}], ")"}], ":>", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"2", "+", "d", "-", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"s", "[", "1", "]"}], "+", 
                   RowBox[{"s", "[", "2", "]"}]}], ")"}]}]}], ")"}], "/.", 
              RowBox[{"Mellindeltamy", "[", 
               RowBox[{"4", ",", "6", ",", 
                RowBox[{"s", "[", "1", "]"}]}], "]"}]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"4", "+", "d", "-", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"s", "[", "1", "]"}], "+", 
                 RowBox[{"s", "[", "2", "]"}]}], ")"}]}]}], ")"}], ":>", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"4", "+", "d", "-", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"s", "[", "1", "]"}], "+", 
                   RowBox[{"s", "[", "2", "]"}]}], ")"}]}]}], ")"}], "/.", 
              RowBox[{"Mellindeltamy", "[", 
               RowBox[{"4", ",", "6", ",", 
                RowBox[{"s", "[", "1", "]"}]}], "]"}]}], ")"}]}]}], "}"}]}], "//",
         "Simplify"}], "//", "Simplify"}], "//", 
      RowBox[{"ReplaceAll", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"k", "[", "i_", "]"}], "2"], "-", 
           SuperscriptBox[
            RowBox[{"k", "[", "j_", "]"}], "2"]}], ")"}], "2"], " ", "->", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"k", "[", "i", "]"}], "2"], "-", 
           SuperscriptBox[
            RowBox[{"k", "[", "j", "]"}], "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"kk", "[", "i", "]"}], "2"], "-", 
           SuperscriptBox[
            RowBox[{"kk", "[", "j", "]"}], "2"]}], ")"}]}]}], "]"}]}], "//", 
     "Expand"}], "//", "scanK2sOnshelllistmap"}], "//", "Simplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"term4res", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"%", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"s", "[", "3", "]"}], "+", 
          RowBox[{"s", "[", "4", "]"}]}], ")"}], ":>", 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"s", "[", "3", "]"}], "+", 
            RowBox[{"s", "[", "4", "]"}]}], ")"}], "/.", 
          RowBox[{"Mellindeltamy", "[", 
           RowBox[{"4", ",", "2", ",", 
            RowBox[{"s", "[", "3", "]"}]}], "]"}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"s", "[", "1", "]"}], "+", 
          RowBox[{"s", "[", "2", "]"}]}], ")"}], ":>", 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"s", "[", "1", "]"}], "+", 
            RowBox[{"s", "[", "2", "]"}]}], ")"}], "/.", 
          RowBox[{"Mellindeltamy", "[", 
           RowBox[{"4", ",", "2", ",", 
            RowBox[{"s", "[", "1", "]"}]}], "]"}]}], ")"}]}]}], "}"}]}], "/.", 
    RowBox[{"kk", "->", "k"}]}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.9186441001051006`*^9, 3.9186441027656813`*^9}, {
  3.918644132834097*^9, 3.918644165407881*^9}, {3.9186442068043575`*^9, 
  3.918644306390612*^9}},
 CellLabel->
  "In[248]:=",ExpressionUUID->"88e4dd04-1369-4fc5-971b-eafbe4cc7a44"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
    SuperscriptBox["z1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"k", "[", "1", "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{"k", "[", "2", "]"}], "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"k", "[", "3", "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{"k", "[", "4", "]"}], "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"s", "[", "1", "]"}], "-", 
      RowBox[{"s", "[", "2", "]"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"s", "[", "3", "]"}], "-", 
      RowBox[{"s", "[", "4", "]"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"d", "-", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"s", "[", "1", "]"}], "+", 
         RowBox[{"s", "[", "2", "]"}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"d", "-", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"s", "[", "3", "]"}], "+", 
         RowBox[{"s", "[", "4", "]"}]}], ")"}]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.9186441033285265`*^9, {3.9186441335179787`*^9, 3.918644163658699*^9}, {
   3.918644220797728*^9, 3.918644233631973*^9}, {3.918644307100455*^9, 
   3.918644317409342*^9}, 3.9306606952682533`*^9, 3.9370459126909666`*^9, 
   3.9370466075073767`*^9},
 CellLabel->
  "Out[249]=",ExpressionUUID->"16190d92-2209-4882-87cb-cac0f7990014"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"d", "-", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"s", "[", "1", "]"}], "+", 
        RowBox[{"s", "[", "2", "]"}]}], ")"}]}]}], ")"}], "/.", 
   RowBox[{"Mellindeltamy", "[", 
    RowBox[{"4", ",", "0", ",", 
     RowBox[{"s", "[", "1", "]"}]}], "]"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.9303119967625837`*^9, 3.9303120337432914`*^9}},
 CellLabel->
  "In[250]:=",ExpressionUUID->"331d0094-5f34-48fd-82ad-5179facc3806"],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"s", "[", "3", "]"}], "+", 
    RowBox[{"s", "[", "4", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.930312034026394*^9, 3.9370459129299674`*^9, 
  3.9370466077442956`*^9},
 CellLabel->
  "Out[250]=",ExpressionUUID->"365aebbd-1cb0-45af-86b6-3a25e8679e36"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "[", "1", "]"}], "-", 
        RowBox[{"k", "[", "2", "]"}]}], ",", 
       RowBox[{
        RowBox[{"k", "[", "3", "]"}], "-", 
        RowBox[{"k", "[", "4", "]"}]}]}], "]"}], "//", 
     "getridofallplusminussc"}], "//", "scToks"}], "//", 
   RowBox[{"ReplaceAll", "[", "AdS4ptmy", "]"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.9305946910863066`*^9, 3.930594723242299*^9}},
 CellLabel->
  "In[251]:=",ExpressionUUID->"944a9ba8-0c47-4efd-9c0a-a8d4bf0700e9"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"k", "[", "1", "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"k", "[", "2", "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"k", "[", "3", "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"k", "[", "4", "]"}], "2"], "-", 
  SuperscriptBox[
   RowBox[{"ks", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "2"], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"ks", "[", 
     RowBox[{"2", ",", "3"}], "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{{3.93059470821568*^9, 3.9305947235264807`*^9}, 
   3.937045913176967*^9, 3.9370466079839315`*^9},
 CellLabel->
  "Out[251]=",ExpressionUUID->"d2f8517a-e9ac-4526-a8b5-6e5bcbf79dd7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{"term2res", "+", "term3res", "+", "term4res"}], 
    SuperscriptBox["ks", "2"]], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"brGR1234", "[", 
      RowBox[{
      "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", "k4", 
       ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", "s2", ",", 
       "s3", ",", "s4"}], "]"}], "/.", "rulesinv"}], ")"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.9186443734014482`*^9, 3.918644411812377*^9}},
 CellLabel->
  "In[252]:=",ExpressionUUID->"797a87cb-3ccd-4a9a-992c-642af2294d85"],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellChangeTimes->{{3.9186443788734245`*^9, 3.9186444133254585`*^9}, 
   3.937045913492547*^9, 3.93704660827448*^9},
 CellLabel->
  "Out[252]=",ExpressionUUID->"74f4a41c-1177-45d6-a5e8-b889afee6b6b"]
}, Open  ]],

Cell["\<\
which is just what we have  for br, the -1 means we have to substract to \
cancel the OPE pole in ks->0 limit\
\>", "Text",
 CellChangeTimes->{{3.91864295261248*^9, 3.9186429598979626`*^9}, {
  3.9186444290471373`*^9, 
  3.918644448620126*^9}},ExpressionUUID->"b3a4deac-bacf-420f-ac2f-\
5dc315182fbc"],

Cell["", "PageBreak",
 PageBreakBelow->True,ExpressionUUID->"002a4eab-e2df-44ac-a01d-63a5a9860217"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dks", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"EoMOP", "[", 
        RowBox[{"ks", ",", "d"}], "]"}], "[", 
       RowBox[{
        SuperscriptBox["z", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], 
           RowBox[{"s", "[", "1", "]"}]}], "+", 
          RowBox[{"d", "/", "2"}]}]], 
        SuperscriptBox["z", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], 
           RowBox[{"s", "[", "2", "]"}]}], "+", 
          RowBox[{"d", "/", "2"}]}]]}], "]"}], "//", 
      RowBox[{
       FractionBox["#", 
        RowBox[{
         SuperscriptBox["z", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], 
            RowBox[{"s", "[", "1", "]"}]}], "+", 
           RowBox[{"d", "/", "2"}]}]], 
         SuperscriptBox["z", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], 
            RowBox[{"s", "[", "2", "]"}]}], "+", 
           RowBox[{"d", "/", "2"}]}]]}]], "&"}]}], "//", "Simplify"}], "//", 
    RowBox[{"ReplaceAll", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d", "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"s", "[", "1", "]"}], "+", 
           RowBox[{"s", "[", "2", "]"}]}], ")"}]}]}], ")"}], ":>", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d", "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"s", "[", "1", "]"}], "+", 
             RowBox[{"s", "[", "2", "]"}]}], ")"}]}]}], ")"}], "/.", 
        RowBox[{"Mellindeltamy", "[", 
         RowBox[{"4", ",", "0", ",", 
          RowBox[{"s", "[", "1", "]"}]}], "]"}]}], ")"}]}], "]"}]}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.9185735983572044`*^9, 3.918573682118501*^9}},
 CellLabel->
  "In[253]:=",ExpressionUUID->"f90a123d-0194-4000-85b5-991bfa59e1b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["ks", "2"], " ", 
   SuperscriptBox["z", "2"]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"s", "[", "1", "]"}], "+", 
     RowBox[{"s", "[", "2", "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"s", "[", "3", "]"}], "+", 
     RowBox[{"s", "[", "4", "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.9185736158385916`*^9, 3.9185736292392106`*^9}, {
   3.918573664048211*^9, 3.9185736825641546`*^9}, 3.9370459137984905`*^9, 
   3.9370466085337553`*^9},
 CellLabel->
  "Out[253]=",ExpressionUUID->"56ac6572-3365-4aed-9dc9-cbaa1aa96777"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dkt", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"EoMOP", "[", 
        RowBox[{"kt", ",", "d"}], "]"}], "[", 
       RowBox[{
        SuperscriptBox["z", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], 
           RowBox[{"s", "[", "3", "]"}]}], "+", 
          RowBox[{"d", "/", "2"}]}]], 
        SuperscriptBox["z", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], 
           RowBox[{"s", "[", "2", "]"}]}], "+", 
          RowBox[{"d", "/", "2"}]}]]}], "]"}], "//", 
      RowBox[{
       FractionBox["#", 
        RowBox[{
         SuperscriptBox["z", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], 
            RowBox[{"s", "[", "3", "]"}]}], "+", 
           RowBox[{"d", "/", "2"}]}]], 
         SuperscriptBox["z", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], 
            RowBox[{"s", "[", "2", "]"}]}], "+", 
           RowBox[{"d", "/", "2"}]}]]}]], "&"}]}], "//", "Simplify"}], "//", 
    RowBox[{"ReplaceAll", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d", "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"s", "[", "2", "]"}], "+", 
           RowBox[{"s", "[", "3", "]"}]}], ")"}]}]}], ")"}], ":>", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d", "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"s", "[", "3", "]"}], "+", 
             RowBox[{"s", "[", "2", "]"}]}], ")"}]}]}], ")"}], "/.", 
        RowBox[{"Mellindeltamy", "[", 
         RowBox[{"4", ",", "0", ",", 
          RowBox[{"s", "[", "2", "]"}]}], "]"}]}], ")"}]}], "]"}]}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.9185736871318927`*^9, 3.9185737133384113`*^9}, {
  3.9185737450235806`*^9, 3.918573745092763*^9}},
 CellLabel->
  "In[254]:=",ExpressionUUID->"632fd6db-56bb-48ea-8e47-4c47f23daffb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["kt", "2"], " ", 
   SuperscriptBox["z", "2"]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"s", "[", "2", "]"}], "+", 
     RowBox[{"s", "[", "3", "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"s", "[", "1", "]"}], "+", 
     RowBox[{"s", "[", "4", "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.9185737136574802`*^9, 3.918573745323615*^9, 
  3.937045914090576*^9, 3.93704660880369*^9},
 CellLabel->
  "Out[254]=",ExpressionUUID->"9ae2ed7a-7bb8-4c7d-8482-7035714dfdfb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"CfGR1234", "[", 
   RowBox[{
   "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", "k4", 
    ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", "s2", ",", 
    "s3", ",", "s4"}], "]"}], "/.", "rulesinv"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"%", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"Vcs", "-", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"sc", "[", 
                    RowBox[{
                    RowBox[{"e", "[", "1", "]"}], ",", 
                    RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
                    RowBox[{"sc", "[", 
                    RowBox[{
                    RowBox[{"e", "[", "3", "]"}], ",", 
                    RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "4"]}], ")"}], 
                "2"], "-", 
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
                 SuperscriptBox[
                  RowBox[{"sc", "[", 
                   RowBox[{
                    RowBox[{"e", "[", "1", "]"}], ",", 
                    RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"sc", "[", 
                   RowBox[{
                    RowBox[{"e", "[", "3", "]"}], ",", 
                    RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
                RowBox[{"16", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], ")"}]}]]}], ")"}], "Dks"}],
             " ", "+", 
            RowBox[{"Vcs", " ", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "1", "]"}], ",", 
               RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "3", "]"}], ",", 
               RowBox[{"e", "[", "4", "]"}]}], "]"}], "Dkt"}], "-", 
            RowBox[{"2", 
             SuperscriptBox["z1", "2"], "Vcs", " ", "Ws"}]}], "/.", 
           RowBox[{"z", "->", "z1"}]}], "//", "Expand"}], "//", "Simplify"}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"//", 
                RowBox[{
                 RowBox[{"ToMinimalPolarizationVariable4", "[", 
                  RowBox[{"#", ",", "1", ",", "2", ",", "3", ",", "4"}], 
                  "]"}], "&"}]}], "//", 
               RowBox[{
                RowBox[{"ToMinimalPolarizationVariable4", "[", 
                 RowBox[{"#", ",", "4", ",", "3", ",", "2", ",", "1"}], "]"}],
                 "&"}]}], "//", "Simplify"}], "//", 
             "GetRidOfAllPlusMinusSC"}], "//", "scToks"}], "//", 
           RowBox[{"ReplaceAll", "[", "AdS4ptmy", "]"}]}], "//", "Simplify"}],
          "*)"}], "//", 
        RowBox[{
         RowBox[{"ToMinimalPolarizationVariable4", "[", 
          RowBox[{"#", ",", "1", ",", "2", ",", "3", ",", "4"}], "]"}], 
         "&"}]}], "//", 
       RowBox[{
        RowBox[{"ToMinimalPolarizationVariable4", "[", 
         RowBox[{"#", ",", "4", ",", "3", ",", "2", ",", "1"}], "]"}], 
        "&"}]}], "//", "Simplify"}], "//", "GetRidOfAllPlusMinusSC"}], "//", 
    "scToks"}], "//", 
   RowBox[{"ReplaceAll", "[", "AdS4ptmy", "]"}]}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.918568360454012*^9, 3.9185683624650335`*^9}, {
   3.9185686558473396`*^9, 3.9185686677061872`*^9}, {3.918568827267727*^9, 
   3.9185688321356015`*^9}, {3.9185689127005186`*^9, 
   3.9185689240650387`*^9}, {3.918568956657299*^9, 3.9185689573530507`*^9}, {
   3.9185689923705144`*^9, 3.918569005226838*^9}, 3.918569060187851*^9, {
   3.9185723075750313`*^9, 3.918572344379883*^9}, {3.918572600408902*^9, 
   3.9185726009013214`*^9}, 3.918572913815569*^9, {3.91857299097605*^9, 
   3.9185730078225384`*^9}, {3.918573085278123*^9, 3.9185730885940065`*^9}, {
   3.91857348300977*^9, 3.9185735325514207`*^9}, {3.918573578640811*^9, 
   3.918573580939868*^9}, {3.9185737204420147`*^9, 3.918573739100253*^9}, {
   3.918573818923792*^9, 3.9185738317787066`*^9}},
 CellLabel->
  "In[255]:=",ExpressionUUID->"596a86df-becf-47ae-9851-9100c5d94f5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "16"]}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["ks", "2"], " ", 
      SuperscriptBox["z1", "2"]}], "+", 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"s", "[", "1", "]"}], "+", 
        RowBox[{"s", "[", "2", "]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"s", "[", "3", "]"}], "+", 
        RowBox[{"s", "[", "4", "]"}]}], ")"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}]], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], ",", 
           RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], ",", 
           RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}]}]}], ")"}], "2"]}], ")"}]}], 
  "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["z1", "2"]}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"k", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["z1", "2"], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"k", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["z1", "2"], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"k", "[", "1", "]"}]}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["z1", "2"], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"k", "[", "1", "]"}]}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["z1", "2"], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["z1", "2"], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["z1", "2"], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "4", "]"}], ",", 
        RowBox[{"k", "[", "3", "]"}]}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["z1", "2"], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "4", "]"}], ",", 
        RowBox[{"k", "[", "3", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["kt", "2"], " ", 
            SuperscriptBox["z1", "2"]}], "+", 
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"s", "[", "2", "]"}], "+", 
              RowBox[{"s", "[", "3", "]"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"s", "[", "1", "]"}], "+", 
              RowBox[{"s", "[", "4", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["z1", "2"], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "4", "]"}], ",", 
           RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "+", 
        RowBox[{"z1", " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"z1", " ", 
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "4", "]"}], ",", 
              RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "+", 
           RowBox[{"z1", " ", 
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "4", "]"}], ",", 
              RowBox[{"k", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}]}]}],
     ")"}]}]}]], "Output",
 CellChangeTimes->{{3.918568337840961*^9, 3.9185683627260847`*^9}, {
   3.9185688274998655`*^9, 3.918568833642097*^9}, 3.9185689584253654`*^9, 
   3.9185690059366474`*^9, 3.9185690607227793`*^9, {3.9185723080081615`*^9, 
   3.918572344767438*^9}, 3.918572601450015*^9, 3.918572914452233*^9, {
   3.9185729982426662`*^9, 3.9185730083180485`*^9}, 3.9185730892523637`*^9, {
   3.9185734867314053`*^9, 3.9185735328147836`*^9}, 3.918573581326377*^9, {
   3.9185737393178186`*^9, 3.9185737472404985`*^9}, {3.91857382960985*^9, 
   3.918573832269004*^9}, 3.9370459143505774`*^9, 3.9370466090454445`*^9},
 CellLabel->
  "Out[255]=",ExpressionUUID->"05aa45e4-d81c-4a57-877c-0f7d5e7a7801"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "16"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "8"}], " ", "Vcs", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["ks", "2"], " ", "Vcs", " ", 
        SuperscriptBox["z1", "2"]}], "+", 
       RowBox[{"4", " ", "Ws", " ", 
        SuperscriptBox["z1", "2"]}], "+", 
       RowBox[{"8", " ", "Vcs", " ", 
        RowBox[{"s", "[", "1", "]"}], " ", 
        RowBox[{"s", "[", "3", "]"}]}], "+", 
       RowBox[{"8", " ", "Vcs", " ", 
        RowBox[{"s", "[", "2", "]"}], " ", 
        RowBox[{"s", "[", "3", "]"}]}], "+", 
       RowBox[{"8", " ", "Vcs", " ", 
        RowBox[{"s", "[", "1", "]"}], " ", 
        RowBox[{"s", "[", "4", "]"}]}], "+", 
       RowBox[{"8", " ", "Vcs", " ", 
        RowBox[{"s", "[", "2", "]"}], " ", 
        RowBox[{"s", "[", "4", "]"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["ks", "2"], " ", 
           SuperscriptBox["z1", "2"]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["kt", "2"], " ", 
              SuperscriptBox["z1", "2"]}], "+", 
             RowBox[{"4", " ", 
              RowBox[{"s", "[", "1", "]"}], " ", 
              RowBox[{"s", "[", "2", "]"}]}], "+", 
             RowBox[{"6", " ", 
              RowBox[{"s", "[", "1", "]"}], " ", 
              RowBox[{"s", "[", "3", "]"}]}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"s", "[", "2", "]"}], " ", 
              RowBox[{"s", "[", "3", "]"}]}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"s", "[", "1", "]"}], " ", 
              RowBox[{"s", "[", "4", "]"}]}], "+", 
             RowBox[{"6", " ", 
              RowBox[{"s", "[", "2", "]"}], " ", 
              RowBox[{"s", "[", "4", "]"}]}], "+", 
             RowBox[{"4", " ", 
              RowBox[{"s", "[", "3", "]"}], " ", 
              RowBox[{"s", "[", "4", "]"}]}]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "2", "]"}], ",", 
       RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["ks", "2"], " ", 
           SuperscriptBox["z1", "2"]}], "+", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"s", "[", "1", "]"}], "+", 
             RowBox[{"s", "[", "2", "]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"s", "[", "3", "]"}], "+", 
             RowBox[{"s", "[", "4", "]"}]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "-", 
       RowBox[{"8", " ", 
        SuperscriptBox["z1", "2"], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "3", "]"}], ",", 
            RowBox[{"k", "[", "1", "]"}]}], "]"}], "+", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "3", "]"}], ",", 
            RowBox[{"k", "[", "2", "]"}]}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "3", "]"}]}], "]"}], "2"], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "2", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["ks", "2"], " ", 
           SuperscriptBox["z1", "2"]}], "+", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"s", "[", "1", "]"}], "+", 
             RowBox[{"s", "[", "2", "]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"s", "[", "3", "]"}], "+", 
             RowBox[{"s", "[", "4", "]"}]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["z1", "2"], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "4", "]"}], ",", 
          RowBox[{"k", "[", "3", "]"}]}], "]"}]}]}], ")"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "2", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["z1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "1", "]"}], ",", 
             RowBox[{"k", "[", "3", "]"}]}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "2", "]"}], ",", 
             RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "3", "]"}], ",", 
             RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "1", "]"}], ",", 
             RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"e", "[", "2", "]"}], ",", 
                 RowBox[{"k", "[", "3", "]"}]}], "]"}]}], " ", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "3", "]"}], ",", 
                RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "2", "]"}], ",", 
                RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"e", "[", "3", "]"}], ",", 
                  RowBox[{"k", "[", "1", "]"}]}], "]"}], "+", 
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"e", "[", "3", "]"}], ",", 
                  RowBox[{"k", "[", "2", "]"}]}], "]"}]}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "2", "]"}], ",", 
                RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "4", "]"}], ",", 
                RowBox[{"k", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}]}],
        "+", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["ks", "2"], " ", 
              SuperscriptBox["z1", "2"]}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["kt", "2"], " ", 
                 SuperscriptBox["z1", "2"]}], "+", 
                RowBox[{"4", " ", 
                 RowBox[{"s", "[", "1", "]"}], " ", 
                 RowBox[{"s", "[", "2", "]"}]}], "+", 
                RowBox[{"6", " ", 
                 RowBox[{"s", "[", "1", "]"}], " ", 
                 RowBox[{"s", "[", "3", "]"}]}], "+", 
                RowBox[{"2", " ", 
                 RowBox[{"s", "[", "2", "]"}], " ", 
                 RowBox[{"s", "[", "3", "]"}]}], "+", 
                RowBox[{"2", " ", 
                 RowBox[{"s", "[", "1", "]"}], " ", 
                 RowBox[{"s", "[", "4", "]"}]}], "+", 
                RowBox[{"6", " ", 
                 RowBox[{"s", "[", "2", "]"}], " ", 
                 RowBox[{"s", "[", "4", "]"}]}], "+", 
                RowBox[{"4", " ", 
                 RowBox[{"s", "[", "3", "]"}], " ", 
                 RowBox[{"s", "[", "4", "]"}]}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "3", "]"}], ",", 
             RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["z1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "3", "]"}], ",", 
                RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "4", "]"}], ",", 
                RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "3", "]"}], ",", 
                RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"e", "[", "4", "]"}], ",", 
                  RowBox[{"k", "[", "2", "]"}]}], "]"}], "+", 
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"e", "[", "4", "]"}], ",", 
                  RowBox[{"k", "[", "3", "]"}]}], "]"}]}], ")"}]}]}], 
            ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "4"}], " ", 
           SuperscriptBox["z1", "2"], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "2", "]"}], ",", 
             RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "2", "]"}], ",", 
             RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "3", "]"}], ",", 
               RowBox[{"k", "[", "1", "]"}]}], "]"}], "+", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "3", "]"}], ",", 
               RowBox[{"k", "[", "2", "]"}]}], "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "2", "]"}], ",", 
             RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["ks", "2"], " ", 
                 SuperscriptBox["z1", "2"]}], "+", 
                RowBox[{"4", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"s", "[", "1", "]"}], "+", 
                   RowBox[{"s", "[", "2", "]"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"s", "[", "3", "]"}], "+", 
                   RowBox[{"s", "[", "4", "]"}]}], ")"}]}]}], ")"}], " ", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "2", "]"}], ",", 
                RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["z1", "2"], " ", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "2", "]"}], ",", 
                RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "4", "]"}], ",", 
                RowBox[{"k", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}]}],
        "+", 
       RowBox[{"2", " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["z1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "1", "]"}], ",", 
                RowBox[{"k", "[", "3", "]"}]}], "]"}], " ", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "2", "]"}], ",", 
                RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "3", "]"}], ",", 
                RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "1", "]"}], ",", 
                RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"sc", "[", 
                   RowBox[{
                    RowBox[{"e", "[", "2", "]"}], ",", 
                    RowBox[{"k", "[", "3", "]"}]}], "]"}]}], " ", 
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "3", "]"}], ",", 
                   RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "2", "]"}], ",", 
                   RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"sc", "[", 
                    RowBox[{
                    RowBox[{"e", "[", "3", "]"}], ",", 
                    RowBox[{"k", "[", "1", "]"}]}], "]"}], "+", 
                   RowBox[{"sc", "[", 
                    RowBox[{
                    RowBox[{"e", "[", "3", "]"}], ",", 
                    RowBox[{"k", "[", "2", "]"}]}], "]"}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "2", "]"}], ",", 
                   RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "4", "]"}], ",", 
                   RowBox[{"k", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], 
            ")"}]}], "+", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "1", "]"}], ",", 
             RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["ks", "2"], " ", 
                 SuperscriptBox["z1", "2"]}], "+", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["kt", "2"], " ", 
                    SuperscriptBox["z1", "2"]}], "+", 
                   RowBox[{"4", " ", 
                    RowBox[{"s", "[", "1", "]"}], " ", 
                    RowBox[{"s", "[", "2", "]"}]}], "+", 
                   RowBox[{"6", " ", 
                    RowBox[{"s", "[", "1", "]"}], " ", 
                    RowBox[{"s", "[", "3", "]"}]}], "+", 
                   RowBox[{"2", " ", 
                    RowBox[{"s", "[", "2", "]"}], " ", 
                    RowBox[{"s", "[", "3", "]"}]}], "+", 
                   RowBox[{"2", " ", 
                    RowBox[{"s", "[", "1", "]"}], " ", 
                    RowBox[{"s", "[", "4", "]"}]}], "+", 
                   RowBox[{"6", " ", 
                    RowBox[{"s", "[", "2", "]"}], " ", 
                    RowBox[{"s", "[", "4", "]"}]}], "+", 
                   RowBox[{"4", " ", 
                    RowBox[{"s", "[", "3", "]"}], " ", 
                    RowBox[{"s", "[", "4", "]"}]}]}], ")"}]}]}], ")"}], " ", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "3", "]"}], ",", 
                RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["z1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "3", "]"}], ",", 
                   RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "4", "]"}], ",", 
                   RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "3", "]"}], ",", 
                   RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"sc", "[", 
                    RowBox[{
                    RowBox[{"e", "[", "4", "]"}], ",", 
                    RowBox[{"k", "[", "2", "]"}]}], "]"}], "+", 
                   RowBox[{"sc", "[", 
                    RowBox[{
                    RowBox[{"e", "[", "4", "]"}], ",", 
                    RowBox[{"k", "[", "3", "]"}]}], "]"}]}], ")"}]}]}], 
               ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.918568337840961*^9, 3.9185683627260847`*^9}, {
   3.9185688274998655`*^9, 3.918568833642097*^9}, 3.9185689584253654`*^9, 
   3.9185690059366474`*^9, 3.9185690607227793`*^9, {3.9185723080081615`*^9, 
   3.918572344767438*^9}, 3.918572601450015*^9, 3.918572914452233*^9, {
   3.9185729982426662`*^9, 3.9185730083180485`*^9}, 3.9185730892523637`*^9, {
   3.9185734867314053`*^9, 3.9185735328147836`*^9}, 3.918573581326377*^9, {
   3.9185737393178186`*^9, 3.9185737472404985`*^9}, {3.91857382960985*^9, 
   3.918573832269004*^9}, 3.9370459143505774`*^9, 3.93704660939221*^9},
 CellLabel->
  "Out[256]=",ExpressionUUID->"bcfddb0e-1455-4319-995a-70098f2bc201"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Vcs", "=", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}]}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", 
         RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "2", "]"}], ",", 
         RowBox[{"e", "[", "4", "]"}]}], "]"}]}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9185688923070793`*^9, 3.918568904615838*^9}},
 CellLabel->
  "In[257]:=",ExpressionUUID->"2a8eaac7-b70b-4245-8cd4-36945b704681"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Vcs", " ", "Ws"}], "//", 
        RowBox[{
         RowBox[{"ToMinimalPolarizationVariable4", "[", 
          RowBox[{"#", ",", "1", ",", "2", ",", "3", ",", "4"}], "]"}], 
         "&"}]}], "//", 
       RowBox[{
        RowBox[{"ToMinimalPolarizationVariable4", "[", 
         RowBox[{"#", ",", "4", ",", "3", ",", "2", ",", "1"}], "]"}], 
        "&"}]}], "//", "Simplify"}], "//", "GetRidOfAllPlusMinusSC"}], "//", 
    "scToks"}], "//", 
   RowBox[{"ReplaceAll", "[", "AdS4ptmy", "]"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.9185688346125526`*^9, 3.9185688348003016`*^9}, 
   3.918568874725032*^9, {3.918569066801292*^9, 3.9185690708589525`*^9}, {
   3.918573453179394*^9, 3.9185734618754005`*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"12c55802-bc78-46f9-ad82-732b9462d587"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", "Ws", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}]}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "2", "]"}], ",", 
       RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "2", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.918568835308283*^9, 3.9185688753667574`*^9, 3.9185690714423103`*^9, {
   3.918573456215213*^9, 3.918573462238767*^9}, 3.937045915048895*^9, 
   3.9370466096932096`*^9},
 CellLabel->
  "Out[258]=",ExpressionUUID->"ece4f627-378a-4f30-81d4-7eae488b53b0"]
}, Open  ]],

Cell["", "PageBreak",
 PageBreakBelow->True,ExpressionUUID->"68d23b47-2f49-45ac-9899-c9e0e2e494c6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Having determine all b\[CloseCurlyQuote]s we want to see whether the \
expression is lorentz invariant\
\>", "Subsubsection",
 CellChangeTimes->{{3.9116696881285677`*^9, 3.91166969078436*^9}, {
  3.912274185015639*^9, 3.91227418602064*^9}, {3.9186446532698565`*^9, 
  3.918644660292272*^9}, {3.9186447006802464`*^9, 
  3.9186447134928503`*^9}},ExpressionUUID->"8df4dd67-8f67-4dc0-a4ba-\
1bae3eff7295"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               RowBox[{"pi22GR1234", "[", 
                RowBox[{
                "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", 
                 ",", "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", 
                 "s1", ",", "s2", ",", "s3", ",", "s4"}], "]"}], 
               SubscriptBox["D", "ks"]], "/.", "rulesinv"}], ")"}], "+", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"baGR1234", "[", 
                RowBox[{
                "z1", ",", "ks", ",", "k1", ",", "k2", ",", "k3", ",", "k4", 
                 ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
                 "s2", ",", "s3", ",", "s4"}], "]"}], "+", 
               RowBox[{"bspGR1234", "[", 
                RowBox[{
                "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", 
                 ",", "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", 
                 "s1", ",", "s2", ",", "s3", ",", "s4"}], "]"}], "+", 
               RowBox[{"brGR1234", "[", 
                RowBox[{
                "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", 
                 ",", "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", 
                 "s1", ",", "s2", ",", "s3", ",", "s4"}], "]"}], "+", 
               RowBox[{"badGR1234", "[", 
                RowBox[{
                "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", 
                 ",", "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", 
                 "s1", ",", "s2", ",", "s3", ",", "s4"}], "]"}]}], "/.", 
              "rulesinv"}], ")"}]}], 
           RowBox[{"(*", 
            RowBox[{"+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"CsGR1234", "[", 
                RowBox[{
                "z1", ",", "ks", ",", "k1", ",", "k2", ",", "k3", ",", "k4", 
                 ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
                 "s2", ",", "s3", ",", "s4"}], "]"}], "/.", "rulesinv"}], 
              ")"}]}], "*)"}], ")"}], "/.", 
          RowBox[{"y4s", "->", "0"}]}], "/.", 
         RowBox[{"ks", "->", "ks12"}]}], "/.", 
        RowBox[{
         SubscriptBox["D", "ks12"], "\[Rule]", 
         RowBox[{
          RowBox[{
           SuperscriptBox["z1", "2"], " ", 
           SuperscriptBox["ks12", "2"]}], " ", "+", 
          RowBox[{"4", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"s", "[", "1", "]"}], "+", 
             RowBox[{"s", "[", "2", "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"s", "[", "3", "]"}], "+", 
             RowBox[{"s", "[", "4", "]"}]}], ")"}]}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"s", "[", "i_", "]"}], "\[RuleDelayed]", 
        FractionBox[
         RowBox[{"z1", " ", 
          RowBox[{"k", "[", "i", "]"}]}], "2"]}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"k", "[", "i_", "]"}], ",", 
           RowBox[{"k", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"kk", "[", "i", "]"}], ",", 
           RowBox[{"kk", "[", "j", "]"}]}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i_", "]"}], ",", 
           RowBox[{"k", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i", "]"}], ",", 
           RowBox[{"kk", "[", "j", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
     RowBox[{
      RowBox[{"k", "[", "4", "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"k", "[", "1", "]"}]}], "-", 
       RowBox[{"k", "[", "2", "]"}], "-", 
       RowBox[{"k", "[", "3", "]"}]}]}]}], "//", "Simplify"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{"%", ",", 
      RowBox[{"{", 
       RowBox[{"z1", ",", "Infinity", ",", 
        RowBox[{"-", "2"}]}], "}"}]}], "]"}], "//", "Normal"}], "//", 
   "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//", "Expand"}], "//", "Simplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["ks12", "2"], "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"k", "[", "1", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"k", "[", "2", "]"}], "2"], "+", 
         RowBox[{"2", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"kk", "[", "1", "]"}], ",", 
            RowBox[{"kk", "[", "2", "]"}]}], "]"}]}]}]}], ",", 
       RowBox[{
        SuperscriptBox["ks12", "4"], "\[Rule]", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"k", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"k", "[", "2", "]"}], "2"], "+", 
           RowBox[{"2", 
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"kk", "[", "1", "]"}], ",", 
              RowBox[{"kk", "[", "2", "]"}]}], "]"}]}]}], ")"}], "2"]}]}], 
      "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["kt", "2"], "\[Rule]", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"k", "[", "3", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"k", "[", "2", "]"}], "2"], "+", 
        RowBox[{"2", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"kk", "[", "3", "]"}], ",", 
           RowBox[{"kk", "[", "2", "]"}]}], "]"}]}]}]}], ",", 
      RowBox[{
       SuperscriptBox["kt", "4"], "\[Rule]", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"k", "[", "3", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"k", "[", "2", "]"}], "2"], "+", 
          RowBox[{"2", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"kk", "[", "3", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}]}]}], ")"}], "2"]}]}], 
     "}"}]}], "//", "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GRadsns", "=", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"kk", "[", "i_", "]"}], ",", 
        RowBox[{"kk", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "+", 
       RowBox[{
        RowBox[{"k", "[", "i", "]"}], 
        RowBox[{"k", "[", "j", "]"}]}]}]}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", 
  RowBox[{
   RowBox[{"FreeQ", "[", 
    RowBox[{"#", ",", 
     RowBox[{"k", "[", "_", "]"}]}], "]"}], "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GRadsns1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"GRadsns", "/.", 
           RowBox[{
            RowBox[{"k", "[", "4", "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"k", "[", "1", "]"}]}], "-", 
             RowBox[{"k", "[", "2", "]"}], "-", 
             RowBox[{"k", "[", "3", "]"}]}]}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "i_", "]"}], ",", 
              RowBox[{"kk", "[", "1", "]"}]}], "]"}], ":>", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i", "]"}], ",", 
               RowBox[{"kk", "[", "3", "]"}]}], "]"}], "-", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i", "]"}], ",", 
               RowBox[{"kk", "[", "4", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"kk", "[", "i_", "]"}], ",", 
            RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i_", "]"}], ",", 
           RowBox[{"kk", "[", "4", "]"}]}], "]"}], ":>", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "i", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], ",", 
            RowBox[{"kk", "[", "3", "]"}]}], "]"}], "-", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], ",", 
            RowBox[{"kk", "[", "1", "]"}]}], "]"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"kk", "[", "i_", "]"}], ",", 
          RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "//", 
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", "0", ",", "4"}], "}"}]}], 
        "]"}], "&"}]}], "//", "FullSimplify"}], "//", "Normal"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", 
  RowBox[{
   RowBox[{"FreeQ", "[", 
    RowBox[{"#", ",", 
     RowBox[{"k", "[", "_", "]"}]}], "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.912012197682721*^9, 3.912012269333867*^9}, {
   3.912012341266126*^9, 3.9120123414192457`*^9}, {3.912012393834489*^9, 
   3.9120124060886765`*^9}, 3.912274188984645*^9, 3.9185463317391043`*^9, 
   3.918546706819149*^9},
 CellLabel->
  "In[259]:=",ExpressionUUID->"51a716be-8e5c-43b8-8d5a-4a526cf9b6b0"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{
  3.9120121985218716`*^9, {3.9120122600430965`*^9, 3.9120122778324213`*^9}, 
   3.9120123500909004`*^9, 3.912012413989837*^9, 3.9120125640441155`*^9, 
   3.9120650565000114`*^9, 3.9122667113848515`*^9, 3.912274018522781*^9, 
   3.9122741996434774`*^9, 3.9125797991576333`*^9, 3.9185398366136*^9, 
   3.918542221175209*^9, 3.918546340446824*^9, 3.9185467110077286`*^9, 
   3.918567188825595*^9, 3.937045920103176*^9, 3.937046614503459*^9},
 CellLabel->
  "Out[264]=",ExpressionUUID->"27510ac2-9ec5-4547-95a4-41bc9d569d9b"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
    SuperscriptBox["z1", "2"], " ", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "2"}], "]"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{"8", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "2"}], "]"}]}]], 
   RowBox[{
    SuperscriptBox["z1", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "1", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "2", "]"}], ",", 
             RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "1", "]"}], ",", 
             RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "2", "]"}], ",", 
             RowBox[{"kk", "[", "1", "]"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "4", "]"}], ",", 
          RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{"2", ",", "3"}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "3", "]"}], ",", 
             RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "3", "]"}], ",", 
               RowBox[{"kk", "[", "1", "]"}]}], "]"}], "+", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "3", "]"}], ",", 
               RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], ")"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "4", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "3", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "4", "]"}], ",", 
             RowBox[{"kk", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}], 
     "2"]}]}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"8", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], 
   RowBox[{
    SuperscriptBox["z1", "2"], " ", 
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"e", "[", "1", "]"}], ",", 
      RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"e", "[", "3", "]"}], ",", 
      RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "1", "]"}], ",", 
            RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "2", "]"}], ",", 
            RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "3", "]"}], ",", 
            RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "2", "]"}], ",", 
            RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "1", "]"}], ",", 
               RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"e", "[", "3", "]"}], ",", 
                 RowBox[{"kk", "[", "1", "]"}]}], "]"}], "+", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"e", "[", "3", "]"}], ",", 
                 RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "1", "]"}], ",", 
               RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "4", "]"}], ",", 
               RowBox[{"kk", "[", "3", "]"}]}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "1", "]"}], ",", 
            RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "2", "]"}], ",", 
                RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], " ", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "3", "]"}], ",", 
               RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "2", "]"}], ",", 
               RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"e", "[", "3", "]"}], ",", 
                 RowBox[{"kk", "[", "1", "]"}]}], "]"}], "+", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"e", "[", "3", "]"}], ",", 
                 RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "2", "]"}], ",", 
               RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "4", "]"}], ",", 
               RowBox[{"kk", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}]}],
       "+", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
               SuperscriptBox[
                RowBox[{"k", "[", "1", "]"}], "2"]}], ")"}]}], "+", 
            RowBox[{"d", " ", 
             SuperscriptBox[
              RowBox[{"k", "[", "2", "]"}], "2"]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
             RowBox[{"k", "[", "1", "]"}], " ", 
             RowBox[{"k", "[", "3", "]"}]}], "+", 
            RowBox[{"2", " ", "d", " ", 
             RowBox[{"k", "[", "2", "]"}], " ", 
             RowBox[{"k", "[", "3", "]"}]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox[
              RowBox[{"k", "[", "3", "]"}], "2"]}], "+", 
            RowBox[{"4", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
             RowBox[{"S", "[", 
              RowBox[{"2", ",", "3"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "3", "]"}], ",", 
            RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
         RowBox[{"4", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "3", "]"}], ",", 
               RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "4", "]"}], ",", 
               RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "3", "]"}], ",", 
               RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"e", "[", "4", "]"}], ",", 
                 RowBox[{"kk", "[", "2", "]"}]}], "]"}], "+", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"e", "[", "4", "]"}], ",", 
                 RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.9120121985218716`*^9, {3.9120122600430965`*^9, 3.9120122778324213`*^9}, 
   3.9120123500909004`*^9, 3.912012413989837*^9, 3.9120125640441155`*^9, 
   3.9120650565000114`*^9, 3.9122667113848515`*^9, 3.912274018522781*^9, 
   3.9122741996434774`*^9, 3.9125797991576333`*^9, 3.9185398366136*^9, 
   3.918542221175209*^9, 3.918546340446824*^9, 3.9185467110077286`*^9, 
   3.918567188825595*^9, 3.937045920103176*^9, 3.9370466152435436`*^9},
 CellLabel->
  "Out[265]=",ExpressionUUID->"16a801d7-41ae-447f-aae1-b7f7e9f7b00c"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{
  3.9120121985218716`*^9, {3.9120122600430965`*^9, 3.9120122778324213`*^9}, 
   3.9120123500909004`*^9, 3.912012413989837*^9, 3.9120125640441155`*^9, 
   3.9120650565000114`*^9, 3.9122667113848515`*^9, 3.912274018522781*^9, 
   3.9122741996434774`*^9, 3.9125797991576333`*^9, 3.9185398366136*^9, 
   3.918542221175209*^9, 3.918546340446824*^9, 3.9185467110077286`*^9, 
   3.918567188825595*^9, 3.937045920103176*^9, 3.93704661547182*^9},
 CellLabel->
  "Out[266]=",ExpressionUUID->"7b79e277-f50e-4e7e-9873-e0778ebe3927"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
It is not lorentz invariant the additional |k| term can be directly substract \
to make it lorentz inv, but here do a constant shift to also determine the \
subleading AdS correction using dimensional reduced soft limit.\
\>", "Subsubsection",
 CellChangeTimes->{{3.918644722427143*^9, 
  3.9186448030332165`*^9}},ExpressionUUID->"527d1262-2a63-48d5-9d31-\
8d49c6ac9da6"],

Cell["building the ansatz", "Text",
 CellChangeTimes->{{3.91864481359702*^9, 
  3.9186448157953377`*^9}},ExpressionUUID->"d7972749-7b75-4302-aa6f-\
9edbe4e89bfe"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"GRadsns1", "/.", 
   RowBox[{
    RowBox[{"k", "[", "x_", "]"}], "->", 
    RowBox[{"a", " ", 
     RowBox[{"k", "[", "x", "]"}]}]}]}], "//", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{"#", ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "\[Infinity]", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "]"}], "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"%", "/.", 
       RowBox[{
        RowBox[{"k", "[", "i_", "]"}], "->", 
        FractionBox[
         RowBox[{" ", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"s", "[", "i", "]"}]}], "+", 
           RowBox[{"c", "[", "i", "]"}]}]}], "z1"]}]}], "//", "Simplify"}], "//",
      "Normal"}], ")"}], "/.", 
   RowBox[{"a", "->", "1"}]}], "//", "Expand"}], "\[IndentingNewLine]", 
 RowBox[{"nonlorentzinv", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"c", "[", "i_", "]"}], "2"], "->", "f"}]}], "/.", 
    RowBox[{
     RowBox[{
      RowBox[{"c", "[", "i_", "]"}], 
      RowBox[{"c", "[", "j_", "]"}]}], "->", "f"}]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.9120125225870895`*^9, 3.9120125607809916`*^9}, 
   3.912012594509376*^9, {3.912012653966777*^9, 3.9120126842081194`*^9}, {
   3.9120128226718254`*^9, 3.9120128762814035`*^9}, {3.912274200635989*^9, 
   3.9122742028883286`*^9}, {3.912275091496645*^9, 3.912275092221449*^9}, {
   3.9122751273449397`*^9, 3.9122751852052975`*^9}},
 CellLabel->
  "In[267]:=",ExpressionUUID->"27c4cc35-e050-4e57-8c1a-16af49186443"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["z1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"k", "[", "1", "]"}], "2"]}], ")"}]}], "+", 
       RowBox[{"d", " ", 
        SuperscriptBox[
         RowBox[{"k", "[", "2", "]"}], "2"]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
        RowBox[{"k", "[", "1", "]"}], " ", 
        RowBox[{"k", "[", "3", "]"}]}], "+", 
       RowBox[{"2", " ", "d", " ", 
        RowBox[{"k", "[", "2", "]"}], " ", 
        RowBox[{"k", "[", "3", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"k", "[", "3", "]"}], "2"]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"], " ", 
     SuperscriptBox["a", "2"]}], 
    RowBox[{"8", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      FractionBox["1", "a"], "]"}], "0"],
    SeriesData[$CellContext`a, 
     DirectedInfinity[1], {}, -2, 0, 1],
    Editable->False]}],
  SeriesData[$CellContext`a, 
   DirectedInfinity[1], {
   Rational[1, 
      8] (-1 + $CellContext`d)^(-1) $CellContext`z1^2 (-(-2 + $CellContext`d) \
$CellContext`k[1]^2 + $CellContext`d $CellContext`k[2]^2 - 
     2 (-2 + $CellContext`d) $CellContext`k[1] $CellContext`k[3] + 
     2 $CellContext`d $CellContext`k[2] $CellContext`k[3] + 
     2 $CellContext`k[3]^2) $CellContext`sc[
       $CellContext`e[1], 
       $CellContext`e[2]]^2 $CellContext`sc[
       $CellContext`e[3], 
       $CellContext`e[4]]^2}, -2, 0, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.9120125371991014`*^9, 3.9120125951524754`*^9}, 
   3.9120126845384274`*^9, {3.9120128260236206`*^9, 3.9120128764934044`*^9}, 
   3.9120650580706773`*^9, 3.912274023266324*^9, 3.9122742051942673`*^9, 
   3.9122746073728156`*^9, 3.912275092437455*^9, {3.912275164679777*^9, 
   3.912275185421298*^9}, 3.91257980084575*^9, 3.918539839040471*^9, 
   3.9185422230058336`*^9, 3.918546434211212*^9, 3.918546716539793*^9, 
   3.918567191227996*^9, 3.9186448237398653`*^9, 3.937045921583023*^9, 
   3.9370466158143883`*^9},
 CellLabel->
  "Out[267]=",ExpressionUUID->"e33c321a-6118-4079-8567-da67889b1b0d"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"c", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"d", " ", 
    SuperscriptBox[
     RowBox[{"c", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{"8", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"d", " ", 
    SuperscriptBox[
     RowBox[{"c", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{"8", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"c", "[", "1", "]"}], " ", 
    RowBox[{"c", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"d", " ", 
    RowBox[{"c", "[", "1", "]"}], " ", 
    RowBox[{"c", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"d", " ", 
    RowBox[{"c", "[", "2", "]"}], " ", 
    RowBox[{"c", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"c", "[", "3", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"c", "[", "1", "]"}], " ", 
    RowBox[{"s", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "1"}], "+", "d"}]], "-", 
  FractionBox[
   RowBox[{"d", " ", 
    RowBox[{"c", "[", "1", "]"}], " ", 
    RowBox[{"s", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"c", "[", "3", "]"}], " ", 
    RowBox[{"s", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "1"}], "+", "d"}]], "-", 
  FractionBox[
   RowBox[{"d", " ", 
    RowBox[{"c", "[", "3", "]"}], " ", 
    RowBox[{"s", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"s", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "1"}], "+", "d"}]], "-", 
  FractionBox[
   RowBox[{"d", " ", 
    SuperscriptBox[
     RowBox[{"s", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"d", " ", 
    RowBox[{"c", "[", "2", "]"}], " ", 
    RowBox[{"s", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"d", " ", 
    RowBox[{"c", "[", "3", "]"}], " ", 
    RowBox[{"s", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"d", " ", 
    SuperscriptBox[
     RowBox[{"s", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"c", "[", "1", "]"}], " ", 
    RowBox[{"s", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "1"}], "+", "d"}]], "-", 
  FractionBox[
   RowBox[{"d", " ", 
    RowBox[{"c", "[", "1", "]"}], " ", 
    RowBox[{"s", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"d", " ", 
    RowBox[{"c", "[", "2", "]"}], " ", 
    RowBox[{"s", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"c", "[", "3", "]"}], " ", 
    RowBox[{"s", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "1"}], "+", "d"}]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"s", "[", "1", "]"}], " ", 
    RowBox[{"s", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "1"}], "+", "d"}]], "-", 
  FractionBox[
   RowBox[{"d", " ", 
    RowBox[{"s", "[", "1", "]"}], " ", 
    RowBox[{"s", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "1"}], "+", "d"}]], "+", 
  FractionBox[
   RowBox[{"d", " ", 
    RowBox[{"s", "[", "2", "]"}], " ", 
    RowBox[{"s", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "1"}], "+", "d"}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"s", "[", "3", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "1"}], "+", "d"}]]}]], "Output",
 CellChangeTimes->{{3.9120125371991014`*^9, 3.9120125951524754`*^9}, 
   3.9120126845384274`*^9, {3.9120128260236206`*^9, 3.9120128764934044`*^9}, 
   3.9120650580706773`*^9, 3.912274023266324*^9, 3.9122742051942673`*^9, 
   3.9122746073728156`*^9, 3.912275092437455*^9, {3.912275164679777*^9, 
   3.912275185421298*^9}, 3.91257980084575*^9, 3.918539839040471*^9, 
   3.9185422230058336`*^9, 3.918546434211212*^9, 3.918546716539793*^9, 
   3.918567191227996*^9, 3.9186448237398653`*^9, 3.937045921583023*^9, 
   3.9370466160583878`*^9},
 CellLabel->
  "Out[268]=",ExpressionUUID->"fe0e2d98-5356-4345-b832-f9b9f8e5df83"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "f"}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"c", "[", "3", "]"}], " ", 
      RowBox[{"s", "[", "1", "]"}]}], "-", 
     RowBox[{"d", " ", 
      RowBox[{"c", "[", "3", "]"}], " ", 
      RowBox[{"s", "[", "1", "]"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"s", "[", "1", "]"}], "2"]}], "-", 
     RowBox[{"d", " ", 
      SuperscriptBox[
       RowBox[{"s", "[", "1", "]"}], "2"]}], "+", 
     RowBox[{"d", " ", 
      RowBox[{"c", "[", "2", "]"}], " ", 
      RowBox[{"s", "[", "2", "]"}]}], "+", 
     RowBox[{"d", " ", 
      RowBox[{"c", "[", "3", "]"}], " ", 
      RowBox[{"s", "[", "2", "]"}]}], "+", 
     RowBox[{"d", " ", 
      SuperscriptBox[
       RowBox[{"s", "[", "2", "]"}], "2"]}], "+", 
     RowBox[{"d", " ", 
      RowBox[{"c", "[", "2", "]"}], " ", 
      RowBox[{"s", "[", "3", "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"c", "[", "3", "]"}], " ", 
      RowBox[{"s", "[", "3", "]"}]}], "+", 
     RowBox[{"4", " ", 
      RowBox[{"s", "[", "1", "]"}], " ", 
      RowBox[{"s", "[", "3", "]"}]}], "-", 
     RowBox[{"2", " ", "d", " ", 
      RowBox[{"s", "[", "1", "]"}], " ", 
      RowBox[{"s", "[", "3", "]"}]}], "+", 
     RowBox[{"2", " ", "d", " ", 
      RowBox[{"s", "[", "2", "]"}], " ", 
      RowBox[{"s", "[", "3", "]"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"s", "[", "3", "]"}], "2"]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
      RowBox[{"c", "[", "1", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"s", "[", "1", "]"}], "+", 
        RowBox[{"s", "[", "3", "]"}]}], ")"}]}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"e", "[", "1", "]"}], ",", 
      RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"e", "[", "3", "]"}], ",", 
      RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{{3.9120125371991014`*^9, 3.9120125951524754`*^9}, 
   3.9120126845384274`*^9, {3.9120128260236206`*^9, 3.9120128764934044`*^9}, 
   3.9120650580706773`*^9, 3.912274023266324*^9, 3.9122742051942673`*^9, 
   3.9122746073728156`*^9, 3.912275092437455*^9, {3.912275164679777*^9, 
   3.912275185421298*^9}, 3.91257980084575*^9, 3.918539839040471*^9, 
   3.9185422230058336`*^9, 3.918546434211212*^9, 3.918546716539793*^9, 
   3.918567191227996*^9, 3.9186448237398653`*^9, 3.937045921583023*^9, 
   3.937046616305418*^9},
 CellLabel->
  "Out[269]=",ExpressionUUID->"0fb57b89-bbf5-4c9f-b711-9708e68c80cd"]
}, Open  ]],

Cell["all terms we bootstrap so far", "Text",
 CellChangeTimes->{{3.9186448322872696`*^9, 
  3.91864483917336*^9}},ExpressionUUID->"41904a11-8a83-4788-ab17-\
c3c397472acd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"opefactorizationansatz", "[", 
   RowBox[{
   "z1_", ",", "ks_", ",", "kt_", ",", "k1_", ",", "k2_", ",", "k3_", ",", 
    "k4_", ",", "e1_", ",", "e2_", ",", "e3_", ",", "e4_", ",", "s1_", ",", 
    "s2_", ",", "s3_", ",", "s4_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"pi22GR1234", "[", 
        RowBox[{
        "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
         "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
         "s2", ",", "s3", ",", "s4"}], "]"}], 
       SubscriptBox["D", "ks"]], "/.", "rulesinv"}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"baGR1234", "[", 
        RowBox[{
        "z1", ",", "ks", ",", "k1", ",", "k2", ",", "k3", ",", "k4", ",", 
         "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", "s2", ",", 
         "s3", ",", "s4"}], "]"}], "+", 
       RowBox[{"bspGR1234", "[", 
        RowBox[{
        "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
         "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
         "s2", ",", "s3", ",", "s4"}], "]"}], "+", 
       RowBox[{"brGR1234", "[", 
        RowBox[{
        "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
         "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
         "s2", ",", "s3", ",", "s4"}], "]"}], "+", 
       RowBox[{"badGR1234", "[", 
        RowBox[{
        "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
         "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
         "s2", ",", "s3", ",", "s4"}], "]"}]}], "/.", "rulesinv"}], ")"}]}], 
   RowBox[{"(*", 
    RowBox[{"+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CsGR1234", "[", 
        RowBox[{
        "z1", ",", "ks", ",", "k1", ",", "k2", ",", "k3", ",", "k4", ",", 
         "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", "s2", ",", 
         "s3", ",", "s4"}], "]"}], "/.", "rulesinv"}], ")"}]}], "*)"}], 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.9120127421660037`*^9, 3.912012780242607*^9}},
 CellLabel->
  "In[270]:=",ExpressionUUID->"3a24bee1-7d73-4984-9d00-57f49d3a3807"],

Cell[BoxData[
 RowBox[{
  RowBox[{"opeFactorizeLorenB", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"opefactorizationansatz", "[", 
        RowBox[{
        "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
         "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
         "s2", ",", "s3", ",", "s4"}], "]"}], "/.", "rulesinv"}], ")"}], "-", 
     "nonlorentzinv"}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9120130293017845`*^9, 3.9120130307364078`*^9}},
 CellLabel->
  "In[271]:=",ExpressionUUID->"d5d94268-f744-4ed5-9b33-7f68b11a252d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"opeFactorizeLorenB", "/.", 
         RowBox[{"y4s", "->", "0"}]}], "/.", 
        RowBox[{"ks", "->", "ks12"}]}], "/.", 
       RowBox[{
        SubscriptBox["D", "ks12"], "\[Rule]", 
        RowBox[{
         RowBox[{
          SuperscriptBox["z1", "2"], " ", 
          SuperscriptBox["ks12", "2"]}], " ", "+", 
         RowBox[{"4", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"s", "[", "1", "]"}], "+", 
            RowBox[{"s", "[", "2", "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"s", "[", "3", "]"}], "+", 
            RowBox[{"s", "[", "4", "]"}]}], ")"}]}]}]}]}], "/.", 
      RowBox[{
       RowBox[{"s", "[", "i_", "]"}], "\[RuleDelayed]", 
       FractionBox[
        RowBox[{"z1", " ", 
         RowBox[{"k", "[", "i", "]"}]}], "2"]}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "i_", "]"}], ",", 
          RowBox[{"k", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"kk", "[", "i", "]"}], ",", 
          RowBox[{"kk", "[", "j", "]"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "i_", "]"}], ",", 
          RowBox[{"k", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "i", "]"}], ",", 
          RowBox[{"kk", "[", "j", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
    RowBox[{
     RowBox[{"k", "[", "4", "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"k", "[", "1", "]"}]}], "-", 
      RowBox[{"k", "[", "2", "]"}], "-", 
      RowBox[{"k", "[", "3", "]"}]}]}]}], "//", "Simplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{"%", ",", 
      RowBox[{"{", 
       RowBox[{"z1", ",", "Infinity", ",", 
        RowBox[{"-", "2"}]}], "}"}]}], "]"}], "//", "Normal"}], "//", 
   "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//", "Expand"}], "//", "Simplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["ks12", "2"], "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"k", "[", "1", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"k", "[", "2", "]"}], "2"], "+", 
         RowBox[{"2", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"kk", "[", "1", "]"}], ",", 
            RowBox[{"kk", "[", "2", "]"}]}], "]"}]}]}]}], ",", 
       RowBox[{
        SuperscriptBox["ks12", "4"], "\[Rule]", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"k", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"k", "[", "2", "]"}], "2"], "+", 
           RowBox[{"2", 
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"kk", "[", "1", "]"}], ",", 
              RowBox[{"kk", "[", "2", "]"}]}], "]"}]}]}], ")"}], "2"]}]}], 
      "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["kt", "2"], "\[Rule]", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"k", "[", "3", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"k", "[", "2", "]"}], "2"], "+", 
        RowBox[{"2", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"kk", "[", "3", "]"}], ",", 
           RowBox[{"kk", "[", "2", "]"}]}], "]"}]}]}]}], ",", 
      RowBox[{
       SuperscriptBox["kt", "4"], "\[Rule]", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"k", "[", "3", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"k", "[", "2", "]"}], "2"], "+", 
          RowBox[{"2", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"kk", "[", "3", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}]}]}], ")"}], "2"]}]}], 
     "}"}]}], "//", "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GRadsnstest", "=", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"kk", "[", "i_", "]"}], ",", 
        RowBox[{"kk", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "+", 
       RowBox[{
        RowBox[{"k", "[", "i", "]"}], 
        RowBox[{"k", "[", "j", "]"}]}]}]}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", 
  RowBox[{
   RowBox[{"FreeQ", "[", 
    RowBox[{"#", ",", 
     RowBox[{"k", "[", "_", "]"}]}], "]"}], "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GRadsnstest1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"GRadsnstest", "/.", 
           RowBox[{
            RowBox[{"k", "[", "4", "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"k", "[", "1", "]"}]}], "-", 
             RowBox[{"k", "[", "2", "]"}], "-", 
             RowBox[{"k", "[", "3", "]"}]}]}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "i_", "]"}], ",", 
              RowBox[{"kk", "[", "1", "]"}]}], "]"}], ":>", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i", "]"}], ",", 
               RowBox[{"kk", "[", "3", "]"}]}], "]"}], "-", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i", "]"}], ",", 
               RowBox[{"kk", "[", "4", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"kk", "[", "i_", "]"}], ",", 
            RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i_", "]"}], ",", 
           RowBox[{"kk", "[", "4", "]"}]}], "]"}], ":>", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "i", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], ",", 
            RowBox[{"kk", "[", "3", "]"}]}], "]"}], "-", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], ",", 
            RowBox[{"kk", "[", "1", "]"}]}], "]"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"kk", "[", "i_", "]"}], ",", 
          RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "//", 
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", "0", ",", "4"}], "}"}]}], 
        "]"}], "&"}]}], "//", "FullSimplify"}], "//", "Normal"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", 
  RowBox[{
   RowBox[{"FreeQ", "[", 
    RowBox[{"#", ",", 
     RowBox[{"k", "[", "_", "]"}]}], "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.912012787742747*^9, 3.9120127924932065`*^9}, {
   3.9120128890833664`*^9, 3.912012932122919*^9}, {3.912012973321225*^9, 
   3.9120130088976135`*^9}, 3.9125798188968163`*^9},
 CellLabel->
  "In[272]:=",ExpressionUUID->"4a8a2bb8-d661-49ee-afec-3f458fac7788"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.9186469047359943`*^9, 3.9370459279762416`*^9, 
  3.9370466217998357`*^9},
 CellLabel->
  "Out[277]=",ExpressionUUID->"d729d2d3-2501-46ff-b459-2938c340a0ac"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
    SuperscriptBox["z1", "2"], " ", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "2"}], "]"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{"8", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["z1", "2"], " ", 
   RowBox[{"sc", "[", 
    RowBox[{
     RowBox[{"e", "[", "1", "]"}], ",", 
     RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"sc", "[", 
    RowBox[{
     RowBox[{"e", "[", "3", "]"}], ",", 
     RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], ",", 
           RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], ",", 
           RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"kk", "[", "1", "]"}]}], "]"}]}]}], ")"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "4", "]"}], ",", 
        RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"2", ",", "3"}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "3", "]"}], ",", 
             RowBox[{"kk", "[", "1", "]"}]}], "]"}], "+", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "3", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], ")"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "4", "]"}], ",", 
           RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "4", "]"}], ",", 
           RowBox[{"kk", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
  "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "2"}], "]"}]}]], 
   RowBox[{
    SuperscriptBox["z1", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "1", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "2", "]"}], ",", 
             RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "1", "]"}], ",", 
             RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "2", "]"}], ",", 
             RowBox[{"kk", "[", "1", "]"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "4", "]"}], ",", 
          RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{"2", ",", "3"}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "3", "]"}], ",", 
             RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "3", "]"}], ",", 
               RowBox[{"kk", "[", "1", "]"}]}], "]"}], "+", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "3", "]"}], ",", 
               RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], ")"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "4", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "3", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "4", "]"}], ",", 
             RowBox[{"kk", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}], 
     "2"]}]}]}]], "Output",
 CellChangeTimes->{3.9186469047359943`*^9, 3.9370459279762416`*^9, 
  3.937046622063835*^9},
 CellLabel->
  "Out[278]=",ExpressionUUID->"85def0a7-67fd-4f03-b85a-78d3734725c2"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.9186469047359943`*^9, 3.9370459279762416`*^9, 
  3.9370466223047533`*^9},
 CellLabel->
  "Out[279]=",ExpressionUUID->"15f1d5a6-8314-450c-a3b4-4529be4fa019"]
}, Open  ]],

Cell["\<\
first check whether the ansatz make the original expression lorentz invariant\
\>", "Text",
 CellChangeTimes->{{3.9186448490880823`*^9, 
  3.9186448645268745`*^9}},ExpressionUUID->"ca6cde1d-3315-4b09-8e4f-\
586a6b7a7b2b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["C", "0"], "(", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], ")"}], TraditionalForm]],
  ExpressionUUID->"a949b861-cd5a-47f2-86b8-8033c4884a1e"],
 ": external soft limit after dimension reduction"
}], "Subsection",
 CellChangeTimes->{{3.918660799997279*^9, 3.918660802991374*^9}, {
  3.9370465489749737`*^9, 
  3.9370465626228666`*^9}},ExpressionUUID->"d26883c0-91fe-42e0-84db-\
c6b396b48cc3"],

Cell[CellGroupData[{

Cell["\<\
Now we put the ansatz back to the expression and make it vanish in soft limit \
after dim reducing 1 and 2\
\>", "Subsubsection",
 CellChangeTimes->{{3.9186454878710833`*^9, 
  3.9186455196482077`*^9}},ExpressionUUID->"d3e89ab2-22e6-4fba-9ff2-\
95df211d514e"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.918646949808959*^9, 3.918646957963211*^9}, 
   3.918660394556252*^9},
 CellLabel->
  "In[280]:=",ExpressionUUID->"133a7fea-bbf0-45f4-b036-f61d97216717"],

Cell[BoxData[
 RowBox[{
  RowBox[{"softk1", "[", "p_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"p", "/.", "\[VeryThinSpace]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SuperscriptBox["ks", "2"], "\[Rule]", 
          SuperscriptBox[
           RowBox[{"k", "[", "2", "]"}], "2"]}], ",", 
         RowBox[{
          SuperscriptBox["ks", "4"], "\[Rule]", 
          SuperscriptBox[
           RowBox[{"k", "[", "2", "]"}], "4"]}], ",", 
         RowBox[{
          FractionBox["1", 
           SuperscriptBox["ks", "2"]], "\[Rule]", 
          FractionBox["1", 
           SuperscriptBox[
            RowBox[{"k", "[", "2", "]"}], "2"]]}], ",", 
         RowBox[{
          FractionBox["1", 
           SuperscriptBox["ks", "4"]], "\[Rule]", 
          FractionBox["1", 
           SuperscriptBox[
            RowBox[{"k", "[", "2", "]"}], "4"]]}]}], "}"}]}], "/.", 
      "\[VeryThinSpace]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SuperscriptBox["kt", "2"], "\[Rule]", 
         SuperscriptBox[
          RowBox[{"k", "[", "4", "]"}], "2"]}], ",", 
        RowBox[{
         SuperscriptBox["kt", "4"], "\[Rule]", 
         SuperscriptBox[
          RowBox[{"k", "[", "4", "]"}], "4"]}], ",", 
        RowBox[{
         FractionBox["1", 
          SuperscriptBox["kt", "2"]], "\[Rule]", 
         FractionBox["1", 
          SuperscriptBox[
           RowBox[{"k", "[", "4", "]"}], "2"]]}], ",", 
        RowBox[{
         FractionBox["1", 
          SuperscriptBox["kt", "4"]], "\[Rule]", 
         FractionBox["1", 
          SuperscriptBox[
           RowBox[{"k", "[", "4", "]"}], "4"]]}]}], "}"}]}], "/.", 
     "\[VeryThinSpace]", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"k", "[", "i_", "]"}]}], "]"}], "\[Rule]", "0"}]}], "/.", 
    "\[VeryThinSpace]", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"k", "[", "1", "]"}], ",", "_"}], "]"}], "\[Rule]", "0"}]}], "/.",
    "\[VeryThinSpace]", 
   RowBox[{
    RowBox[{"k", "[", "1", "]"}], "\[Rule]", "0"}]}]}]], "Input",
 CellChangeTimes->{3.9186469910682564`*^9},
 CellLabel->
  "In[281]:=",ExpressionUUID->"628a143e-8454-4996-b5ed-0b1d1f896bf7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"opeFactorizeLorenB", "//", "softk1"}], "//", "Simplify"}], "//",
       "ToShortestHelicityBasis4"}], "//", "nok4e4"}], "//", "softk1"}], "//",
    "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//", 
    RowBox[{
     RowBox[{"whatis", "[", 
      RowBox[{"#", ",", 
       RowBox[{"s", "[", "1", "]"}], ",", "d"}], "]"}], "&"}]}], "//", 
   "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"%", "//", "Expand"}], "//", "scanK2sOnshelllistmap"}], "//", 
   "Expand"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"lhs", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox["%", 
        RowBox[{" ", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "1", "]"}], ",", 
             RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "3", "]"}], ",", 
             RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}]}]], "//", 
       RowBox[{
        RowBox[{"AllOnshellinvlist", "[", 
         RowBox[{"#", ",", "2", ",", "z1"}], "]"}], "&"}]}], "//", 
      "Simplify"}], "//", 
     RowBox[{
      RowBox[{"scanMelindeltalistvar", "[", 
       RowBox[{"#", ",", 
        RowBox[{"s", "[", "2", "]"}]}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"whatis", "[", 
      RowBox[{"#", ",", 
       RowBox[{"s", "[", "1", "]"}], ",", "d"}], "]"}], "&"}]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{
  3.9120130727335644`*^9, {3.9120131027473*^9, 3.9120131068699713`*^9}, {
   3.9122746452462325`*^9, 3.912274645484563*^9}, {3.9185428024110575`*^9, 
   3.918542805461404*^9}},
 CellLabel->
  "In[282]:=",ExpressionUUID->"3c6111d7-4c5b-43dc-b89f-a6b576fd35dd"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "8"}], " ", 
    RowBox[{"(", 
     RowBox[{"f", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", "[", "1", "]"}], "+", 
         RowBox[{"c", "[", "3", "]"}]}], ")"}], " ", 
       RowBox[{"s", "[", "3", "]"}]}]}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["d", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"c", "[", "1", "]"}], "-", 
      RowBox[{"c", "[", "2", "]"}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"s", "[", "3", "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"s", "[", "4", "]"}]}]}], ")"}]}], "+", 
   RowBox[{"d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "4"}], " ", 
       RowBox[{"s", "[", "3", "]"}]}], "+", 
      RowBox[{
       RowBox[{"c", "[", "1", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         RowBox[{"4", " ", 
          RowBox[{"s", "[", "3", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"c", "[", "2", "]"}], " ", 
       RowBox[{"s", "[", "4", "]"}]}], "+", 
      RowBox[{
       RowBox[{"c", "[", "3", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         RowBox[{"4", " ", 
          RowBox[{"s", "[", "3", "]"}]}], "+", 
         RowBox[{"4", " ", 
          RowBox[{"s", "[", "4", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
  RowBox[{"8", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.9120130786401186`*^9, 3.9120131156079826`*^9}, 
   3.91227409736451*^9, 3.9122742524146724`*^9, {3.9122746218199563`*^9, 
   3.9122746720694017`*^9}, 3.9122752449968762`*^9, 3.912579831136726*^9, 
   3.9185398816248465`*^9, 3.918542484435421*^9, 3.918542854981514*^9, 
   3.918546797711248*^9, 3.9185672732389092`*^9, 3.918646684979298*^9, 
   3.918646948130823*^9, {3.9186469861745186`*^9, 3.9186470077699785`*^9}, 
   3.9370459299318495`*^9, 3.9370466234968057`*^9},
 CellLabel->
  "Out[285]=",ExpressionUUID->"30d2749b-4cad-4cbb-b6b1-a4c16bc8cb9a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqsoftdre12", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"lhs", "//", 
      RowBox[{
       RowBox[{"CoefficientList", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"s", "[", "3", "]"}], ",", 
           RowBox[{"s", "[", "4", "]"}]}], "}"}]}], "]"}], "&"}]}], "//", 
     "Flatten"}], "//", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{"#", ",", "0"}], "]"}], "&"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9122742904706264`*^9, 3.9122743082901607`*^9}, {
   3.9122744212606554`*^9, 3.912274423825094*^9}, 3.91227465097808*^9, {
   3.912274716694473*^9, 3.9122747176362934`*^9}, {3.918647023983024*^9, 
   3.91864703498396*^9}},
 CellLabel->
  "In[286]:=",ExpressionUUID->"643571d3-2a5a-49f1-997f-784b9246ce1d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sl", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"eqsoftdre12", "==", "0"}], "//", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"c", "[", "1", "]"}], ",", 
         RowBox[{"c", "[", "2", "]"}], ",", 
         RowBox[{"c", "[", "3", "]"}], ",", "f"}], "}"}]}], "]"}], "&"}]}], "//",
    "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.9122743321884003`*^9, 3.912274337330182*^9}, {
   3.912274385935179*^9, 3.9122743926218553`*^9}, {3.9122746930873723`*^9, 
   3.9122747315857573`*^9}, {3.91227526092489*^9, 3.9122752716515703`*^9}, {
   3.912275349682684*^9, 3.912275349922741*^9}, 3.918647039128419*^9},
 CellLabel->
  "In[287]:=",ExpressionUUID->"7d8cd47c-5dee-4556-a4aa-a04dfcc938c5"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    287, 1, 24847524935421610430, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.912275261238308*^9, 3.9122752720001884`*^9}, 
   3.9122753506518583`*^9, 3.9125798423227463`*^9, 3.912580763606406*^9, 
   3.9125808115500765`*^9, 3.9185468104578605`*^9, 3.918567287567299*^9, 
   3.9186467052917824`*^9, 3.9186470398676972`*^9, 3.937045930316861*^9, 
   3.9370466238078246`*^9},
 CellLabel->
  "During evaluation of \
In[287]:=",ExpressionUUID->"71898481-d379-4dc8-b56a-ff39c05c6bc0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c", "[", "2", "]"}], "\[Rule]", 
    RowBox[{"c", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "3", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["d", "2"]}], "-", 
     RowBox[{"c", "[", "1", "]"}]}]}], ",", 
   RowBox[{"f", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.9186470401050124`*^9, 3.937045930596635*^9, 
  3.937046624061818*^9},
 CellLabel->
  "Out[287]=",ExpressionUUID->"3200b470-2c9c-43ca-ab83-209031f70208"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"-", "nonlorentzinv"}], "/.", "sl"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{"c01234", "=", 
  RowBox[{"%", "//", "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.912580841850212*^9, 3.9125808481845827`*^9}, {
   3.912580883712361*^9, 3.9125808878227787`*^9}, 3.9185673237636003`*^9, {
   3.9185673942708206`*^9, 3.918567419608922*^9}, 3.9185676779613247`*^9, {
   3.9186470843449445`*^9, 3.91864708558187*^9}, {3.918660211750433*^9, 
   3.9186602133268147`*^9}},
 CellLabel->
  "In[288]:=",ExpressionUUID->"567b9795-c46d-4c7b-8d68-62b4bb1dac26"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"s", "[", "1", "]"}], "-", 
         RowBox[{"s", "[", "2", "]"}]}], ")"}]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"s", "[", "1", "]"}], "+", 
          RowBox[{"s", "[", "3", "]"}]}], ")"}], "2"]}], "-", 
      RowBox[{"2", " ", "d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"s", "[", "1", "]"}], "+", 
         SuperscriptBox[
          RowBox[{"s", "[", "1", "]"}], "2"], "-", 
         SuperscriptBox[
          RowBox[{"s", "[", "2", "]"}], "2"], "+", 
         RowBox[{"s", "[", "3", "]"}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"s", "[", "1", "]"}], " ", 
          RowBox[{"s", "[", "3", "]"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"s", "[", "2", "]"}], " ", 
          RowBox[{"s", "[", "3", "]"}]}]}], ")"}]}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.9125808455750933`*^9, 3.9125808483809443`*^9}, 
   3.9125808881893797`*^9, 3.918542472017346*^9, 3.918546777179114*^9, {
   3.91856729461053*^9, 3.918567324224839*^9}, {3.9185673964895973`*^9, 
   3.918567419821604*^9}, {3.9186470703438115`*^9, 3.9186470859487257`*^9}, 
   3.918660213748882*^9, 3.937045930898637*^9, 3.937046624330467*^9},
 CellLabel->
  "Out[288]=",ExpressionUUID->"c481dd8b-8949-4123-a3e6-f6cc1f4fc3d5"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["d", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"s", "[", "1", "]"}]}], "+", 
        RowBox[{"s", "[", "2", "]"}]}], ")"}]}], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"s", "[", "1", "]"}], "+", 
         RowBox[{"s", "[", "3", "]"}]}], ")"}], "2"]}], "+", 
     RowBox[{"2", " ", "d", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"s", "[", "1", "]"}], "2"], "+", 
        RowBox[{"s", "[", "3", "]"}], "+", 
        RowBox[{
         RowBox[{"s", "[", "1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", 
            RowBox[{"s", "[", "3", "]"}]}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"s", "[", "2", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"s", "[", "2", "]"}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"s", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}]}], ")"}], 
   " ", 
   SuperscriptBox[
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"e", "[", "1", "]"}], ",", 
      RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"e", "[", "3", "]"}], ",", 
      RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
  RowBox[{"4", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.9125808455750933`*^9, 3.9125808483809443`*^9}, 
   3.9125808881893797`*^9, 3.918542472017346*^9, 3.918546777179114*^9, {
   3.91856729461053*^9, 3.918567324224839*^9}, {3.9185673964895973`*^9, 
   3.918567419821604*^9}, {3.9186470703438115`*^9, 3.9186470859487257`*^9}, 
   3.918660213748882*^9, 3.937045930898637*^9, 3.9370466245798254`*^9},
 CellLabel->
  "Out[289]=",ExpressionUUID->"540c03b7-4d20-45b0-9f0b-e93dd99a9f18"]
}, Open  ]],

Cell["The solution is equivalent to C", "Text",
 CellChangeTimes->{{3.9186596530259914`*^9, 3.9186596583810873`*^9}, 
   3.9186602036166544`*^9},ExpressionUUID->"5835f165-3de2-40a8-ba99-\
f416ad9fa703"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"c01234", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox["%", 
     RowBox[{
      RowBox[{"CsGR1234", "[", 
       RowBox[{
       "z1", ",", "ks", ",", "k1", ",", "k2", ",", "k3", ",", "k4", ",", "e1",
         ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", "s2", ",", "s3", 
        ",", "s4"}], "]"}], "/.", "rulesinv"}]], "/.", 
    RowBox[{
     SubscriptBox["s", "i_"], "->", 
     RowBox[{"s", "[", "i", "]"}]}]}], "//", 
   RowBox[{
    RowBox[{"scanMelindeltalistvar", "[", 
     RowBox[{"#", ",", 
      RowBox[{"s", "[", "1", "]"}]}], "]"}], "&"}]}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.918660066119037*^9, 3.9186600936514835`*^9}, {
  3.918660177666246*^9, 3.918660221073532*^9}},
 CellLabel->
  "In[290]:=",ExpressionUUID->"46949df7-37a6-45c5-a8fd-6875e2cc7118"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.918660024093482*^9, {3.918660084218613*^9, 3.918660094259098*^9}, {
   3.9186601801068335`*^9, 3.9186601909911194`*^9}, 3.9186602214347744`*^9, 
   3.9370459316176577`*^9, 3.9370466248718634`*^9},
 CellLabel->
  "Out[291]=",ExpressionUUID->"7ba6a124-302e-454a-a235-98c54444c2a9"]
}, Open  ]],

Cell["\<\
in CsGR1234 we use a symmetry ansatz to soft the soft limit constrain, giving\
\>", "Text",
 CellChangeTimes->{{3.9186602359672194`*^9, 3.9186602738955812`*^9}, {
  3.9186607557503867`*^9, 
  3.9186607563503447`*^9}},ExpressionUUID->"381c1e5f-b836-4545-ba6a-\
345053805e82"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CsGR1234", "[", 
  RowBox[{
  "z1", ",", "ks", ",", "k1", ",", "k2", ",", "k3", ",", "k4", ",", "e1", ",",
    "e2", ",", "e3", ",", "e4", ",", "s1", ",", "s2", ",", "s3", ",", "s4"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9186601100247326`*^9, 3.918660125210208*^9}, 
   3.9186601615800123`*^9},
 CellLabel->
  "In[292]:=",ExpressionUUID->"0fcd19e7-a51c-4baf-b8f3-231a5e2725ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    FractionBox[
     SuperscriptBox["d", "2"], 
     RowBox[{"16", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"s1", "-", "s2"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"s3", "-", "s4"}], ")"}], "2"]}], 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"s1", "-", "s2"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"s3", "-", "s4"}], ")"}]}]}], ")"}], " ", 
  SuperscriptBox[
   RowBox[{"sc", "[", 
    RowBox[{"e1", ",", "e2"}], "]"}], "2"], " ", 
  SuperscriptBox[
   RowBox[{"sc", "[", 
    RowBox[{"e3", ",", "e4"}], "]"}], "2"]}]], "Output",
 CellChangeTimes->{3.9186601259429655`*^9, 3.918660162336951*^9, 
  3.937045931916157*^9, 3.937046625113864*^9},
 CellLabel->
  "Out[292]=",ExpressionUUID->"93d0a3f7-17a4-4a82-932b-9f6c79968b00"]
}, Open  ]],

Cell["this is also equivalent to what we used in the text", "Text",
 CellChangeTimes->{{3.9186602865277233`*^9, 
  3.91866029918301*^9}},ExpressionUUID->"197eb863-acae-498f-93f9-\
53b3caceaec9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["d", "2"], "+", 
    RowBox[{"8", " ", "d", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["s", "1"], "-", 
       SubscriptBox["s", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["s", "3"], "-", 
       SubscriptBox["s", "4"]}], ")"}]}], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["s", "1"], "-", 
        SubscriptBox["s", "2"], "+", 
        SubscriptBox["s", "3"], "-", 
        SubscriptBox["s", "4"]}], ")"}], "2"]}]}], 
   RowBox[{"16", " ", 
    RowBox[{"(", 
     RowBox[{"d", "-", "1"}], ")"}]}]], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "-", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       SuperscriptBox["d", "2"], 
       RowBox[{"16", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["s", "1"], "-", 
           SubscriptBox["s", "2"]}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["s", "3"], "-", 
           SubscriptBox["s", "4"]}], ")"}], "2"]}], 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["s", "1"], "-", 
         SubscriptBox["s", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["s", "3"], "-", 
         SubscriptBox["s", "4"]}], ")"}]}]}], ")"}]}], "/.", "rulesinv"}], "//",
   "Simplify"}]}], "Input",
 CellChangeTimes->{{3.9185680728128667`*^9, 3.9185681015454063`*^9}, {
  3.918647114267888*^9, 3.918647127124002*^9}, {3.918660303464858*^9, 
  3.918660342027349*^9}, {3.9186607890893292`*^9, 3.918660792022048*^9}},
 CellLabel->
  "In[293]:=",ExpressionUUID->"2e50cfea-2c19-43af-8eab-4f0354ec61ff"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.918568094256321*^9, 3.9185681027656145`*^9}, 
   3.918647138922018*^9, 3.9186599900785103`*^9, {3.918660315691677*^9, 
   3.918660332495517*^9}, {3.9186607904926395`*^9, 3.91866079233387*^9}, 
   3.9370459322091475`*^9, 3.9370466253645444`*^9},
 CellLabel->
  "Out[294]=",ExpressionUUID->"e4df31ec-3abb-4306-a7bb-97fafd780898"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["GR flat space limit initialize (just run)", "Subsubsection",
 CellChangeTimes->{{3.911669629684531*^9, 3.911669641661518*^9}, {
  3.91866085528605*^9, 
  3.9186608566200376`*^9}},ExpressionUUID->"640f073b-c174-4428-af1a-\
9bb11f1718b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ns", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k1", ",", 
       RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k3", ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k2", ",", 
       RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k3", ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k1", ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k4", ",", 
       RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k2", ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k4", ",", 
       RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k1", ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k3", ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}]}], "-", 
    RowBox[{"4", " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k1", ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k4", ",", 
       RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}], "-", 
    RowBox[{"4", " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k2", ",", 
       RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k3", ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e2", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k1", ",", "k2"}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e2", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k2", ",", 
       RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k4", ",", 
       RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e2", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k1", ",", "k2"}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e2", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k1", ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k3", ",", 
       RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e3", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k2", ",", 
       RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k3", ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e3", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k1", ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k4", ",", 
       RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e3", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k2", ",", 
       RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k4", ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e3", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{"k1", ",", "k3"}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e3", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{"k1", ",", "k4"}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e3", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{"k2", ",", "k3"}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e3", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{"k2", ",", "k4"}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e1", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "e3", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}]}]}], ";"}]], "Input",
 CellLabel->
  "In[295]:=",ExpressionUUID->"343f0661-d56e-484e-8f59-a3bcbe8ff015"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GRns", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               FractionBox[
                SuperscriptBox["ns", "2"], 
                RowBox[{"S", "[", 
                 RowBox[{"1", ",", "2"}], "]"}]], "/.", "rulesinv"}], "/.", 
              RowBox[{
               RowBox[{"\[Mu]", "[", 
                RowBox[{"e", "[", "x_", "]"}], "]"}], "->", 
               RowBox[{"e", "[", "x", "]"}]}]}], "/.", 
             RowBox[{
              RowBox[{"s", "[", "i_", "]"}], "\[RuleDelayed]", 
              FractionBox[
               RowBox[{"z1", " ", 
                RowBox[{"k", "[", "i", "]"}]}], "2"]}]}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"k", "[", "i_", "]"}], ",", 
                 RowBox[{"k", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"kk", "[", "i", "]"}], ",", 
                 RowBox[{"kk", "[", "j", "]"}]}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"e", "[", "i_", "]"}], ",", 
                 RowBox[{"k", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"e", "[", "i", "]"}], ",", 
                 RowBox[{"kk", "[", "j", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
           RowBox[{
            RowBox[{"k", "[", "4", "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"k", "[", "1", "]"}]}], "-", 
             RowBox[{"k", "[", "2", "]"}], "-", 
             RowBox[{"k", "[", "3", "]"}]}]}]}], "/.", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"kk", "[", "i_", "]"}], ",", 
             RowBox[{"kk", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
           RowBox[{"S", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{"3", ",", "4"}], "]"}], "->", 
          RowBox[{"S", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"1", ",", "4"}], "]"}], "->", 
         RowBox[{"S", "[", 
          RowBox[{"2", ",", "3"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{"S", "[", 
         RowBox[{"1", ",", "3"}], "]"}], "->", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"S", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}], "-", 
         RowBox[{"S", "[", 
          RowBox[{"2", ",", "3"}], "]"}]}]}]}], "/.", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "4"}], "]"}], "->", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"S", "[", 
          RowBox[{"1", ",", "2"}], "]"}]}], "-", 
        RowBox[{"S", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}]}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"+", 
        RowBox[{"k", "[", "i", "]"}]}], 
       RowBox[{"k", "[", "j", "]"}]}], "*)"}], "//", "Expand"}], "//", 
    "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{3.911669389622587*^9},
 CellLabel->
  "In[296]:=",ExpressionUUID->"b29ed40b-6814-4977-b908-132d3b3275cf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"GRflat", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            FractionBox["1", "32"], 
            SuperscriptBox["z1", "2"], "GRns"}], "/.", 
           RowBox[{"kk", "->", "k"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "i_", "]"}], ",", 
              RowBox[{"k", "[", "1", "]"}]}], "]"}], ":>", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "-", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i", "]"}], ",", 
               RowBox[{"k", "[", "3", "]"}]}], "]"}], "-", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i", "]"}], ",", 
               RowBox[{"k", "[", "4", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"k", "[", "i_", "]"}], ",", 
            RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i_", "]"}], ",", 
           RowBox[{"k", "[", "4", "]"}]}], "]"}], ":>", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "i", "]"}], ",", 
             RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "-", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], ",", 
            RowBox[{"k", "[", "3", "]"}]}], "]"}], "-", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], ",", 
            RowBox[{"k", "[", "1", "]"}]}], "]"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "i_", "]"}], ",", 
          RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", 
      RowBox[{"k", "->", "kk"}]}], "//", "Simplify"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", 
  RowBox[{
   RowBox[{"FreeQ", "[", 
    RowBox[{"#", ",", 
     RowBox[{"kk", "[", "4", "]"}]}], "]"}], "&"}]}]}], "Input",
 CellLabel->
  "In[297]:=",ExpressionUUID->"6eb45972-9d00-435c-ac8f-50f412826417"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.911667710916993*^9, 3.9116680060396557`*^9, 
  3.9116681094694347`*^9, 3.911668139668657*^9, 3.911669241933899*^9, 
  3.911669358682846*^9, 3.9116693930262213`*^9, 3.911669440125927*^9, 
  3.9116697161023684`*^9, 3.9117154745416775`*^9, 3.9117440052148438`*^9, 
  3.911801596494048*^9, 3.911804945911009*^9, 3.911835227434885*^9, 
  3.9119750144395466`*^9, 3.912065035326528*^9, 3.912065633300026*^9, 
  3.9120658412595825`*^9, 3.912165539957532*^9, 3.9185463132633495`*^9, 
  3.9186608588613663`*^9, 3.9370459325751486`*^9, 3.9370466257073464`*^9},
 CellLabel->
  "Out[298]=",ExpressionUUID->"a83cd108-0f4e-4249-898a-90df7e4c29e4"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["C", "1"], "(", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], ")"}], TraditionalForm]],
  ExpressionUUID->"3f0de69e-d321-4e14-afd4-c7880cf182e0"],
 ": flat-space limit"
}], "Subsection",
 CellChangeTimes->{{3.918660808374093*^9, 3.9186608128035593`*^9}, {
  3.9370465742174015`*^9, 
  3.93704657866832*^9}},ExpressionUUID->"71f4e462-3a93-405b-905c-\
6d7935eeaf8d"],

Cell["These are terms that we have so far ", "Text",
 CellChangeTimes->{{3.918661133398114*^9, 
  3.9186611418134375`*^9}},ExpressionUUID->"5f00dc47-5ff6-4099-ba41-\
e03c5b1dfb95"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MgrOPEpoleFree", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"pi22GR1234", "[", 
         RowBox[{
         "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
          "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
          "s2", ",", "s3", ",", "s4"}], "]"}], 
        SubscriptBox["D", "ks"]], "/.", "rulesinv"}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"baGR1234", "[", 
         RowBox[{
         "z1", ",", "ks", ",", "k1", ",", "k2", ",", "k3", ",", "k4", ",", 
          "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", "s2", ",", 
          "s3", ",", "s4"}], "]"}], "+", 
        RowBox[{"bspGR1234", "[", 
         RowBox[{
         "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
          "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
          "s2", ",", "s3", ",", "s4"}], "]"}], "+", 
        RowBox[{"brGR1234", "[", 
         RowBox[{
         "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
          "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
          "s2", ",", "s3", ",", "s4"}], "]"}], "+", 
        RowBox[{"badGR1234", "[", 
         RowBox[{
         "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
          "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
          "s2", ",", "s3", ",", "s4"}], "]"}]}], "/.", "rulesinv"}], ")"}], 
     "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CsGR1234", "[", 
        RowBox[{
        "z1", ",", "ks", ",", "k1", ",", "k2", ",", "k3", ",", "k4", ",", 
         "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", "s2", ",", 
         "s3", ",", "s4"}], "]"}], "/.", "rulesinv"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"+", 
         RowBox[{"CfGR1234", "[", 
          RowBox[{
          "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", 
           "k4", ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", 
           "s2", ",", "s3", ",", "s4"}], "]"}]}], "/.", "rulesinv"}], "*)"}], 
      ")"}]}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9115440254350057`*^9, 3.9115440390743103`*^9}, 
   3.9115442009790154`*^9, 3.911577095835724*^9, {3.911577389824408*^9, 
   3.9115773910300827`*^9}, {3.91166741334405*^9, 3.9116674204042892`*^9}, {
   3.911667505762064*^9, 3.9116675087485523`*^9}, 3.911667550796292*^9, 
   3.911667605334298*^9, 3.911667988414918*^9, 3.9116680964628143`*^9, 
   3.9118049120209885`*^9, 3.9186608262792664`*^9, {3.9186610562885838`*^9, 
   3.9186610624325447`*^9}},
 CellLabel->
  "In[299]:=",ExpressionUUID->"6d62815f-c3fb-4f92-b824-5f11940c235a"],

Cell[TextData[{
 "it is already lorentz inv. we will compare it with actual flarspace 4 point \
GR s channel diagram and the comparism fixes ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["C", "1"], "(", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], ")"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "7d85fa73-c160-47e6-a760-c378bde405c4"]
}], "Text",
 CellChangeTimes->{{3.918661210685653*^9, 
  3.918661254965784*^9}},ExpressionUUID->"dd31c34f-e73e-4368-a803-\
270a3cfcb8ba"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"MgrOPEpoleFree", "/.", 
          RowBox[{"y4s", "->", "0"}]}], "/.", 
         RowBox[{"ks", "->", "ks12"}]}], "/.", 
        RowBox[{
         SubscriptBox["D", "ks12"], "\[Rule]", 
         RowBox[{
          RowBox[{
           SuperscriptBox["z1", "2"], " ", 
           SuperscriptBox["ks12", "2"]}], " ", "+", 
          RowBox[{"4", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"s", "[", "1", "]"}], "+", 
             RowBox[{"s", "[", "2", "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"s", "[", "3", "]"}], "+", 
             RowBox[{"s", "[", "4", "]"}]}], ")"}]}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"s", "[", "i_", "]"}], "\[RuleDelayed]", 
        FractionBox[
         RowBox[{"z1", " ", 
          RowBox[{"k", "[", "i", "]"}]}], "2"]}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"k", "[", "i_", "]"}], ",", 
           RowBox[{"k", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"kk", "[", "i", "]"}], ",", 
           RowBox[{"kk", "[", "j", "]"}]}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i_", "]"}], ",", 
           RowBox[{"k", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i", "]"}], ",", 
           RowBox[{"kk", "[", "j", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
     RowBox[{
      RowBox[{"k", "[", "4", "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"k", "[", "1", "]"}]}], "-", 
       RowBox[{"k", "[", "2", "]"}], "-", 
       RowBox[{"k", "[", "3", "]"}]}]}]}], "//", "Simplify"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{"%", ",", 
      RowBox[{"{", 
       RowBox[{"z1", ",", "Infinity", ",", 
        RowBox[{"-", "2"}]}], "}"}]}], "]"}], "//", "Normal"}], "//", 
   "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//", "Expand"}], "//", "Simplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["ks12", "2"], "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"k", "[", "1", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"k", "[", "2", "]"}], "2"], "+", 
         RowBox[{"2", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"kk", "[", "1", "]"}], ",", 
            RowBox[{"kk", "[", "2", "]"}]}], "]"}]}]}]}], ",", 
       RowBox[{
        SuperscriptBox["ks12", "4"], "\[Rule]", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"k", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"k", "[", "2", "]"}], "2"], "+", 
           RowBox[{"2", 
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"kk", "[", "1", "]"}], ",", 
              RowBox[{"kk", "[", "2", "]"}]}], "]"}]}]}], ")"}], "2"]}]}], 
      "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["kt", "2"], "\[Rule]", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"k", "[", "3", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"k", "[", "2", "]"}], "2"], "+", 
        RowBox[{"2", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"kk", "[", "3", "]"}], ",", 
           RowBox[{"kk", "[", "2", "]"}]}], "]"}]}]}]}], ",", 
      RowBox[{
       SuperscriptBox["kt", "4"], "\[Rule]", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"k", "[", "3", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"k", "[", "2", "]"}], "2"], "+", 
          RowBox[{"2", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"kk", "[", "3", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}]}]}], ")"}], "2"]}]}], 
     "}"}]}], "//", "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GRadsns", "=", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"kk", "[", "i_", "]"}], ",", 
        RowBox[{"kk", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "+", 
       RowBox[{
        RowBox[{"k", "[", "i", "]"}], 
        RowBox[{"k", "[", "j", "]"}]}]}]}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", 
  RowBox[{
   RowBox[{"FreeQ", "[", 
    RowBox[{"#", ",", 
     RowBox[{"k", "[", "_", "]"}]}], "]"}], "&"}]}], "\[IndentingNewLine]", 
 RowBox[{"GRadsns1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"GRadsns", "/.", 
          RowBox[{
           RowBox[{"k", "[", "4", "]"}], "\[Rule]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"k", "[", "1", "]"}]}], "-", 
            RowBox[{"k", "[", "2", "]"}], "-", 
            RowBox[{"k", "[", "3", "]"}]}]}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "i_", "]"}], ",", 
             RowBox[{"kk", "[", "1", "]"}]}], "]"}], ":>", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i", "]"}], ",", 
               RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "i", "]"}], ",", 
              RowBox[{"kk", "[", "3", "]"}]}], "]"}], "-", 
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "i", "]"}], ",", 
              RowBox[{"kk", "[", "4", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"kk", "[", "i_", "]"}], ",", 
           RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "i_", "]"}], ",", 
          RowBox[{"kk", "[", "4", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], ",", 
            RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i", "]"}], ",", 
           RowBox[{"kk", "[", "3", "]"}]}], "]"}], "-", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i", "]"}], ",", 
           RowBox[{"kk", "[", "1", "]"}]}], "]"}]}]}]}], "/.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"kk", "[", "i_", "]"}], ",", 
         RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "//", 
     RowBox[{
      RowBox[{"Series", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{"1", ",", "2"}], "]"}], ",", "0", ",", "4"}], "}"}]}], 
       "]"}], "&"}]}], "//", "FullSimplify"}], "//", "Normal"}]}]}], "Input",
 CellChangeTimes->{{3.9115774507567644`*^9, 3.9115774555144377`*^9}, 
   3.9115775484487505`*^9, {3.911577582356073*^9, 3.9115776196889877`*^9}, {
   3.911577660641346*^9, 3.9115776745994773`*^9}, {3.9115777193680058`*^9, 
   3.9115778223662443`*^9}, {3.9115778682880764`*^9, 3.9115778758791294`*^9}, 
   3.911586787501359*^9, {3.911669154203426*^9, 3.9116692185880938`*^9}, 
   3.9116693799483657`*^9, 3.9120124476223545`*^9},
 CellLabel->
  "In[300]:=",ExpressionUUID->"94922da6-ab95-407b-99e4-72fc12c58ce5"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.9186608423243446`*^9, 3.9186610693606796`*^9, 
  3.937045937247654*^9, 3.9370466293550625`*^9},
 CellLabel->
  "Out[305]=",ExpressionUUID->"43e4e288-8178-498a-bc0d-05684c6aa8ff"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
    SuperscriptBox["z1", "2"], " ", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "2"}], "]"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], ",", 
       RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "3", "]"}], ",", 
       RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
   RowBox[{"8", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}]}]], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["z1", "2"], " ", 
   RowBox[{"sc", "[", 
    RowBox[{
     RowBox[{"e", "[", "1", "]"}], ",", 
     RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"sc", "[", 
    RowBox[{
     RowBox[{"e", "[", "3", "]"}], ",", 
     RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], ",", 
           RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], ",", 
           RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"kk", "[", "1", "]"}]}], "]"}]}]}], ")"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "4", "]"}], ",", 
        RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"2", ",", "3"}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "3", "]"}], ",", 
             RowBox[{"kk", "[", "1", "]"}]}], "]"}], "+", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "3", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], ")"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "4", "]"}], ",", 
           RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "4", "]"}], ",", 
           RowBox[{"kk", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
  "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "2"}], "]"}]}]], 
   RowBox[{
    SuperscriptBox["z1", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "2", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "3", "]"}], ",", 
          RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "1", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "2", "]"}], ",", 
             RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "1", "]"}], ",", 
             RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "2", "]"}], ",", 
             RowBox[{"kk", "[", "1", "]"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "4", "]"}], ",", 
          RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "1", "]"}], ",", 
          RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{"2", ",", "3"}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "3", "]"}], ",", 
             RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "3", "]"}], ",", 
               RowBox[{"kk", "[", "1", "]"}]}], "]"}], "+", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "3", "]"}], ",", 
               RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], ")"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "4", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "3", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "4", "]"}], ",", 
             RowBox[{"kk", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}], 
     "2"]}]}]}]], "Output",
 CellChangeTimes->{3.9186608423243446`*^9, 3.9186610693606796`*^9, 
  3.937045937247654*^9, 3.937046629615018*^9},
 CellLabel->
  "Out[306]=",ExpressionUUID->"51feeb5e-bbda-4234-bd18-3d47bf19ea3e"]
}, Open  ]],

Cell["This is the different", "Text",
 CellChangeTimes->{{3.918661293061322*^9, 
  3.918661296460439*^9}},ExpressionUUID->"e41fa7bb-102b-4ebc-b130-\
f50479eecc2d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GRansatz", "=", 
   RowBox[{"GRadsns1", "//", "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{3.924797946787051*^9},
 CellLabel->
  "In[307]:=",ExpressionUUID->"56f76050-af92-49c9-9d4c-9cbe2e11ffb9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"flatspacebootstrap", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"GRflat", "-", "GRansatz"}], "//", 
       RowBox[{
        RowBox[{"Series", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"S", "[", 
             RowBox[{"1", ",", "2"}], "]"}], ",", "0", ",", "4"}], "}"}]}], 
         "]"}], "&"}]}], "//", 
      RowBox[{
       FractionBox["#", 
        SuperscriptBox["z1", "2"]], "&"}]}], "//", "Expand"}], "//", 
    "Simplify"}], " ", "//", "Normal", 
   RowBox[{"(*", 
    RowBox[{"no", " ", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "2"}], "]"}], " ", "pole"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.911650373489131*^9, 3.9116504109277945`*^9}, {
   3.911650613269229*^9, 3.9116506378897963`*^9}, 3.911651734515397*^9, {
   3.911651852255528*^9, 3.911651862990164*^9}, {3.9116522434461036`*^9, 
   3.911652248448868*^9}, {3.9116527309171047`*^9, 3.9116527371666594`*^9}, {
   3.9116625784449687`*^9, 3.9116625826306844`*^9}, {3.9186609903465366`*^9, 
   3.9186609923367023`*^9}, 3.918661026662907*^9, {3.918661286072836*^9, 
   3.9186612870327215`*^9}, {3.9186614653984966`*^9, 3.9186614680473175`*^9}},
 CellLabel->
  "In[308]:=",ExpressionUUID->"19bc79c2-4107-40c6-b39a-e7191f697c40"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "2"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], ",", 
           RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}]]}], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], ",", 
           RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], ",", 
           RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}]}]}], ")"}], "2"]}], ")"}]}], 
  "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "1", "]"}], ",", 
         RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"kk", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "4", "]"}], ",", 
        RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "4", "]"}], ",", 
        RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"S", "[", 
           RowBox[{"2", ",", "3"}], "]"}]}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"kk", "[", "1", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "4", "]"}], ",", 
           RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"kk", "[", "2", "]"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "4", "]"}], ",", 
             RowBox[{"kk", "[", "2", "]"}]}], "]"}], "+", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"e", "[", "4", "]"}], ",", 
             RowBox[{"kk", "[", "3", "]"}]}], "]"}]}], ")"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.9186609565738544`*^9, 3.9186609931983023`*^9, 3.9186610274124537`*^9, 
   3.91866109484883*^9, {3.9186612805448685`*^9, 3.9186612874221497`*^9}, 
   3.9186614684599147`*^9, 3.9370459380385227`*^9, 3.9370466300318537`*^9},
 CellLabel->
  "Out[308]=",ExpressionUUID->"69e9245f-b060-4442-9ac2-94d5b7a17457"]
}, Open  ]],

Cell[TextData[{
 "So these are the terms that we miss from AdS bootstrap!  Now we use the \
uplift map from https://arxiv.org/pdf/2305.13894.pdf. e dot e -> e dot e, e \
dot k -> z e dot k  S[ij] ",
 Cell[BoxData[
  FormBox[
   RowBox[{"->", 
    SubscriptBox["D", 
     RowBox[{"ks", " ", "[", 
      RowBox[{"i", ",", "j"}], "]"}]]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "3cdba8aa-7360-4f22-8eb8-67f4e7e9f74e"]
}], "Text",
 CellChangeTimes->{{3.9116523246829815`*^9, 3.9116523687856817`*^9}, {
  3.911652471067356*^9, 3.9116524845172434`*^9}, {3.9116525237173815`*^9, 
  3.911652534719517*^9}, {3.9186613185397987`*^9, 3.9186613313327026`*^9}, {
  3.918661387741686*^9, 
  3.918661426554736*^9}},ExpressionUUID->"6b3fb50d-778f-4c43-8e08-\
a050d525e0de"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fsbtmid", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"flatspacebootstrap", "//", "Normal"}], "//", 
     RowBox[{"ReplaceAll", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"1", ",", "2"}], "]"}], "->", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["z1", "2"], 
             SuperscriptBox["ks", "2"]}], "+", 
            RowBox[{"4", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"s", "[", "1", "]"}], "+", 
               RowBox[{"s", "[", "2", "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"s", "[", "3", "]"}], "+", 
               RowBox[{"s", "[", "4", "]"}]}], ")"}]}]}], ")"}]}]}], ",", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"2", ",", "3"}], "]"}], "->", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["z1", "2"], 
             SuperscriptBox["kt", "2"]}], "+", 
            RowBox[{"4", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"s", "[", "2", "]"}], "+", 
               RowBox[{"s", "[", "3", "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"s", "[", "1", "]"}], "+", 
               RowBox[{"s", "[", "4", "]"}]}], ")"}]}]}], ")"}]}]}]}], "}"}], 
      "]"}]}], "//", 
    RowBox[{"ReplaceAll", "[", 
     RowBox[{"kk", "->", "k"}], "]"}]}], "//", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "y_", "]"}], ",", 
       RowBox[{"k", "[", "x_", "]"}]}], "]"}], "->", 
     RowBox[{"z1", " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "y", "]"}], ",", 
        RowBox[{"k", "[", "x", "]"}]}], "]"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9116527693123837`*^9, 3.911652874425299*^9}, {
   3.9116529350594854`*^9, 3.911652942109307*^9}, {3.911652980930319*^9, 
   3.91165298514404*^9}, {3.9116535651335244`*^9, 3.9116535716699643`*^9}, 
   3.911653991575923*^9, {3.9116623235436172`*^9, 3.911662348796767*^9}, 
   3.9116628292283506`*^9, {3.911663244420864*^9, 3.911663287802028*^9}, {
   3.911663398479411*^9, 3.91166339972493*^9}, {3.9116671052178116`*^9, 
   3.91166712227323*^9}, {3.911667302806919*^9, 3.911667312794348*^9}},
 CellLabel->
  "In[309]:=",ExpressionUUID->"e90e25a0-8360-4096-ab62-e16f9adcc1e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "16"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["ks", "2"], " ", 
      SuperscriptBox["z1", "2"]}], "+", 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"s", "[", "1", "]"}], "+", 
        RowBox[{"s", "[", "2", "]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"s", "[", "3", "]"}], "+", 
        RowBox[{"s", "[", "4", "]"}]}], ")"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], ",", 
           RowBox[{"e", "[", "2", "]"}]}], "]"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}], "2"]}], 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}]]}], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], ",", 
           RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "2", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "1", "]"}], ",", 
           RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}]}]}], ")"}], "2"]}], ")"}]}], 
  "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "3", "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["z1", "2"]}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"k", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["z1", "2"], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"k", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["z1", "2"], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"k", "[", "1", "]"}]}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["z1", "2"], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"k", "[", "1", "]"}]}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["z1", "2"], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["z1", "2"], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "4", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["z1", "2"], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "4", "]"}], ",", 
        RowBox[{"k", "[", "3", "]"}]}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["z1", "2"], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "4", "]"}], ",", 
        RowBox[{"k", "[", "3", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"e", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["kt", "2"], " ", 
            SuperscriptBox["z1", "2"]}], "+", 
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"s", "[", "2", "]"}], "+", 
              RowBox[{"s", "[", "3", "]"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"s", "[", "1", "]"}], "+", 
              RowBox[{"s", "[", "4", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"e", "[", "4", "]"}]}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["z1", "2"], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"k", "[", "1", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "4", "]"}], ",", 
           RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "+", 
        RowBox[{"z1", " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "3", "]"}], ",", 
           RowBox[{"k", "[", "2", "]"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"z1", " ", 
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "4", "]"}], ",", 
              RowBox[{"k", "[", "2", "]"}]}], "]"}]}], "+", 
           RowBox[{"z1", " ", 
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"e", "[", "4", "]"}], ",", 
              RowBox[{"k", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}]}]}],
     ")"}]}]}]], "Output",
 CellChangeTimes->{{3.9116623282493877`*^9, 3.9116623489748693`*^9}, 
   3.911662779568797*^9, 3.911662829500611*^9, 3.9116632965428905`*^9, 
   3.911663400688195*^9, 3.9116635395135*^9, {3.911667106042703*^9, 
   3.9116671243587074`*^9}, 3.911667313587368*^9, 3.9116683989223366`*^9, 
   3.918660997012521*^9, 3.9186610968371363`*^9, 3.918661435252658*^9, 
   3.918661469790652*^9, 3.937045938302691*^9, 3.9370466302808065`*^9},
 CellLabel->
  "Out[309]=",ExpressionUUID->"6a1fec9d-2279-402d-b813-1a10679f392e"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.911667343873125*^9, 3.911667346315448*^9}, {
  3.918661437961906*^9, 3.9186614401799264`*^9}},
 CellLabel->
  "In[310]:=",ExpressionUUID->"8fb522ae-2c9e-4657-92bd-bbf432c91931"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"CfGR1234", "[", 
    RowBox[{
    "z1", ",", "ks", ",", "kt", ",", "k1", ",", "k2", ",", "k3", ",", "k4", 
     ",", "e1", ",", "e2", ",", "e3", ",", "e4", ",", "s1", ",", "s2", ",", 
     "s3", ",", "s4"}], "]"}], 
   RowBox[{"fsbtmid", "/.", "rules"}]], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.918661441589284*^9, 3.918661452015338*^9}},
 CellLabel->
  "In[311]:=",ExpressionUUID->"78c6a8e3-e80b-402c-a93b-d5f4d2004f59"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.9116687396075835`*^9, 3.918661000393282*^9, 3.9186611099620757`*^9, {
   3.9186614443708477`*^9, 3.9186614714788694`*^9}, 3.937045938597202*^9, 
   3.937046630539793*^9},
 CellLabel->
  "Out[311]=",ExpressionUUID->"244c6817-9169-4771-8373-c92a7a9187d4"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440., 755.25},
WindowMargins->{{-6, Automatic}, {Automatic, -6}},
Magnification:>1.1 Inherited,
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (January 30, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d2b3a52a-1893-400f-afc3-7e2446ff7081"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 961, 24, 122, "Text",ExpressionUUID->"b5050e8a-fd6c-44ea-a96b-e2f17ca3d257"],
Cell[CellGroupData[{
Cell[1544, 48, 152, 3, 75, "Chapter",ExpressionUUID->"97445c6b-72cc-48c5-a445-c2cf0d32b3eb"],
Cell[CellGroupData[{
Cell[1721, 55, 160, 3, 74, "Section",ExpressionUUID->"a906ccef-1552-4cfe-9a9d-3efa42894461"],
Cell[CellGroupData[{
Cell[1906, 62, 226, 4, 59, "Subsection",ExpressionUUID->"97de1d61-e180-441d-b24b-f9645d460392"],
Cell[2135, 68, 788, 21, 84, "Input",ExpressionUUID->"d56b027e-61fa-4054-855e-3a14f69f41ee"],
Cell[2926, 91, 20297, 562, 84, "Input",ExpressionUUID->"a9fad708-6167-401c-81b9-229508b16d6f"]
}, Closed]],
Cell[CellGroupData[{
Cell[23260, 658, 168, 3, 41, "Subsection",ExpressionUUID->"21176869-6454-4a85-bea7-6f0e3f105682"],
Cell[23431, 663, 9085, 271, 316, "Input",ExpressionUUID->"06885706-73db-4920-926d-8dcea8a35a2b"],
Cell[CellGroupData[{
Cell[32541, 938, 5015, 146, 119, "Input",ExpressionUUID->"59d9080f-10c5-4936-98b5-19a70e83a964"],
Cell[37559, 1086, 1393, 28, 70, "Output",ExpressionUUID->"3eee92df-5976-496f-bf61-356f8bfb064e"]
}, Open  ]],
Cell[38967, 1117, 1061, 28, 53, "Input",ExpressionUUID->"22094ec7-2daa-48d7-ada7-dbadb9b6e6a9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40065, 1150, 154, 3, 59, "Subsection",ExpressionUUID->"cd228d68-5fba-4ae5-90c5-3fffe13138be"],
Cell[40222, 1155, 865, 27, 33, "Input",ExpressionUUID->"eefeba35-cbdb-448f-93a3-d3b9a7beab92"],
Cell[41090, 1184, 478, 12, 31, "Input",ExpressionUUID->"1bb4e359-503a-4074-a843-5ff6d88d5b8e"],
Cell[41571, 1198, 2076, 59, 77, "Input",ExpressionUUID->"2e3b7150-e506-48c5-9334-38fd679e8fc8"],
Cell[43650, 1259, 1456, 42, 56, "Input",ExpressionUUID->"5268b4f8-238b-4d16-80f5-f268b51ee359"],
Cell[45109, 1303, 1208, 35, 33, "Input",ExpressionUUID->"a0984a8a-5c1f-4d39-a0f9-b878067fc32f"],
Cell[46320, 1340, 1211, 35, 33, "Input",ExpressionUUID->"94abc4db-5814-4c84-835b-c33e73c99fca"],
Cell[47534, 1377, 600, 18, 62, "Input",ExpressionUUID->"0a33c5f3-2904-47a1-9884-1379b60feea8"],
Cell[48137, 1397, 2737, 83, 79, "Input",ExpressionUUID->"4683bdbb-e5cf-4794-9f7b-600467589e74"],
Cell[50877, 1482, 362, 8, 32, "Input",ExpressionUUID->"c1dd6960-69cc-4b01-aa8d-a1579db3e885"],
Cell[51242, 1492, 432, 11, 32, "Input",ExpressionUUID->"cc86c73a-9715-4888-94fc-58d1ae521637"],
Cell[51677, 1505, 604, 11, 31, "Input",ExpressionUUID->"1b65fbd0-08fb-4ea0-9264-e4ee3c9a94df"],
Cell[52284, 1518, 1474, 40, 67, "Input",ExpressionUUID->"3a7f943d-8ccb-4a5f-a970-ec59170423fc"],
Cell[53761, 1560, 492, 13, 32, "Input",ExpressionUUID->"db283b66-0777-452b-8867-ab52b558dcc6"],
Cell[54256, 1575, 1880, 58, 35, "Input",ExpressionUUID->"76aef263-1bdc-4324-bd2c-b6d2bdcbb86c"],
Cell[56139, 1635, 2153, 65, 56, "Input",ExpressionUUID->"12d70e86-db7a-4716-9c61-6772312bc4b9"],
Cell[58295, 1702, 2151, 65, 56, "Input",ExpressionUUID->"392cdcbb-d355-4374-9426-a368929c1784"],
Cell[60449, 1769, 2101, 64, 56, "Input",ExpressionUUID->"55a169ed-8f4e-4e86-bd2b-f7e0e385c584"],
Cell[62553, 1835, 399, 10, 50, "Input",ExpressionUUID->"12013d4d-973b-4f12-9c80-968cbbb7267e"],
Cell[62955, 1847, 1273, 36, 31, "Input",ExpressionUUID->"e0283e5e-9bc1-4f66-82a1-896d8e0bacfb"],
Cell[64231, 1885, 1696, 49, 74, "Input",ExpressionUUID->"1c2c305d-825b-4dd7-ad6c-6a3c6338b558"],
Cell[65930, 1936, 308, 6, 32, "Input",ExpressionUUID->"cc8930e0-20b5-40a9-9a6e-1f280e795486"],
Cell[66241, 1944, 2530, 72, 95, "Input",ExpressionUUID->"d5959d73-e22c-4a85-8025-84d19224d714"],
Cell[68774, 2018, 8748, 227, 220, "Input",ExpressionUUID->"f8375f6b-22aa-43ea-9b6a-ff033f7afcb2"],
Cell[77525, 2247, 423, 10, 32, "Input",ExpressionUUID->"3aee35f5-f483-4f4e-be90-759895047f0c"],
Cell[77951, 2259, 474, 11, 32, "Input",ExpressionUUID->"f7e77498-7e06-40d1-8507-7aaf8dd4e367"],
Cell[78428, 2272, 910, 25, 32, "Input",ExpressionUUID->"7a34bd8b-45e3-4557-937e-ff9ed1bd990a"],
Cell[79341, 2299, 944, 26, 32, "Input",ExpressionUUID->"5bb7c6c9-6834-4047-ac7b-2727a4c2a329"],
Cell[80288, 2327, 362, 8, 32, "Input",ExpressionUUID->"e67f1094-e3d7-4c7a-86fc-6b17d5094e7f"],
Cell[80653, 2337, 1404, 38, 31, "Input",ExpressionUUID->"be80e31c-af80-40b1-9c3b-5cb2fdbb497d"],
Cell[82060, 2377, 870, 23, 53, "Input",ExpressionUUID->"005ae8a7-d56b-48b3-8e4f-acb3dbf26526"],
Cell[82933, 2402, 1562, 36, 95, "Input",ExpressionUUID->"b4c2ae9e-7336-45eb-88b4-1ea3628ad366"],
Cell[84498, 2440, 890, 27, 50, "Input",ExpressionUUID->"0d7ace40-069e-46f6-ae8b-3302885f5d9a"],
Cell[85391, 2469, 649, 19, 62, "Input",ExpressionUUID->"1a684c9f-5249-43c2-b511-1d3c967e76eb"],
Cell[86043, 2490, 771, 19, 32, "Input",ExpressionUUID->"03348e9f-f810-4afd-b20d-3878f32fd180"],
Cell[86817, 2511, 1184, 37, 92, "Input",ExpressionUUID->"dbaf73f3-37d9-4b93-917a-39edbb244d48"],
Cell[88004, 2550, 786, 24, 50, "Input",ExpressionUUID->"2e230abd-4fb5-447b-8fcf-cfe4a3d133d8"],
Cell[88793, 2576, 839, 25, 50, "Input",ExpressionUUID->"6d3e7e72-4598-49e3-9ca9-a894c4e6a710"],
Cell[89635, 2603, 704, 21, 31, "Input",ExpressionUUID->"7bee7357-afe7-4c28-921e-399375b400d5"],
Cell[90342, 2626, 1838, 50, 75, "Input",ExpressionUUID->"5c928e27-faa0-477e-a4dd-51e1029148d7"],
Cell[92183, 2678, 529, 12, 32, "Input",ExpressionUUID->"3569a8c7-dd60-4c54-a933-7b0e9daf0954"],
Cell[92715, 2692, 402, 10, 32, "Input",ExpressionUUID->"bed9cba4-36c4-473c-9265-475c3d411f4b"],
Cell[93120, 2704, 1328, 40, 94, "Input",ExpressionUUID->"99cc1e9e-4f6e-4888-bd54-d27f0545f429"],
Cell[94451, 2746, 8397, 220, 423, "Input",ExpressionUUID->"174eaa37-8ea4-4226-b586-96199a3d0142"],
Cell[102851, 2968, 1996, 51, 119, "Input",ExpressionUUID->"dcb4326b-093d-4cb0-82c0-8103badbe3b7"],
Cell[104850, 3021, 1998, 51, 98, "Input",ExpressionUUID->"3888dbcf-88fa-4287-acf3-1956400c0e10"],
Cell[106851, 3074, 3505, 92, 165, "Input",ExpressionUUID->"356d99cb-dd25-429b-a3e0-24771df96802"],
Cell[110359, 3168, 395, 9, 32, "Input",ExpressionUUID->"f0ff4b37-b95c-433f-a2f7-168eea781df7"],
Cell[110757, 3179, 298, 5, 31, "Input",ExpressionUUID->"b4a3cee6-278b-43a5-b158-ea63eaea130f"],
Cell[111058, 3186, 1474, 40, 67, "Input",ExpressionUUID->"987a17fd-d0a1-4b16-bd57-f3dd49f0b19d"],
Cell[112535, 3228, 8055, 209, 265, "Input",ExpressionUUID->"aaf36d17-0803-4321-a484-dbe24af20ee1"],
Cell[120593, 3439, 2578, 76, 75, "Input",ExpressionUUID->"d01a7e0b-62c5-49cd-aa70-4c3d1242a23b"],
Cell[123174, 3517, 474, 12, 33, "Input",ExpressionUUID->"d9cb0b52-d671-425f-95e0-db4601242b1f"],
Cell[123651, 3531, 386, 8, 32, "Input",ExpressionUUID->"75cd3692-ac5a-4a47-904b-888612af053f"],
Cell[124040, 3541, 386, 8, 32, "Input",ExpressionUUID->"17925d64-04e1-46c3-b828-dbac3d911e1b"],
Cell[124429, 3551, 1284, 37, 53, "Input",ExpressionUUID->"6616b93b-5be7-4329-bee0-b208a91cb8c6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125750, 3593, 155, 3, 59, "Subsection",ExpressionUUID->"66803432-d5f4-406f-8f5c-6293015146c6"],
Cell[125908, 3598, 474, 12, 33, "Input",ExpressionUUID->"386eb2fb-f04e-40dd-bae5-cb47aaf1e2e1"],
Cell[126385, 3612, 451, 12, 32, "Input",ExpressionUUID->"986de2a1-d843-46f9-b28a-fb8202b3d66b"],
Cell[126839, 3626, 1229, 35, 31, "Input",ExpressionUUID->"43567a5b-581c-4149-a311-f9e898030772"],
Cell[128071, 3663, 1236, 36, 31, "Input",ExpressionUUID->"1b0f0ffc-8579-43fd-abf1-2e3dce0212d1"],
Cell[129310, 3701, 1818, 55, 136, "Input",ExpressionUUID->"874f7637-7705-4e42-9237-bda0a0ee4e07"],
Cell[131131, 3758, 1894, 56, 136, "Input",ExpressionUUID->"03d11e48-3dd1-44cd-b351-38abfd668194"],
Cell[133028, 3816, 950, 27, 32, "Input",ExpressionUUID->"f2e7ca50-6dcd-4571-85b1-efa1e64e1368"],
Cell[133981, 3845, 877, 25, 53, "Input",ExpressionUUID->"10cd15dc-68f5-41a4-8cde-9453b51d663a"],
Cell[134861, 3872, 376, 9, 32, "Input",ExpressionUUID->"541bc0a5-1642-438d-8ba5-f8d64283d490"],
Cell[135240, 3883, 2315, 69, 57, "Input",ExpressionUUID->"2dac28cd-5471-42b3-be06-b87d479f6f80"],
Cell[137558, 3954, 377, 9, 32, "Input",ExpressionUUID->"8313ad5d-13c3-4109-a3f6-614ada7f5e99"],
Cell[137938, 3965, 763, 23, 50, "Input",ExpressionUUID->"67a9fc6d-c6c6-45d6-a379-047e405dad89"],
Cell[138704, 3990, 283, 7, 31, "Input",ExpressionUUID->"0ee54db0-1d01-498f-99a6-8afda6191eaf"],
Cell[138990, 3999, 2818, 80, 95, "Input",ExpressionUUID->"be67686e-137a-42f0-8647-a8453eb73158"],
Cell[141811, 4081, 8059, 210, 265, "Input",ExpressionUUID->"08673aeb-2d6f-4f6e-8581-0985029faa11"],
Cell[149873, 4293, 8010, 209, 265, "Input",ExpressionUUID->"80603a22-2679-4a83-8c9c-b37df8aa8ea8"],
Cell[157886, 4504, 215, 6, 31, "Input",ExpressionUUID->"aaab3ead-e680-4224-970b-a32d1ca4fe82"],
Cell[158104, 4512, 2582, 77, 75, "Input",ExpressionUUID->"ebc1d902-86f9-4757-9ea3-cab74ad659d6"],
Cell[160689, 4591, 2471, 72, 75, "Input",ExpressionUUID->"49f5f7e0-311a-42e5-8cc6-1bdb45582c83"],
Cell[163163, 4665, 818, 24, 32, "Input",ExpressionUUID->"3533d67b-b6fb-48ba-8cd5-4860839d2458"],
Cell[163984, 4691, 820, 24, 32, "Input",ExpressionUUID->"91e01b21-6996-494b-9525-6ada2dcfe28c"],
Cell[164807, 4717, 622, 17, 32, "Input",ExpressionUUID->"83bad50f-82e5-42d8-bf70-0b625cc06b98"],
Cell[165432, 4736, 1411, 43, 53, "Input",ExpressionUUID->"2a1ed18c-0fe7-443a-8de9-7e224ebe4f6e"],
Cell[166846, 4781, 1584, 49, 53, "Input",ExpressionUUID->"f99535f8-ab98-48e8-afa4-b2057abed69b"],
Cell[168433, 4832, 5731, 161, 117, "Input",ExpressionUUID->"a9f0d278-1cba-47fb-99cf-1256d6089916"],
Cell[174167, 4995, 2887, 87, 95, "Input",ExpressionUUID->"5b0c18e8-56a3-4c74-a417-8b6ee24451fc"],
Cell[177057, 5084, 3450, 102, 95, "Input",ExpressionUUID->"a890d8c4-47f3-437e-a2f9-73b806c7bc14"],
Cell[180510, 5188, 570, 12, 31, "Input",ExpressionUUID->"aa677759-1f6a-4267-8218-3a5950a0d390"],
Cell[181083, 5202, 2078, 55, 112, "Input",ExpressionUUID->"643e42dd-adaf-42e0-91c2-b6dd881b609d"],
Cell[183164, 5259, 1202, 34, 32, "Input",ExpressionUUID->"7537b0b4-63f0-4e09-bb5d-624ec09bff43"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[184427, 5300, 240, 4, 75, "Chapter",ExpressionUUID->"5fc2cf29-d61d-48ea-886c-5fb28c50726a"],
Cell[CellGroupData[{
Cell[184692, 5308, 231, 4, 74, "Section",ExpressionUUID->"9b778c78-bddc-4baf-9686-cfbd496b81d0"],
Cell[CellGroupData[{
Cell[184948, 5316, 304, 5, 59, "Subsection",ExpressionUUID->"c323172c-751f-4211-b313-fa246b59de14"],
Cell[185255, 5323, 22273, 623, 661, "Input",ExpressionUUID->"ea051dfb-6554-4dcb-bdba-77b4c2f061ed"],
Cell[207531, 5948, 1161, 28, 32, "Input",ExpressionUUID->"367c42a5-9913-4da0-9aaf-9986cf3cb1d1"],
Cell[208695, 5978, 1224, 38, 54, "Input",ExpressionUUID->"d90a8a2e-e625-4d8d-90e8-de828afed981"],
Cell[209922, 6018, 1269, 39, 54, "Input",ExpressionUUID->"d9c80d94-bc46-41f7-8fb1-add719169342"],
Cell[211194, 6059, 1089, 32, 52, "Input",ExpressionUUID->"3467e71a-2233-42f5-b918-2ae16abaa42b"],
Cell[212286, 6093, 3024, 93, 109, "Input",ExpressionUUID->"d1674dd9-c893-4190-bec7-ce70df0cd162"],
Cell[215313, 6188, 3290, 97, 140, "Input",ExpressionUUID->"ae79d660-b0fb-4e18-8b42-c72c64076d2a"],
Cell[218606, 6287, 204, 4, 31, "Input",ExpressionUUID->"c2dacb5d-d2d0-48d9-89d1-ecf9d42d22f1"],
Cell[218813, 6293, 3282, 80, 116, "Input",ExpressionUUID->"e30c0791-e30d-48ed-af4e-3c95ac39586c"],
Cell[222098, 6375, 2159, 65, 79, "Input",ExpressionUUID->"29c0bcc0-75e7-4cab-b9bc-eaada185805f"],
Cell[224260, 6442, 6528, 179, 231, "Input",ExpressionUUID->"ad527d6f-3a15-41ba-9ef5-e66771caac77"],
Cell[230791, 6623, 1774, 44, 74, "Input",ExpressionUUID->"347b983d-bbb5-43e4-989f-7243612a5edd"],
Cell[232568, 6669, 2817, 65, 157, "Input",ExpressionUUID->"2df9e077-4255-48e8-98ac-9b1192bd9c5e"],
Cell[235388, 6736, 2763, 64, 136, "Input",ExpressionUUID->"b1ab71a1-ef94-4d1d-8cc0-eb0a0b79aee6"]
}, Closed]],
Cell[CellGroupData[{
Cell[238188, 6805, 218, 4, 41, "Subsection",ExpressionUUID->"94532124-0e07-4c09-a3b1-1e9e23003e69"],
Cell[238409, 6811, 5456, 154, 175, "Input",ExpressionUUID->"fa6db0d0-950b-4852-9152-851f826641bc"],
Cell[243868, 6967, 2765, 64, 136, "Input",ExpressionUUID->"d5c6937b-914f-4851-a597-4b57046e127d"],
Cell[246636, 7033, 2670, 61, 159, "Input",ExpressionUUID->"7a28d688-4fba-47c9-abaa-41e2aa5388fd"],
Cell[249309, 7096, 2736, 63, 136, "Input",ExpressionUUID->"9fb88810-07fc-49cb-9b70-0b2435066d37"]
}, Open  ]],
Cell[CellGroupData[{
Cell[252082, 7164, 164, 3, 59, "Subsection",ExpressionUUID->"25459253-5f6d-42e6-b794-cf140a5906c6"],
Cell[252249, 7169, 1367, 36, 78, "Input",ExpressionUUID->"d5934a69-3f4e-495d-8639-2813cbd3a1a2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[253665, 7211, 351, 5, 74, "Section",ExpressionUUID->"26306dd9-295b-43fc-a116-93262a145f3d"],
Cell[CellGroupData[{
Cell[254041, 7220, 161, 3, 59, "Subsection",ExpressionUUID->"aa0852ed-450e-40c8-861a-053b52705963"],
Cell[254205, 7225, 6292, 156, 190, "Input",ExpressionUUID->"5bc00976-b487-4316-a59d-1afcc4b66989"],
Cell[CellGroupData[{
Cell[260522, 7385, 765, 21, 54, "Input",ExpressionUUID->"ed43715a-c2f9-40d6-9b2b-675700a4f973"],
Cell[261290, 7408, 769, 12, 35, "Output",ExpressionUUID->"de572df4-a3e3-440e-ac33-c7fe52aa155e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[262096, 7425, 714, 20, 54, "Input",ExpressionUUID->"ae1554fd-4016-4736-8c27-d2c120f68453"],
Cell[262813, 7447, 767, 12, 35, "Output",ExpressionUUID->"7c4a711d-7fde-4b24-8af4-a0c18b8da3d4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[263617, 7464, 714, 20, 54, "Input",ExpressionUUID->"01cb70be-90a8-4b78-858c-bd60c188860d"],
Cell[264334, 7486, 759, 12, 35, "Output",ExpressionUUID->"eebc4503-b9eb-440a-ac78-663cdb164c82"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[265142, 7504, 243, 4, 59, "Subsection",ExpressionUUID->"5621e959-9a3d-4724-80e7-b4381411cc11"],
Cell[CellGroupData[{
Cell[265410, 7512, 188, 3, 49, "Subsubsection",ExpressionUUID->"df9038d9-3a81-4880-9f17-33bd9501ccc7"],
Cell[265601, 7517, 3563, 109, 101, "Input",ExpressionUUID->"889e2fff-26e6-4e44-876f-1397a30feffd"],
Cell[269167, 7628, 693, 21, 32, "Input",ExpressionUUID->"0f2d89c4-855e-4640-9e84-a6119913e11d"],
Cell[269863, 7651, 2210, 66, 54, "Input",ExpressionUUID->"006efc30-f54b-42e9-b06d-c5afbde62dbb"],
Cell[272076, 7719, 2114, 65, 54, "Input",ExpressionUUID->"a6c4cf75-2fa9-443d-8461-c4716c11f046"],
Cell[274193, 7786, 1372, 43, 32, "Input",ExpressionUUID->"427a89c1-3736-4774-9a22-72215012ca42"],
Cell[275568, 7831, 2173, 69, 59, "Input",ExpressionUUID->"43c40cda-64fb-4bc2-948c-14cf80b75e7c"],
Cell[277744, 7902, 2299, 59, 95, "Input",ExpressionUUID->"36774e27-0a16-4710-b099-21e84f72d391"],
Cell[CellGroupData[{
Cell[280068, 7965, 912, 23, 54, "Input",ExpressionUUID->"08c20647-5033-41e5-be7f-1ebcf6366efd"],
Cell[280983, 7990, 1101, 17, 70, "Output",ExpressionUUID->"0c72da03-6728-479b-8084-6be42482f630"]
}, Open  ]],
Cell[CellGroupData[{
Cell[282121, 8012, 899, 24, 54, "Input",ExpressionUUID->"c8723c9f-9a9a-43f5-b8eb-a92eeea3d5f1"],
Cell[283023, 8038, 904, 14, 70, "Output",ExpressionUUID->"58a5ded2-8a57-40b5-94a0-a7db93666fc8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[283964, 8057, 819, 23, 54, "Input",ExpressionUUID->"50b95f8e-ebb4-4e8d-b359-150f5fe30c51"],
Cell[284786, 8082, 785, 12, 70, "Output",ExpressionUUID->"45a99165-6a12-4c8b-b680-612effa9877b"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[285632, 8101, 197, 3, 41, "Subsection",ExpressionUUID->"b4272ebe-f913-479f-9b91-e29d58ac630d"],
Cell[CellGroupData[{
Cell[285854, 8108, 227, 4, 49, "Subsubsection",ExpressionUUID->"30a96259-39b9-42bf-9b64-94a356812c6a"],
Cell[286084, 8114, 1690, 51, 72, "Input",ExpressionUUID->"572b2102-6dc2-4fd0-b0de-020b84ab2db9"],
Cell[CellGroupData[{
Cell[287799, 8169, 4068, 113, 95, "Input",ExpressionUUID->"8e568803-baec-40a4-b470-35fe89b19c3d"],
Cell[291870, 8284, 7443, 199, 70, "Output",ExpressionUUID->"c49e9778-a2cd-4655-9c2f-662c16c8aa59"]
}, Open  ]],
Cell[CellGroupData[{
Cell[299350, 8488, 1796, 53, 73, "Input",ExpressionUUID->"d067a825-8fa3-404f-8b07-ba277e4debd4"],
Cell[301149, 8543, 1738, 39, 70, "Output",ExpressionUUID->"6bdc2a1f-bada-4e7e-a380-e2bdf8793de0"]
}, Open  ]],
Cell[302902, 8585, 432, 9, 31, "Input",ExpressionUUID->"f272db37-ffc8-4ae7-8d91-15645f399894"],
Cell[303337, 8596, 1139, 32, 52, "Input",ExpressionUUID->"b770f8bb-be9b-4d7f-8ff4-068316355687"],
Cell[CellGroupData[{
Cell[304501, 8632, 2765, 82, 95, "Input",ExpressionUUID->"9ac1d8f6-9a1d-4141-a237-165361dd3495"],
Cell[307269, 8716, 2152, 48, 70, "Output",ExpressionUUID->"aa296e58-c0b4-413e-9a26-07da873b28f6"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[309470, 8770, 189, 3, 39, "Subsubsection",ExpressionUUID->"41532947-f011-4591-99b8-bfbeb4d355da"],
Cell[309662, 8775, 3551, 99, 123, "Input",ExpressionUUID->"b4d2b61e-7ec1-4efc-aa44-70d1d4946dab"],
Cell[CellGroupData[{
Cell[313238, 8878, 2519, 72, 96, "Input",ExpressionUUID->"36c02589-048c-4c35-b8b4-51eeca45e812"],
Cell[315760, 8952, 1323, 20, 35, "Output",ExpressionUUID->"1a752abb-340c-4afc-ae06-6c29224fab93"]
}, Open  ]],
Cell[317098, 8975, 3634, 101, 123, "Input",ExpressionUUID->"8f6ee723-2490-4602-ad41-e72c57cf8fe0"],
Cell[CellGroupData[{
Cell[320757, 9080, 2572, 73, 96, "Input",ExpressionUUID->"416519a5-8d74-4097-9894-63cb9d9e3f9f"],
Cell[323332, 9155, 1370, 20, 35, "Output",ExpressionUUID->"1942cd99-34f2-45fe-a041-f4c1db607271"]
}, Open  ]],
Cell[CellGroupData[{
Cell[324739, 9180, 116, 2, 31, "Input",ExpressionUUID->"6554fce0-fa29-44e3-970d-96379b8bdfc6"],
Cell[324858, 9184, 7356, 204, 141, "Output",ExpressionUUID->"0ae4ee2f-f186-4233-9715-d10f50463ba7"]
}, Open  ]],
Cell[332229, 9391, 3688, 102, 123, "Input",ExpressionUUID->"f7ca82e7-8ba5-47a7-9912-e4297b85cba9"],
Cell[CellGroupData[{
Cell[335942, 9497, 2620, 73, 96, "Input",ExpressionUUID->"bb5ab67c-9615-4e83-8279-7dce72e76cac"],
Cell[338565, 9572, 1396, 21, 35, "Output",ExpressionUUID->"ffd0d14e-257c-4666-94ad-c9f8a189135e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[340010, 9599, 169, 3, 49, "Subsubsection",ExpressionUUID->"3c7e8b89-60c8-4fce-854c-0b5157284191"],
Cell[340182, 9604, 13949, 356, 488, "Input",ExpressionUUID->"7ec5cf68-0003-48b9-ab88-7be0d4d3adac"],
Cell[CellGroupData[{
Cell[354156, 9964, 779, 20, 54, "Input",ExpressionUUID->"56db4f17-2f1e-4386-9912-86b21b0ef36f"],
Cell[354938, 9986, 13164, 380, 284, "Output",ExpressionUUID->"b35147f7-9939-4604-a7d2-50ca7ba3c4a0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[368139, 10371, 641, 19, 52, "Input",ExpressionUUID->"31e7d66d-996e-49db-9044-d3092df7d214"],
Cell[368783, 10392, 821, 12, 35, "Output",ExpressionUUID->"e75ef97a-4ac7-4a97-92b4-f300df370f78"]
}, Open  ]],
Cell[CellGroupData[{
Cell[369641, 10409, 773, 20, 54, "Input",ExpressionUUID->"b5950cbf-74fb-48d3-9d4a-2cdc0cfe4c18"],
Cell[370417, 10431, 7415, 205, 141, "Output",ExpressionUUID->"37b93d5a-fce6-45c6-b74a-df70103cac5a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[377869, 10641, 743, 21, 52, "Input",ExpressionUUID->"09068415-89f9-4493-aed9-2b595a680917"],
Cell[378615, 10664, 981, 15, 35, "Output",ExpressionUUID->"05d1d647-3377-43e2-a64b-f9de67639c62"]
}, Open  ]],
Cell[CellGroupData[{
Cell[379633, 10684, 724, 19, 54, "Input",ExpressionUUID->"e0741015-62ce-40be-bdb9-f4ae4eceef73"],
Cell[380360, 10705, 11685, 334, 242, "Output",ExpressionUUID->"27bf8ef4-0020-42fc-abdf-6dfe63419d5a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[392082, 11044, 1185, 33, 52, "Input",ExpressionUUID->"b31b469f-4422-468e-88b6-f587524bf32b"],
Cell[393270, 11079, 982, 15, 35, "Output",ExpressionUUID->"2fded9c3-4158-411c-bf8f-ea88d82d1213"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[394325, 11102, 168, 3, 74, "Section",ExpressionUUID->"f0f3d7a9-7234-4421-af0d-507824c6f8bf"],
Cell[CellGroupData[{
Cell[394518, 11109, 219, 4, 59, "Subsection",ExpressionUUID->"28376988-bc3e-41fc-a586-ebf7840e5219"],
Cell[394740, 11115, 12701, 379, 302, "Input",ExpressionUUID->"14252b37-952b-4df7-a2bd-ef8458bfc8c0"],
Cell[407444, 11496, 164, 3, 38, "Text",ExpressionUUID->"b7777d6d-2514-4c64-9482-f0412a8622f9"],
Cell[CellGroupData[{
Cell[407633, 11503, 543, 16, 31, "Input",ExpressionUUID->"bb9ca49a-ee87-4717-b671-a121682e6ea9"],
Cell[408179, 11521, 282, 5, 35, "Output",ExpressionUUID->"aed8fcd7-cd7d-4f32-a091-cf58312417f7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[408510, 11532, 214, 4, 59, "Subsection",ExpressionUUID->"1abb531b-5dab-4b68-b7b1-6d68d5f62535"],
Cell[CellGroupData[{
Cell[408749, 11540, 445, 13, 49, "Subsubsection",ExpressionUUID->"8cb05b2c-c5ed-49be-81af-133f7137fa68"],
Cell[409197, 11555, 295, 7, 36, "Text",ExpressionUUID->"d9506f47-2a2f-45f1-a147-4f2c18c2a5c3"],
Cell[CellGroupData[{
Cell[409517, 11566, 1835, 50, 52, "Input",ExpressionUUID->"27cf859e-e413-4005-b955-bd8e5121a844"],
Cell[411355, 11618, 1761, 52, 62, "Output",ExpressionUUID->"d37ad9c8-35d4-4fa8-afa0-2a7372c690a4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[413153, 11675, 5058, 133, 163, "Input",ExpressionUUID->"8be01935-be53-4f07-aafb-ddb299ec200d"],
Cell[418214, 11810, 2310, 59, 60, "Output",ExpressionUUID->"216fede7-bd61-435b-823e-1358770bdb93"],
Cell[420527, 11871, 2251, 57, 61, "Output",ExpressionUUID->"26fbec72-af28-49d4-90e4-8aee50e58fee"]
}, Open  ]],
Cell[422793, 11931, 146, 3, 38, "Text",ExpressionUUID->"1f4d14e1-a9f0-49a9-8904-bb83ca227929"],
Cell[CellGroupData[{
Cell[422964, 11938, 389, 9, 31, "Input",ExpressionUUID->"e6dd20d5-3760-49b5-86f6-93f2efe336b4"],
Cell[423356, 11949, 1445, 45, 61, "Output",ExpressionUUID->"e4a912ff-8bef-4740-9c77-3a7a5c6bd106"]
}, Open  ]],
Cell[CellGroupData[{
Cell[424838, 11999, 449, 10, 53, "Input",ExpressionUUID->"22a34f2c-5f0e-4bb2-a9ce-b79069e1fddd"],
Cell[425290, 12011, 242, 5, 35, "Output",ExpressionUUID->"efc13619-91cb-4be2-abd8-d7345af6f478"]
}, Open  ]],
Cell[425547, 12019, 293, 7, 63, "Text",ExpressionUUID->"e88d2647-94a2-48eb-9522-443e627b01b9"],
Cell[CellGroupData[{
Cell[425865, 12030, 4147, 105, 138, "Input",ExpressionUUID->"34693741-b222-4d40-9744-f15228479f17"],
Cell[430015, 12137, 448, 7, 35, "Output",ExpressionUUID->"191a2ae9-4a3e-4951-bd0c-68721682887f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[430512, 12150, 275, 4, 49, "Subsubsection",ExpressionUUID->"ae19a3ec-f69f-4bff-83d3-13ece32abf81"],
Cell[430790, 12156, 253, 6, 38, "Text",ExpressionUUID->"c41ff6f7-f79f-4229-aeba-8ca4703d6c1c"],
Cell[CellGroupData[{
Cell[431068, 12166, 1746, 48, 76, "Input",ExpressionUUID->"19721de3-c5bf-4cd1-aa2b-aa60d71c10dc"],
Cell[432817, 12216, 11143, 312, 251, "Output",ExpressionUUID->"f2b61348-5392-4772-a615-0f424bbdec1f"]
}, Open  ]],
Cell[443975, 12531, 4156, 128, 229, "Input",ExpressionUUID->"b2728954-7393-47d8-aa47-42fe721010e2"],
Cell[448134, 12661, 620, 18, 31, "Input",ExpressionUUID->"3dac3144-de4c-4b54-81e7-e28a2efc5f9e"],
Cell[448757, 12681, 194, 3, 38, "Text",ExpressionUUID->"fe36103d-2086-4665-b7f1-e3312aab1bd2"],
Cell[448954, 12686, 3538, 90, 153, "Input",ExpressionUUID->"939e4814-3455-4802-a86d-46b3adcc1f2c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[452529, 12781, 369, 10, 48, "Subsubsection",ExpressionUUID->"add14767-a264-4fcb-a675-df7d05733644"],
Cell[CellGroupData[{
Cell[452923, 12795, 346, 8, 31, "Input",ExpressionUUID->"f4df4ab3-de9c-4bd6-8bef-792efc99aeb8"],
Cell[453272, 12805, 5700, 173, 144, "Output",ExpressionUUID->"4c7be414-3617-4a92-aa2f-f355236c8d72"]
}, Open  ]],
Cell[CellGroupData[{
Cell[459009, 12983, 1943, 50, 96, "Input",ExpressionUUID->"f73579fb-6fc2-4d07-8233-021bf378ec3e"],
Cell[460955, 13035, 5386, 160, 138, "Output",ExpressionUUID->"12678851-4c38-45af-a2aa-e76a9147dc3e"]
}, Open  ]],
Cell[466356, 13198, 159, 3, 38, "Text",ExpressionUUID->"b820e37b-efc1-4881-b65b-90de1f4e037a"],
Cell[CellGroupData[{
Cell[466540, 13205, 972, 25, 75, "Input",ExpressionUUID->"0c4ad358-43f0-4999-ac81-1ba29a44bc54"],
Cell[467515, 13232, 5533, 162, 118, "Output",ExpressionUUID->"a0b0870b-630b-4eec-98f0-dbe6ae53be9f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[473085, 13399, 263, 6, 57, "Input",ExpressionUUID->"0414722c-2d9e-4743-933a-bac7c772b1eb"],
Cell[473351, 13407, 244, 5, 35, "Output",ExpressionUUID->"c1511f83-88cd-431f-ac20-de6b83f87226"]
}, Open  ]],
Cell[473610, 13415, 99, 1, 4, "PageBreak",ExpressionUUID->"adf30a76-dbad-4bc0-878c-b134bf7e60e7",
 PageBreakBelow->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[473746, 13421, 515, 16, 50, "Subsubsection",ExpressionUUID->"843eebd5-f533-41e7-872d-35139251b983"],
Cell[CellGroupData[{
Cell[474286, 13441, 126, 2, 31, "Input",ExpressionUUID->"e6c7c82f-9240-4dbf-b41b-8a0221b8a71b"],
Cell[474415, 13445, 3928, 121, 163, "Output",ExpressionUUID->"12c3d6f3-41c5-4a3e-85b5-63bba9871a76"]
}, Open  ]],
Cell[478358, 13569, 218, 4, 38, "Text",ExpressionUUID->"8db57141-048c-45d0-9fea-01f3a85955dd"],
Cell[478579, 13575, 1900, 56, 35, "Input",ExpressionUUID->"8b456eee-6fa8-4a11-8415-967feb62f299"],
Cell[480482, 13633, 1676, 50, 61, "Input",ExpressionUUID->"f72814a2-2b92-41ac-9b44-e325fd624065"],
Cell[482161, 13685, 1680, 50, 61, "Input",ExpressionUUID->"444ace77-c361-427d-ad50-3bbf5964ccb5"],
Cell[483844, 13737, 2123, 63, 61, "Input",ExpressionUUID->"718716b9-d708-44c1-affc-05cac766469a"],
Cell[CellGroupData[{
Cell[485992, 13804, 302, 7, 31, "Input",ExpressionUUID->"4af3a7f8-c42d-4d07-8ea1-cf44ae5b05b5"],
Cell[486297, 13813, 202, 4, 35, "Output",ExpressionUUID->"93bfbc46-6fdc-4ae3-b554-3c0ee0bd235f"]
}, Open  ]],
Cell[486514, 13820, 534, 16, 40, "Text",ExpressionUUID->"674a3336-97f8-4311-ab12-1e10c54abd2f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[487085, 13841, 371, 10, 50, "Subsubsection",ExpressionUUID->"cce52937-943c-445d-97dc-326633e0df9c"],
Cell[CellGroupData[{
Cell[487481, 13855, 2320, 64, 104, "Input",ExpressionUUID->"c6945eeb-f7ea-41ad-8a2c-199d15799a86"],
Cell[489804, 13921, 622, 16, 52, "Output",ExpressionUUID->"29767d98-b6f1-40e2-9a42-df9a0b4591f2"]
}, Open  ]],
Cell[490441, 13940, 187, 3, 38, "Text",ExpressionUUID->"dd5c3575-3f55-4fc7-aaa2-fe8ac6c8820d"],
Cell[CellGroupData[{
Cell[490653, 13947, 1315, 37, 58, "Input",ExpressionUUID->"a3613f1a-c6f7-4ec1-9ecc-e8b3321a0940"],
Cell[491971, 13986, 624, 18, 53, "Output",ExpressionUUID->"9cf74198-c705-4923-a6c3-d2031bb6212d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[492632, 14009, 265, 6, 57, "Input",ExpressionUUID->"53beb852-c2b9-4908-826a-f4594334eddb"],
Cell[492900, 14017, 248, 5, 35, "Output",ExpressionUUID->"89ff272c-5eec-4f6d-b8cb-188319649b37"]
}, Open  ]],
Cell[493163, 14025, 263, 6, 38, "Text",ExpressionUUID->"cfb1e751-85e4-4def-bc3c-22db5777bb35"]
}, Open  ]],
Cell[CellGroupData[{
Cell[493463, 14036, 366, 10, 48, "Subsubsection",ExpressionUUID->"db1d747e-764c-4477-bfce-8b73d1d259ac"],
Cell[CellGroupData[{
Cell[493854, 14050, 3056, 85, 77, "Input",ExpressionUUID->"6fc412e8-df2b-40a6-b75d-89845cb8e2f0"],
Cell[496913, 14137, 1842, 52, 60, "Output",ExpressionUUID->"442a292b-152f-4815-b7b9-9bb588a9ab89"]
}, Open  ]],
Cell[CellGroupData[{
Cell[498792, 14194, 2791, 81, 77, "Input",ExpressionUUID->"7659042d-c462-4b31-92af-d0aa0d326b64"],
Cell[501586, 14277, 1570, 49, 60, "Output",ExpressionUUID->"18a6463b-ea54-498f-ae35-0faba92850e8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[503193, 14331, 1565, 50, 35, "Input",ExpressionUUID->"0f6c0b8d-a007-421c-9cbf-1ab40225be25"],
Cell[504761, 14383, 1466, 47, 60, "Output",ExpressionUUID->"1247bbfc-cd92-40a7-a89b-d9e710c3b989"]
}, Open  ]],
Cell[CellGroupData[{
Cell[506264, 14435, 4523, 125, 119, "Input",ExpressionUUID->"88e4dd04-1369-4fc5-971b-eafbe4cc7a44"],
Cell[510790, 14562, 2009, 62, 60, "Output",ExpressionUUID->"16190d92-2209-4882-87cb-cac0f7990014"]
}, Open  ]],
Cell[CellGroupData[{
Cell[512836, 14629, 539, 15, 31, "Input",ExpressionUUID->"331d0094-5f34-48fd-82ad-5179facc3806"],
Cell[513378, 14646, 333, 9, 35, "Output",ExpressionUUID->"365aebbd-1cb0-45af-86b6-3a25e8679e36"]
}, Open  ]],
Cell[CellGroupData[{
Cell[513748, 14660, 614, 18, 31, "Input",ExpressionUUID->"944a9ba8-0c47-4efd-9c0a-a8d4bf0700e9"],
Cell[514365, 14680, 686, 20, 36, "Output",ExpressionUUID->"d2f8517a-e9ac-4526-a8b5-6e5bcbf79dd7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[515088, 14705, 629, 16, 52, "Input",ExpressionUUID->"797a87cb-3ccd-4a9a-992c-642af2294d85"],
Cell[515720, 14723, 245, 5, 35, "Output",ExpressionUUID->"74f4a41c-1177-45d6-a5e8-b889afee6b6b"]
}, Open  ]],
Cell[515980, 14731, 311, 7, 38, "Text",ExpressionUUID->"b3a4deac-bacf-420f-ac2f-5dc315182fbc"],
Cell[516294, 14740, 99, 1, 4, "PageBreak",ExpressionUUID->"002a4eab-e2df-44ac-a01d-63a5a9860217",
 PageBreakBelow->True],
Cell[CellGroupData[{
Cell[516418, 14745, 1948, 61, 72, "Input",ExpressionUUID->"f90a123d-0194-4000-85b5-991bfa59e1b1"],
Cell[518369, 14808, 636, 18, 36, "Output",ExpressionUUID->"56ac6572-3365-4aed-9dc9-cbaa1aa96777"]
}, Open  ]],
Cell[CellGroupData[{
Cell[519042, 14831, 2001, 62, 72, "Input",ExpressionUUID->"632fd6db-56bb-48ea-8e47-4c47f23daffb"],
Cell[521046, 14895, 574, 17, 36, "Output",ExpressionUUID->"9ae2ed7a-7bb8-4c7d-8482-7035714dfdfb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[521657, 14917, 4612, 109, 145, "Input",ExpressionUUID->"596a86df-becf-47ae-9851-9100c5d94f5d"],
Cell[526272, 15028, 9258, 271, 262, "Output",ExpressionUUID->"05aa45e4-d81c-4a57-877c-0f7d5e7a7801"],
Cell[535533, 15301, 19696, 510, 336, "Output",ExpressionUUID->"bcfddb0e-1455-4319-995a-70098f2bc201"]
}, Open  ]],
Cell[555244, 15814, 931, 28, 50, "Input",ExpressionUUID->"2a8eaac7-b70b-4245-8cd4-36945b704681"],
Cell[CellGroupData[{
Cell[556200, 15846, 927, 24, 52, "Input",ExpressionUUID->"12c55802-bc78-46f9-ad82-732b9462d587"],
Cell[557130, 15872, 980, 29, 52, "Output",ExpressionUUID->"ece4f627-378a-4f30-81d4-7eae488b53b0"]
}, Open  ]],
Cell[558125, 15904, 99, 1, 4, "PageBreak",ExpressionUUID->"68d23b47-2f49-45ac-9899-c9e0e2e494c6",
 PageBreakBelow->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[558261, 15910, 411, 8, 49, "Subsubsection",ExpressionUUID->"8df4dd67-8f67-4dc0-a4ba-1bae3eff7295"],
Cell[CellGroupData[{
Cell[558697, 15922, 10348, 286, 442, "Input",ExpressionUUID->"51a716be-8e5c-43b8-8d5a-4a526cf9b6b0"],
Cell[569048, 16210, 574, 9, 35, "Output",ExpressionUUID->"27510ac2-9ec5-4547-95a4-41bc9d569d9b"],
Cell[569625, 16221, 13162, 368, 277, "Output",ExpressionUUID->"16a801d7-41ae-447f-aae1-b7f7e9f7b00c"],
Cell[582790, 16591, 573, 9, 35, "Output",ExpressionUUID->"7b79e277-f50e-4e7e-9873-e0778ebe3927"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[583412, 16606, 381, 7, 77, "Subsubsection",ExpressionUUID->"527d1262-2a63-48d5-9d31-8d49c6ac9da6"],
Cell[583796, 16615, 162, 3, 38, "Text",ExpressionUUID->"d7972749-7b75-4302-aa6f-9edbe4e89bfe"],
Cell[CellGroupData[{
Cell[583983, 16622, 1629, 47, 97, "Input",ExpressionUUID->"27c4cc35-e050-4e57-8c1a-16af49186443"],
Cell[585615, 16671, 2809, 75, 60, "Output",ExpressionUUID->"e33c321a-6118-4079-8567-da67889b1b0d"],
Cell[588427, 16748, 13035, 425, 379, "Output",ExpressionUUID->"fe0e2d98-5356-4345-b832-f9b9f8e5df83"],
Cell[601465, 17175, 2849, 78, 81, "Output",ExpressionUUID->"0fb57b89-bbf5-4c9f-b711-9708e68c80cd"]
}, Open  ]],
Cell[604329, 17256, 172, 3, 38, "Text",ExpressionUUID->"41904a11-8a83-4788-ab17-c3c397472acd"],
Cell[604504, 17261, 2269, 53, 159, "Input",ExpressionUUID->"3a24bee1-7d73-4984-9d00-57f49d3a3807"],
Cell[606776, 17316, 622, 15, 31, "Input",ExpressionUUID->"d5d94268-f744-4ed5-9b33-7f68b11a252d"],
Cell[CellGroupData[{
Cell[607423, 17335, 8048, 239, 314, "Input",ExpressionUUID->"4a8a2bb8-d661-49ee-afec-3f458fac7788"],
Cell[615474, 17576, 209, 4, 35, "Output",ExpressionUUID->"d729d2d3-2501-46ff-b459-2938c340a0ac"],
Cell[615686, 17582, 11286, 334, 269, "Output",ExpressionUUID->"85def0a7-67fd-4f03-b85a-78d3734725c2"],
Cell[626975, 17918, 209, 4, 35, "Output",ExpressionUUID->"15f1d5a6-8314-450c-a3b4-4529be4fa019"]
}, Open  ]],
Cell[627199, 17925, 231, 5, 38, "Text",ExpressionUUID->"ca6cde1d-3315-4b09-8e4f-586a6b7a7b2b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[627479, 17936, 469, 12, 59, "Subsection",ExpressionUUID->"d26883c0-91fe-42e0-84db-c6b396b48cc3"],
Cell[CellGroupData[{
Cell[627973, 17952, 269, 6, 49, "Subsubsection",ExpressionUUID->"d3e89ab2-22e6-4fba-9ff2-95df211d514e"],
Cell[628245, 17960, 302, 7, 52, "Input",ExpressionUUID->"133a7fea-bbf0-45f4-b036-f61d97216717"],
Cell[628550, 17969, 2288, 69, 77, "Input",ExpressionUUID->"628a143e-8454-4996-b5ed-0b1d1f896bf7"],
Cell[CellGroupData[{
Cell[630863, 18042, 1974, 60, 117, "Input",ExpressionUUID->"3c6111d7-4c5b-43dc-b89f-a6b576fd35dd"],
Cell[632840, 18104, 2140, 61, 57, "Output",ExpressionUUID->"30d2749b-4cad-4cbb-b6b1-a4c16bc8cb9a"]
}, Open  ]],
Cell[634995, 18168, 817, 22, 31, "Input",ExpressionUUID->"643571d3-2a5a-49f1-997f-784b9246ce1d"],
Cell[CellGroupData[{
Cell[635837, 18194, 785, 19, 31, "Input",ExpressionUUID->"7d8cd47c-5dee-4556-a4aa-a04dfcc938c5"],
Cell[636625, 18215, 637, 13, 30, "Message",ExpressionUUID->"71898481-d379-4dc8-b56a-ff39c05c6bc0"],
Cell[637265, 18230, 539, 16, 52, "Output",ExpressionUUID->"3200b470-2c9c-43ca-ab83-209031f70208"]
}, Open  ]],
Cell[CellGroupData[{
Cell[637841, 18251, 614, 13, 52, "Input",ExpressionUUID->"567b9795-c46d-4c7b-8d68-62b4bb1dac26"],
Cell[638458, 18266, 1938, 53, 60, "Output",ExpressionUUID->"c481dd8b-8949-4123-a3e6-f6cc1f4fc3d5"],
Cell[640399, 18321, 1997, 58, 60, "Output",ExpressionUUID->"540c03b7-4d20-45b0-9f0b-e93dd99a9f18"]
}, Open  ]],
Cell[642411, 18382, 202, 3, 38, "Text",ExpressionUUID->"5835f165-3de2-40a8-ba99-f416ad9fa703"],
Cell[CellGroupData[{
Cell[642638, 18389, 855, 23, 74, "Input",ExpressionUUID->"46949df7-37a6-45c5-a8fd-6875e2cc7118"],
Cell[643496, 18414, 332, 6, 35, "Output",ExpressionUUID->"7ba6a124-302e-454a-a235-98c54444c2a9"]
}, Open  ]],
Cell[643843, 18423, 284, 6, 38, "Text",ExpressionUUID->"381c1e5f-b836-4545-ba6a-345053805e82"],
Cell[CellGroupData[{
Cell[644152, 18433, 407, 9, 31, "Input",ExpressionUUID->"0fcd19e7-a51c-4baf-b8f3-231a5e2725ce"],
Cell[644562, 18444, 1128, 37, 60, "Output",ExpressionUUID->"93d0a3f7-17a4-4a82-932b-9f6c79968b00"]
}, Open  ]],
Cell[645705, 18484, 194, 3, 38, "Text",ExpressionUUID->"197eb863-acae-498f-93f9-53b3caceaec9"],
Cell[CellGroupData[{
Cell[645924, 18491, 2105, 67, 105, "Input",ExpressionUUID->"2e50cfea-2c19-43af-8eab-4f0354ec61ff"],
Cell[648032, 18560, 378, 6, 35, "Output",ExpressionUUID->"e4df31ec-3abb-4306-a7bb-97fafd780898"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[648459, 18572, 242, 4, 49, "Subsubsection",ExpressionUUID->"640f073b-c174-4428-af1a-9bb11f1718b4"],
Cell[648704, 18578, 7084, 204, 70, "Input",ExpressionUUID->"343f0661-d56e-484e-8f59-a3bcbe8ff015"],
Cell[655791, 18784, 3493, 98, 70, "Input",ExpressionUUID->"b29ed40b-6814-4977-b908-132d3b3275cf"],
Cell[CellGroupData[{
Cell[659309, 18886, 2514, 72, 70, "Input",ExpressionUUID->"6eb45972-9d00-435c-ac8f-50f412826417"],
Cell[661826, 18960, 685, 10, 70, "Output",ExpressionUUID->"a83cd108-0f4e-4249-898a-90df7e4c29e4"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[662572, 18977, 439, 12, 59, "Subsection",ExpressionUUID->"71f4e462-3a93-405b-905c-6d7935eeaf8d"],
Cell[663014, 18991, 180, 3, 38, "Text",ExpressionUUID->"5f00dc47-5ff6-4099-ba41-e03c5b1dfb95"],
Cell[663197, 18996, 2804, 62, 159, "Input",ExpressionUUID->"6d62815f-c3fb-4f92-b824-5f11940c235a"],
Cell[666004, 19060, 517, 13, 38, "Text",ExpressionUUID->"dd31c34f-e73e-4368-a803-270a3cfcb8ba"],
Cell[CellGroupData[{
Cell[666546, 19077, 8087, 236, 292, "Input",ExpressionUUID->"94922da6-ab95-407b-99e4-72fc12c58ce5"],
Cell[674636, 19315, 231, 4, 35, "Output",ExpressionUUID->"43e4e288-8178-498a-bc0d-05684c6aa8ff"],
Cell[674870, 19321, 11308, 334, 269, "Output",ExpressionUUID->"51feeb5e-bbda-4234-bd18-3d47bf19ea3e"]
}, Open  ]],
Cell[686193, 19658, 163, 3, 38, "Text",ExpressionUUID->"e41fa7bb-102b-4ebc-b130-f50479eecc2d"],
Cell[686359, 19663, 238, 6, 31, "Input",ExpressionUUID->"56f76050-af92-49c9-9d4c-9cbe2e11ffb9"],
Cell[CellGroupData[{
Cell[686622, 19673, 1326, 32, 49, "Input",ExpressionUUID->"19bc79c2-4107-40c6-b39a-e7191f697c40"],
Cell[687951, 19707, 7678, 231, 186, "Output",ExpressionUUID->"69e9245f-b060-4442-9ac2-94d5b7a17457"]
}, Open  ]],
Cell[695644, 19941, 787, 18, 40, "Text",ExpressionUUID->"6b3fb50d-778f-4c43-8e08-a050d525e0de"],
Cell[CellGroupData[{
Cell[696456, 19963, 2587, 69, 73, "Input",ExpressionUUID->"e90e25a0-8360-4096-ab62-e16f9adcc1e5"],
Cell[699046, 20034, 9109, 269, 262, "Output",ExpressionUUID->"6a1fec9d-2279-402d-b813-1a10679f392e"]
}, Open  ]],
Cell[708170, 20306, 226, 4, 31, "Input",ExpressionUUID->"8fb522ae-2c9e-4657-92bd-bbf432c91931"],
Cell[CellGroupData[{
Cell[708421, 20314, 485, 11, 52, "Input",ExpressionUUID->"78c6a8e3-e80b-402c-a93b-d5f4d2004f59"],
Cell[708909, 20327, 306, 6, 35, "Output",ExpressionUUID->"244c6817-9169-4771-8373-c92a7a9187d4"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

